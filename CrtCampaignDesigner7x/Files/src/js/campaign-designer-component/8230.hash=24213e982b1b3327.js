(self.webpackChunkapp_studio_enterprise_campaign_designer=self.webpackChunkapp_studio_enterprise_campaign_designer||[]).push([[8230],{58230:(Ei,Ka,p)=>{var ut=p(71252),P=p(40297),W=p(63721),Si=p(27397),z=p(79772),d=p(59131),x=p(62278),C=p(36486);const Ss=new d.InjectionToken("CustomEventApplicationIdToken"),$a=new d.InjectionToken("CustomEventServiceToken");class ae{constructor(e,t=null){this.document=e,this.appId=t,this.customEventName="TSCustomEventChannel",this.appId=t||Math.random().toString()}subscribe(e){return this.customEventObserver$=this.customEventObserver$||(0,x.fromEvent)(document,this.customEventName),this.customEventObserver$.pipe((0,C.filter)(t=>t.detail.eventName===e&&t.detail.sender!==this.appId),(0,C.map)(t=>t.detail.payload))}createOutboundChannel(e){const t=new x.Subject;return t.asObservable().subscribe(n=>{const i=new CustomEvent(this.customEventName,{detail:{eventName:e,sender:this.appId,payload:n}});this.document.dispatchEvent(i)}),t}getDataViaEvent(e,t={}){return new x.Observable(n=>{this.subscribe(e).pipe((0,C.first)()).subscribe(i=>{n.next(i),n.complete()}),this.createOutboundChannel(e).next(t)})}getDataStreamViaEvent(e,t={}){return new x.Observable(n=>{const i=this.subscribe(e).subscribe(o=>{n.next(o)},x.noop,()=>n.complete());return this.createOutboundChannel(e).next(t),()=>{i.unsubscribe()}})}static{this.\u0275fac=function(t){return new(t||ae)(d.\u0275\u0275inject(P.DOCUMENT),d.\u0275\u0275inject(Ss,8))}}static{this.\u0275prov=d.\u0275\u0275defineInjectable({token:ae,factory:ae.\u0275fac,providedIn:"root"})}}var Os=p(34268),mn=p.n(Os);const ks="(?=^.{1,250}$)^[\u0430-\u044F\u0410-\u042Fa-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[\u0430-\u044F\u0410-\u042Fa-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[\u0430-\u044F\u0410-\u042Fa-zA-Z0-9](?:[\u0430-\u044F\u0410-\u042Fa-zA-Z0-9-]*[\u0430-\u044F\u0410-\u042Fa-zA-Z0-9])?\\.)+[\u0430-\u044F\u0410-\u042Fa-zA-Z0-9](?:[\u0430-\u044F\u0410-\u042Fa-zA-Z0-9-]*[\u0430-\u044F\u0410-\u042Fa-zA-Z0-9])?$",As=()=>new RegExp(ks,"g"),Va=()=>new RegExp(CONTAINS_EMAIL_PATTERN,"g");function Is(s){return As().test(s)}function Ga(s){return CONTAINS_EMAIL_REGEXP().test(s)}const Oi={name:"uponSanitizeElement",func:(s,e)=>{const t=e.tagName;Is(t)&&s.insertAdjacentText("afterbegin",`<${t}>`)}},ki={name:"afterSanitizeAttributes",func:(s,e)=>{const t=window?.location?.origin;if(s.nodeName==="A"&&!s.getAttribute("href")?.toLowerCase().startsWith(t)){s.setAttribute("target","_blank");let n=s.getAttribute("rel")||"";["noopener","noreferrer"].forEach(i=>{n.includes(i)||(n+=" "+i)}),s.setAttribute("rel",n.trim())}}},Ja=new d.InjectionToken("Represents a DOM purifier",{factory:()=>(mn().addHook(Oi.name,Oi.func),mn().addHook(ki.name,ki.func),mn()),providedIn:"platform"});function Za(s){return s?Array.isArray(s)?s:[s]:[]}function Ai(s){return s||{}}function Ya(){}function Xa(){return()=>{}}var Ds=p(35293);class Ts{static generate(){return"_"+this.generateUUID()}static generateUUID(){return(0,Ds.A)()}}var Ne=p(26714);function M(s){return(e,t,n)=>{for((e.$inject===void 0||e.$inject instanceof Array&&!e.hasOwnProperty("$inject"))&&(e.$inject=[]);e.$inject.length<=n;)e.$inject.push(null);e.$inject[n]=s||t}}class Ps{static create(e){return new e}}class ve{constructor(){this.speechResult=new x.Subject,this.speechEnd=new x.Subject}static _getInternalApiClass(){return window.SpeechRecognition||window.webkitSpeechRecognition}static isSupported(){return ve._getInternalApiClass()!==void 0}_subscribeEvents(){this._internalApi.addEventListener("result",this.onResult.bind(this)),this._internalApi.addEventListener("speechend",this.onSpeechEnd.bind(this))}_unsubscribeEvents(){this._internalApi.removeEventListener("result",this.onResult),this._internalApi.removeEventListener("speechend",this.onSpeechEnd)}init(e){const t=ve._getInternalApiClass();this._internalApi=Ps.create(t),this._internalApi.continuous=!0,this._internalApi.lang=e.lang||"en-US",this._subscribeEvents()}onResult(e){const{resultIndex:t,results:n}=e,i=n[t][0];if(!i)throw new Error("No results to transcript");this.speechResult.next(i.transcript)}onSpeechEnd(){this.speechEnd.next()}destroy(){this._unsubscribeEvents(),this._internalApi=null}startRecognition(){this._internalApi.start()}stopRecognition(){this._internalApi.stop()}static{this.\u0275fac=function(t){return new(t||ve)}}static{this.\u0275prov=d.\u0275\u0275defineInjectable({token:ve,factory:ve.\u0275fac})}}var Ms=p(73436);class Rs{get messages$(){return this._messages$}constructor(e,t){this._ngZone=t;const n=new x.Subject;this._messages$=n.pipe(this._runInZone(this._ngZone)),this._broadcastChannel=new Ms.BroadcastChannel(e),this._broadcastChannel.onmessage=i=>n.next(i)}_runInZone(e){return t=>new x.Observable(n=>{t.subscribe(i=>e.run(()=>n.next(i)))})}publish(e){return(0,x.from)(this._broadcastChannel.postMessage(e))}}class gt{constructor(e){this._ngZone=e}createInstance(e){return new Rs(e,this._ngZone)}static{this.\u0275fac=function(t){return new(t||gt)(d.\u0275\u0275inject(d.NgZone))}}static{this.\u0275prov=d.\u0275\u0275defineInjectable({token:gt,factory:gt.\u0275fac,providedIn:"root"})}}class Qa{static toColdObservable(e){return new Observable(t=>{e().subscribe(i=>{t.next(i),t.complete()})})}}class ce{log(e,t,...n){console.log(e,...n)}warn(e,t,...n){console.warn(e,...n)}error(e,t,...n){console.error(e,...n)}exception(e,t,...n){(console.exception||console.error)(e,...n)}static{this.\u0275fac=function(t){return new(t||ce)}}static{this.\u0275prov=d.\u0275\u0275defineInjectable({token:ce,factory:ce.\u0275fac})}}const qa={dataAccess:"data-access",feature:"feature",ui:"ui",util:"util",components:"components",deprecated:"deprecated"},ec={studioFree:"studio-free",studioEnterprise:"studio-enterprise",sdk:"sdk"};class fn{constructor(e,t,n=null){this._injector=e,this._registrationMap=t,this._defaultInstanceType=n}_getInstance(e,t){return t?"injectable"in t&&t.injectable!=null?this._injector.get(t.injectable):"useFactory"in t&&typeof t.useFactory=="function"?t.useFactory(e):"useValue"in t?t.useValue:null:null}_getDefaultInstance(e){return this._getInstance(e,this._defaultInstanceType)}_getInstanceByType(e){if(this._registrationMap.has(e)){const t=this._registrationMap.get(e);return this._getInstance(e,t)}}_getInstanceByPredicate(e){for(const[t,n]of this._registrationMap)if(typeof t=="function"&&t(e))return this._getInstance(e,n)}create(e=null){return e==null?this._getDefaultInstance(e):this._getInstanceByType(e)??this._getInstanceByPredicate(e)??this._getDefaultInstance(e)}static{this.\u0275fac=function(t){d.\u0275\u0275invalidFactory()}}static{this.\u0275prov=d.\u0275\u0275defineInjectable({token:fn,factory:fn.\u0275fac,providedIn:"root"})}}var g=p(28399);class tc{static _createMappings(e){const t=new Map;return e=e??[],e.forEach(n=>{const i=n.predicate,o=omit(n,"predicate");t.set(i,o)}),t}static create(e){const{mappings:t,default:n,token:i}=e??{};return{provide:i,useFactory:o=>{const a=this._createMappings(t);return new Factory(o,a,n)},deps:[Injector]}}}function yn(s){return Array.isArray(s)?s:[s]}function Ls(s,e){return e.forEach(({replaceMacros:t,replaceValue:n})=>{s=s.map(i=>i===t?n??"":i)}),s}function nc(s,e){if(!s)return"";if(!e)return s;let t=[s];return e=yn(e),t=Bs(t,e),t=Ls(t,e),t.join("")}function Bs(s,e){if(!s)return[];let t=yn(s);if(!e)return t;const n=yn(e),i=n.map(({replaceMacros:o})=>o);return n.forEach(({searchValue:o,replaceMacros:a})=>{if(o&&a){const c=new RegExp(`(${a})`,"g"),h=t.map(u=>i.includes(u)?u:u.split(o).join(a).split(c));t=flatten(h)}}),t}var ic=p(4930);function Fs(s){return function(e){Reflect.defineMetadata("requestType",s.requestType,e)}}function sc(s){return e=>{const t=e.pipe(share()),n=t.pipe(tap(s),take(1));return concat(n,t)}}function oc(s){return e=>e.pipe(concatMap((t,n)=>s(t,n).pipe(map(i=>[t,i]))))}function rc(s){return e=>e.pipe(mergeMap((t,n)=>s(t,n).pipe(map(i=>[t,i]))))}function ac(s){return e=>e.pipe(mergeMap((t,n)=>s(t,n).pipe(map(()=>t))))}function cc(s){return e=>e.pipe(switchMap((t,n)=>s(t,n).pipe(map(i=>[t,i]))))}function lc(s){return e=>e.pipe(switchMap((t,n)=>s(t,n).pipe(map(()=>t))))}function dc(s){return e=>s?new Observable(t=>{const n=a=>s.run(()=>t.next(a)),i=a=>s.run(()=>t.error(a)),o=()=>s.run(()=>t.complete());return e.subscribe({next:n,error:i,complete:o})}):e}function hc(s){return e=>s?new Observable(t=>{const n=a=>s.runOutsideAngular(()=>t.next(a)),i=a=>s.runOutsideAngular(()=>t.error(a)),o=()=>s.runOutsideAngular(()=>t.complete());return e.subscribe({next:n,error:i,complete:o})}):e}var mt=p(23710),bn=p.n(mt);class zs{static initialize(){mt.config({disableDefaultAlphabetLength:!0,disableDefaultIdLength:!0,idLength:7}),mt.characters("0123456789abcdefghijklmnopqrstuvwxyz")}static generateUnique(e,t="",n="_"){const i=new RegExp(`^${t}`);return t+e.replace(i,"")+n+mt.generate()}static getUniqueIncrementalName(e,t){if(!t.includes(e))return e;let n;for(let i=1;i<=t.length;i++)if(n=`${e}-${i}`,!t.includes(n))return n;return n}}zs.initialize();const pc=new d.InjectionToken("An abstraction over window.navigator object",{factory:()=>window.navigator,providedIn:"root"}),Ns="00000000-0000-0000-0000-000000000000",Us=null;function Ue(s){let e="";for(let t=0;t<s;t++)e+=((1+Math.random())*65536|0).toString(16).substring(1);return e}function ft(){return[Ue(2),Ue(1),Ue(1),Ue(1),Ue(3)].join("-")}function uc(s){return!!s&&Us.test(s)}function gc(s){return!s||s===Ns}const Ii=new d.InjectionToken("CURRENT_TAB_ID_TOKEN"),mc={provide:Ii,useValue:ft()},fc=new d.InjectionToken("Dialog token"),yt=new d.InjectionToken("WindowToken",{providedIn:"root",factory:Di});function Di(){return window}const yc={provide:yt,useFactory:Di};class bt{constructor(e){this._window=e,this._hasFocus=!1,this._window.addEventListener("focus",()=>{this._hasFocus=!0}),this._window.addEventListener("blur",()=>{this._hasFocus=!1})}_getIsDocumentVisible(){return document.visibilityState!=="hidden"}get hasFocus(){return this._hasFocus}get isActive(){return this._getIsDocumentVisible()}focus(){this._window.focus()}static{this.\u0275fac=function(t){return new(t||bt)(d.\u0275\u0275inject(yt))}}static{this.\u0275prov=d.\u0275\u0275defineInjectable({token:bt,factory:bt.\u0275fac,providedIn:"root"})}}var Hs=p(3633);class He{constructor(e){this._injector=e}defineComponent(e,t,n=null){const i=(0,Hs.createCustomElement)(t,{injector:n||this._injector});customElements.get(e)||customElements.define(e,i)}static{this.\u0275fac=function(t){return new(t||He)(d.\u0275\u0275inject(d.Injector))}}static{this.\u0275prov=d.\u0275\u0275defineInjectable({token:He,factory:He.\u0275fac,providedIn:"root"})}}function Ks(s,e){return s.creatio.tabId=e,(0,x.of)(void 0)}const bc={provide:d.APP_INITIALIZER,multi:!0,useFactory:(s,e)=>()=>Ks(s,e),deps:[yt,Ii]},Ti=new d.InjectionToken("LOCAL_STORAGE_SERVICE_CONFIG");class _t{static forRoot(e={}){return{ngModule:_t,providers:[{provide:Ti,useValue:e}]}}static{this.\u0275fac=function(t){return new(t||_t)}}static{this.\u0275mod=d.\u0275\u0275defineNgModule({type:_t})}static{this.\u0275inj=d.\u0275\u0275defineInjector({})}}const _n="LOCAL_STORAGE_NOT_SUPPORTED";class Ke{constructor(e={}){this._isSupported=!1,this._prefix="ls",this._storageType="localStorage";const{prefix:t,storageType:n}=e;t!=null&&this._setPrefix(t),n!=null&&this._setStorageType(n),this._isSupported=this._checkSupport()}_deriveKey(e){return`${this._prefix}${e}`}_checkSupport(){try{const e=this._storageType in window&&window[this._storageType]!==null;if(e){this._webStorage=window[this._storageType];const t=this._deriveKey(`__${Math.round(Math.random()*1e7)}`);this._webStorage.setItem(t,""),this._webStorage.removeItem(t)}return e}catch(e){return console.error(e.message),!1}}_setPrefix(e){this._prefix=e;const t=".";this._prefix&&!this._prefix.endsWith(t)&&(this._prefix=this._prefix?`${this._prefix}${t}`:"")}_setStorageType(e){this._storageType=e}get(e){if(!this._isSupported)return console.warn(_n),null;const t=this._webStorage?this._webStorage.getItem(this._deriveKey(e)):null;if(!t||t==="null")return null;try{return JSON.parse(t)}catch{return null}}set(e,t){const n=t===void 0?null:JSON.stringify(t);if(!this._isSupported)return console.warn(_n),!1;try{this._webStorage&&this._webStorage.setItem(this._deriveKey(e),n)}catch(i){return console.error(i.message),!1}return!0}remove(...e){let t=!0;return e.forEach(n=>{this._isSupported||(console.warn(_n),t=!1);try{this._webStorage.removeItem(this._deriveKey(n))}catch(i){console.error(i.message),t=!1}}),t}static{this.\u0275fac=function(t){return new(t||Ke)(d.\u0275\u0275inject(Ti,8))}}static{this.\u0275prov=d.\u0275\u0275defineInjectable({token:Ke,factory:Ke.\u0275fac,providedIn:"root"})}}var E=p(73308);class xt{playFromSource(e,t=!1){return(0,E.A)(function*(){const n=new Audio(e),i=n.play();if(i!==void 0)try{yield i}catch(o){if(n.muted=!0,t)throw o}})()}static{this.\u0275fac=function(t){return new(t||xt)}}static{this.\u0275prov=d.\u0275\u0275defineInjectable({token:xt,factory:xt.\u0275fac,providedIn:"root"})}}var q;(function(s){s.Small="small",s.Medium="medium",s.Large="large",s.XL="xl",s.XXL="xxl"})(q||(q={}));class vt{constructor(e,t){this._window=e,this._document=t,this._minScreenSize=600,this._mediumScreenSize=790,this._largeScreenSize=1079,this._xlScreenSize=1280,this._screenSizeChanges$=new x.BehaviorSubject(this._currentScreenSizeType),this._changeScreenSizeType()}get currentScreenSizeType(){return this._currentScreenSizeType}get currentScreenSize(){return this._currentScreenSize}get isSmallScreen(){return this._currentScreenSizeType===q.Small}_setScreenSizeTypeAttribute(e){this._document.body.setAttribute("screen-size-type",e)}_getScreenSizeType(){return this._currentScreenSize=this._window.innerWidth,this._currentScreenSize<=this._minScreenSize?q.Small:this._currentScreenSize<=this._mediumScreenSize?q.Medium:this._currentScreenSize<=this._largeScreenSize?q.Large:this._currentScreenSize<=this._xlScreenSize?q.XL:q.XXL}_changeScreenSizeType(){const e=this._getScreenSizeType();return e===this._currentScreenSizeType?!1:(this._currentScreenSizeType=e,this._setScreenSizeTypeAttribute(e),!0)}screenSizeTypeChangeNotifier(){return this._screenSizeChanges$.asObservable()}refreshCurrentScreenSizeType(){this._changeScreenSizeType()&&this._screenSizeChanges$.next(this._currentScreenSizeType)}static{this.\u0275fac=function(t){return new(t||vt)(d.\u0275\u0275inject(yt),d.\u0275\u0275inject(P.DOCUMENT))}}static{this.\u0275prov=d.\u0275\u0275defineInjectable({token:vt,factory:vt.\u0275fac,providedIn:"root"})}}const _c=new d.InjectionToken("DESKTOP_NOTIFICATION_SENDER_PROVIDER");var Pi;(function(s){s[s.StayLoggedIn=0]="StayLoggedIn",s[s.Exit=1]="Exit",s[s.NotSet=2]="NotSet"})(Pi||(Pi={}));var $s=p(93277);class Ct{constructor(){this._liveAnnouncer=(0,d.inject)($s.LiveAnnouncer),this._translateService=(0,d.inject)(z.TranslateService)}announce(e,t,n=200){var i=this;return(0,E.A)(function*(){const o=i._translateService.instant(e);yield i._liveAnnouncer.announce(o,t,n)})()}static{this.\u0275fac=function(t){return new(t||Ct)}}static{this.\u0275prov=d.\u0275\u0275defineInjectable({token:Ct,factory:Ct.\u0275fac,providedIn:"root"})}}var r=p(5960);class Ws extends Error{constructor(){super("Next handler already specified")}}class Vs{constructor(){this._refs=new Set,this.lazyLoadingDisabled=!1}static{this._globalInstancePath="creatio._lazyModulesManager"}static get instance(){if(!this._instance){let e=(0,g.get)(window,this._globalInstancePath);e||(e=new this,(0,g.set)(window,this._globalInstancePath,e)),this._instance=e}return this._instance}add(e){this._refs.add(e)}size(){return this._refs.size}loadAll(){return Promise.all(Array.from(this._refs).map(e=>e.loadAndBootstrap()))}clear(){this._refs.clear()}}var xn;(function(s){s[s.Schema=0]="Schema",s[s.Remote=1]="Remote",s[s.Host=2]="Host"})(xn||(xn={}));const Mi=window;class Gs{constructor(){this.store={typeInfos:new Map}}static{this._prefix="creatio.registry."}static get store(){if(!this._instance){let e=(0,g.get)(Mi,this._prefix+this.registryKey);e||(e=new this,(0,g.set)(Mi,this._prefix+this.registryKey,e)),this._instance=e}return this._instance.store}}class Js extends Gs{static{this.registryKey="pkgTopology"}static get items(){return this.store.typeInfos}static get(e){const t=this.items.get(e);if(t===void 0)throw new Error(`Package with name ${e} not found in topology`);return t}}class Zs{constructor(e){this._request=e;const t=[...this._request.scopes??[]].reverse().map((n,i)=>[n,i]);this._scopesOrder=Object.fromEntries(t)}_getOrderByScopes(e){if(!e.scopes)return Number.MAX_VALUE;const t=e.scopes.filter(n=>n in this._scopesOrder).map(n=>this._scopesOrder[n]);return Math.min(...t)}_getOrderByPkgTopology(e){return e.source.type===xn.Host?Number.MAX_VALUE:Js.get(e.source.packageName)}compare(e,t){const n=this._getOrderByScopes(e),i=this._getOrderByScopes(t);let o=n-i;if(o)return o;const a=this._getOrderByPkgTopology(e),c=this._getOrderByPkgTopology(t);return o=a-c,o||(o=e.source.type-t.source.type,o)}}const Ri="module",Li="viewElement",vn="interfaceDesignerItem",Bi="requestHandler",Fi="designTimeViewElement",zi="validator",Ni="converter";function xc(s,e){Reflect.defineMetadata(Ri,s,e)}function Ys(s){const e=Reflect.getMetadata(Ri,s);if(!e)throw new Error(`Module metadata was not found on '${s.name}' class`);return e}function vc(s,e){Reflect.defineMetadata(Li,s,e)}function Cc(s){const e=Reflect.getMetadata(Li,s);if(!e)throw new Error(`View element metadata was not found on '${s.name}' class`);return e}function wc(s,e){Reflect.defineMetadata(zi,s,e)}function jc(s){const e=Reflect.getOwnMetadata(zi,s);if(!e)throw new Error(`Validator metadata was not found on '${s.name}' class`);return e}function Ec(s,e){Reflect.defineMetadata(Ni,s,e)}function Sc(s){const e=Reflect.getOwnMetadata(Ni,s);if(!e)throw new Error(`Converter metadata was not found on '${s.name}' class`);return e}function Oc(s,e){Reflect.defineMetadata(vn,s,e)}function kc(s){const e=Reflect.getOwnMetadata(vn,s);if(!e)throw new Error(`Interface designer item metadata was not found on '${s.name}' class`);return e}function Ac(s,e){Reflect.defineMetadata(Fi,s,e)}function Ic(s){const e=Reflect.getOwnMetadata(Fi,s);if(!e)throw new Error(`Design time view element metadata was not found on '${s.name}' class`);return e}function Dc(s){return Reflect.hasOwnMetadata(vn,s)}function Tc(s,e){Reflect.defineMetadata(Bi,s,e)}function Pc(s){const e=Reflect.getMetadata(Bi,s);if(!e)throw new Error(`Request handler metadata was not found on '${s.name}' class`);return e}function Mc(s){const e=Reflect.getMetadata("requestType",s);if(!e)throw new Error(`requestType was not found on '${s.name}' class`);return{requestType:e,typeRef:s}}function Rc(s){const t=Reflect.getMetadataKeys(s).filter(n=>n.startsWith(crtInputPrefix));return Object.fromEntries(t.map(n=>{const i=Reflect.getMetadata(n,s);return[n.replace(crtInputPrefix,""),i]}))}function Lc(s){const t=Reflect.getMetadataKeys(s).filter(n=>n.startsWith(crtOutputPrefix));return Object.fromEntries(t.map(n=>{const i=Reflect.getMetadata(n,s);return[n.replace(crtOutputPrefix,""),i]}))}function Bc(s){const t=Reflect.getMetadataKeys(s).filter(n=>n.startsWith(crtValidationInputPrefix));return Object.fromEntries(t.map(n=>{const i=Reflect.getMetadata(n,s);return[n.replace(crtValidationInputPrefix,""),i]}))}function Xs(s){const t=Reflect.getOwnMetadataKeys(s).filter(n=>n.startsWith(crtInjectPrefix));return Object.fromEntries(t.map(n=>{const i=Number(n.replace(crtInjectPrefix,"")),o=Reflect.getMetadata(n,s);return[i,o]}))}function Qs(s){const e=s.prototype?Object.getPrototypeOf(s.prototype):null;return e?e.constructor:null}function qs(s){const e=Reflect.getOwnMetadata("design:paramtypes",s);if(!e){if(s.length>0)throw new Error(`Dependency Injection error. Cannot read dependencies of class '${s.name}'. Please make sure class '${s.name}' has decorator and 'emitDecoratorMetadata' option is enabled in your 'tsconfig.json' file.`);const n=Qs(s);return n&&n!==Object?qs(n):[]}const t=Xs(s);return Object.entries(t).forEach(([n,i])=>e[n]=i),e}function eo(s){console.error("Not supported: lazy modules should not be dependent on other lazy modules. Some functions may not work correctly",s)}function to(s){if(!Array.isArray(s))return[];if(s.length===0)return[];const e=new Set,t=[...s];for(;t.length>0;){const n=t.pop();if(!n||e.has(n))continue;if(typeof n!="function"){eo(n);continue}e.add(n);const i=Ys(n)?.includes||[];t.push(...i)}return[...e]}function no(s,e){return s?.length?s.some(t=>e?.includes(t)):!0}const Cn=window;Cn.creatio??={},Cn.creatio._bootstrappedCrtModules??=new Map;const io=Cn.creatio._bootstrappedCrtModules;function wn(s){io.forEach((e,t)=>{e.root&&s(e,t)})}function Fc(s){wn(e=>e.options?.onContextCreate?.(s))}function so(s){wn(e=>e.options?.onContextUpdate?.(s))}function zc(s){wn(e=>e.options?.onContextDestroy?.(s))}class oo{constructor(){var e=this;this._handlers=[],this._requestListeners=new Map,this._handlersCache=new Map,this._handlersScopesByContextId=new Map,this.handlerChain$={process:function(){var t=(0,E.A)(function*(n){let i;if(e._hasCacheHandler(n))i=e._getCacheHandler(n);else{const o=e._getMatchedHandlers(n);Vs.instance.lazyLoadingDisabled||(yield e._loadLazyHandlers(n,o)),i=e._buildHandlersChain(n,o)}return e._requestListeners.forEach(o=>o?.(n)),i?.handle(n)});return function(i){return t.apply(this,arguments)}}(),register:t=>(this._handlersCache.delete(t.requestType),this._handlers.push(t),()=>{const n=this._handlers.indexOf(t);n>-1?(this._handlers.splice(n,1),this._handlersCache.delete(t.requestType)):console.warn(`${t?.requestType} not found to unsubscribe`)}),update:t=>{const n=this._handlers.find(i=>i.type===t.type);n&&(n.createHandler=t.createHandler)},subscribe:(t,n)=>{if(!t)return()=>{};const i=ft(),o=a=>{(!n||a.$context===n)&&t(a)};return this._requestListeners.set(i,o),()=>this._requestListeners.delete(i)}}}clearContextedHandlersCache(e){return(this._handlersScopesByContextId.get(e)??[]).every(({requestType:n,scope:i})=>this._handlersCache.get(n)?.delete(i))}clear(){this._handlers.splice(0),this._requestListeners.clear(),this._handlersCache.clear(),this._handlersScopesByContextId.clear()}_getCacheHandler(e){const t=this._handlersCache.get(e.type),n=this._getCacheScopesKey(e);return t.get(n)}_hasCacheHandler(e){const t=this._handlersCache.get(e.type),n=this._getCacheScopesKey(e);return t&&t.has(n)}_getCacheScopesKey(e){const t=this._getInjectionContext(e?.$context)?.id??"";return(e.scopes||[""]).join("_").concat(t)}_getInjectionContext(e){return e?._injectionContext||e?.parent&&this._getInjectionContext(e.parent)}_setContextedScopes(e,t){const n=this._getInjectionContext(e?.$context)?.id,i=this._handlersScopesByContextId.has(n)?this._handlersScopesByContextId.get(n):[];i.push({requestType:e.type,scope:t}),this._handlersScopesByContextId.set(n,i)}_setCacheHandler(e,t){const n=this._handlersCache.has(e.type)?this._handlersCache.get(e.type):new Map,i=this._getCacheScopesKey(e);n.set(i,t),this._getInjectionContext(e?.$context)?.id&&this._setContextedScopes(e,i),this._handlersCache.set(e.type,n)}_isRequestHandler(e){return typeof e.handle=="function"&&typeof e.setNext=="function"}_checkHandlerInstanceOf(e){if(!this._isRequestHandler(e))throw new Error('Handler should implement "BaseRequestHandler"')}_loadLazyHandlers(e,t){var n=this;return(0,E.A)(function*(){const i=new Set;t.forEach(c=>{c.lazy&&!c.createHandler&&i.add(c.lazyModuleRef)});const o=[...i];yield Promise.all(o.map(c=>c.loadAndBootstrap()));const a=n._getInjectionContext(e?.$context);if(a&&i.size){const c=yield to(o.map(h=>h.typeRef));for(const h of c)a.addLazyModule(h);so(a)}})()}_getMatchedHandlers(e){return this._handlers.filter(t=>t.requestType!==e.type?!1:no(t.scopes,e.scopes))}_buildHandlersChain(e,t){const n=new Zs(e);t.sort((c,h)=>n.compare(c,h));const i=this._getInjectionContext(e?.$context),o=t.map(c=>c.createHandler.call(c,i));o.forEach(c=>this._checkHandlerInstanceOf(c)),this._joinHandlersInChain(o);const a=o[0];return this._setCacheHandler(e,a),a}_joinHandlersInChain(e){for(let t=0;t<e.length-1;t++)try{e[t].setNext(e[t+1])}catch(n){throw n instanceof Ws?new Error("Handler factory should return new instance of BaseRequestHandler class or its subclass (next handler should not be specified)"):n}}}const Ui=window;class $e{get _chain(){return Ui.handlerChain}set _chain(e){Ui.handlerChain=e}static get instance(){return $e._instance||($e._instance=new $e)}constructor(){this._chain||this._createGlobalHandlerChain()}_createGlobalHandlerChain(){this._chain=new oo}clearContextedHandlersCache(e){return this._chain.clearContextedHandlersCache(e)}register(e){return this._chain.handlerChain$.register(e)}update(e){return this._chain.handlerChain$.update(e)}process(e){return this._chain.handlerChain$.process(e)}subscribe(e,t){return this._chain.handlerChain$.subscribe(e,t)}clear(){this._chain.clear()}}function wt(s){return function(e,t,n){const i=function(...o){return $e.instance.process({type:s?.requestType?s.requestType:this.requestType,method:s?.methodName?s.methodName:t,args:o})};n?n.value=i:e[t]=i}}class ro{}class ee extends ro{constructor(){super(...arguments),this.requestType="crt.SysSettingsService"}}(0,r.__decorate)([wt(),(0,r.__metadata)("design:type",Function)],ee.prototype,"getByCodes",void 0),(0,r.__decorate)([wt(),(0,r.__metadata)("design:type",Function)],ee.prototype,"getByCode",void 0),(0,r.__decorate)([wt(),(0,r.__metadata)("design:type",Function)],ee.prototype,"update",void 0),(0,r.__decorate)([wt(),(0,r.__metadata)("design:type",Function)],ee.prototype,"updateMany",void 0);const ao="DataService/json/SyncReply",co="DataService/ssp/json/SyncReply",lo="A5420246-0A8E-E111-84A3-00155D054C03",ho="en-US";class jt{constructor(e){Object.assign(this,e)}static getDefaultCulture(){return new jt({sysCultureId:lo,sysCultureName:ho,decimalSeparator:".",thousandSeparator:","})}}class po{constructor(){const e=this.constructor;if((0,d.inject)(e,d.InjectFlags.Optional|d.InjectFlags.SkipSelf))throw Error(`[${e.name}]: trying to create multiple instances,
			but this service should be a singleton.`)}}class Hi{constructor(){this.cultureInfo=new jt,this.defCultureInfo=new jt}}const N="Information about the current user is not initialized yet. Use UserInfoService to load current user information.";function uo(){return{get id(){throw new ReferenceError(N)},get contactId(){throw new ReferenceError(N)},get contactName(){throw new ReferenceError(N)},get accountId(){throw new ReferenceError(N)},get accountName(){throw new ReferenceError(N)},get isSSP(){throw new ReferenceError(N)},get timeZoneId(){throw new ReferenceError(N)},get cultureInfo(){throw new ReferenceError(N)},get defCultureInfo(){throw new ReferenceError(N)},get timeZoneOffsetHours(){throw new ReferenceError(N)},get photoId(){throw new ReferenceError(N)},get accessType(){throw new ReferenceError(N)},get sessionId(){throw new ReferenceError(N)}}}const I=uo(),Ki={get id(){return I.id},get contactId(){return I.contactId},get contactName(){return I.contactName},get accountId(){return I.accountId},get accountName(){return I.accountName},get isSSP(){return I.isSSP},get timeZoneId(){return I.timeZoneId},get cultureInfo(){return I.cultureInfo},get defCultureInfo(){return I.defCultureInfo},get timeZoneOffsetHours(){return I.timeZoneOffsetHours},get photoId(){return I.photoId},get accessType(){return I.accessType},get sessionId(){return I.sessionId}};Object.freeze(Ki);const Nc={provide:Hi,useFactory:()=>Ki};class Et extends po{constructor(e){super(),this._httpClient=e,this._serviceEndpoint="/ServiceModel/UserInfoService.svc"}_applyUserInfo(e){Object.keys(I).forEach(t=>{delete I[t]}),Object.assign(I,e)}loadCurrentUserInfo(){if(!this._userInfo$){const e=`${this._serviceEndpoint}/GetCurrentUserInfo`;this._userInfo$=this._httpClient.post(e,null).pipe((0,x.tap)(t=>{this._applyUserInfo(t?.userInfo)}),(0,x.shareReplay)({bufferSize:1,refCount:!1}))}return this._userInfo$}static{this.\u0275fac=function(t){return new(t||Et)(d.\u0275\u0275inject(W.HttpClient))}}static{this.\u0275prov=d.\u0275\u0275defineInjectable({token:Et,factory:Et.\u0275fac,providedIn:"root"})}}const St=new d.InjectionToken("DataServiceUri"),$i={provide:St,useFactory:s=>s?.isSSP?co:ao,deps:[[new d.Optional,Hi]]};class le{static{this.\u0275fac=function(t){return new(t||le)}}static{this.\u0275prov=d.\u0275\u0275defineInjectable({token:le,factory:le.\u0275fac})}}var de;(function(s){s[s.Guid=0]="Guid",s[s.Text=1]="Text",s[s.Integer=4]="Integer",s[s.Float=5]="Float",s[s.Money=6]="Money",s[s.DateTime=7]="DateTime",s[s.Date=8]="Date",s[s.Time=9]="Time",s[s.Lookup=10]="Lookup",s[s.Enum=11]="Enum",s[s.Boolean=12]="Boolean",s[s.Blob=13]="Blob",s[s.Image=14]="Image",s[s.CUSTOM_OBJECT=15]="CUSTOM_OBJECT",s[s.IMAGELOOKUP=16]="IMAGELOOKUP",s[s.COLLECTION=17]="COLLECTION",s[s.Color=18]="Color",s[s.LOCALIZABLE_STRING=19]="LOCALIZABLE_STRING",s[s.ENTITY=20]="ENTITY",s[s.ENTITY_COLLECTION=21]="ENTITY_COLLECTION",s[s.ENTITY_COLUMN_MAPPING_COLLECTION=22]="ENTITY_COLUMN_MAPPING_COLLECTION",s[s.HASH_TEXT=23]="HASH_TEXT",s[s.SECURE_TEXT=24]="SECURE_TEXT",s[s.FILE=25]="FILE",s[s.MAPPING=26]="MAPPING",s[s.SHORT_TEXT=27]="SHORT_TEXT",s[s.MEDIUM_TEXT=28]="MEDIUM_TEXT",s[s.MAXSIZE_TEXT=29]="MAXSIZE_TEXT",s[s.LONG_TEXT=30]="LONG_TEXT",s[s.FLOAT1=31]="FLOAT1",s[s.FLOAT2=32]="FLOAT2",s[s.FLOAT3=33]="FLOAT3",s[s.FLOAT4=34]="FLOAT4",s[s.LOCALIZABLE_PARAMETER_VALUES_LIST=35]="LOCALIZABLE_PARAMETER_VALUES_LIST",s[s.METADATA_TEXT=36]="METADATA_TEXT",s[s.STAGE_INDICATOR=37]="STAGE_INDICATOR",s[s.OBJECT_LIST=38]="OBJECT_LIST",s[s.COMPOSITE_OBJECT_LIST=39]="COMPOSITE_OBJECT_LIST",s[s.FLOAT8=40]="FLOAT8",s[s.FILE_LOCATOR=41]="FILE_LOCATOR",s[s.PHONE_TEXT=42]="PHONE_TEXT",s[s.RICH_TEXT=43]="RICH_TEXT",s[s.WEB_TEXT=44]="WEB_TEXT",s[s.EMAIL_TEXT=45]="EMAIL_TEXT",s[s.COMPOSITE_OBJECT=46]="COMPOSITE_OBJECT"})(de||(de={}));class jn extends Error{constructor(e){super(`Argument with name '${e}' is empty.`)}}class En extends Error{constructor(e){super(`Argument with name '${e}' is out of range.`)}}class S{static checkArgumentEmpty(e,t){if(t==null)throw new jn(e)}static checkArrayEmpty(e,t){if(S.checkArgumentEmpty(e,t),t.length===0)throw new jn(e)}static checkStringIsNotEmpty(e,t){if(this.checkArgumentEmpty(e,t),t==="")throw new jn(e);return t}static checkArgumentOutOfRange(e,t,n){if(n.begin&&t<n.begin)throw new En(e);if(n.end&&t>n.end)throw new En(e)}static checkEnumOutOfRange(e,t,n){if(!n||!Object.values(n).includes(t))throw new En(e)}}function Uc(s){return s=s||new Date,new Date(s.getFullYear(),s.getMonth(),s.getDate())}function Hc(s){return s=s||new Date,new Date(s.getFullYear(),s.getMonth(),s.getDate(),23,59,59,999)}function go(s){if(!s)return null;function e(){throw new Error(`String "${s}" is not a valid serialized date.`)}typeof s!="string"&&e();const[t,n]=s.split("T");if(n&&(n[n.length-1]==="Z"||n.indexOf("+")!==-1||n.indexOf("-")!==-1)){const o=Date.parse(s);return isNaN(o)&&e(),new Date(o)}try{const[o,a,c]=t.split("-"),[h,u,m]=n.split(":"),[w,v]=m.split(".");return new Date(parseInt(o),parseInt(a)-1,parseInt(c),parseInt(h),parseInt(u),parseInt(w),parseInt(v))}catch{e()}}function Kc(s,e){e==null&&(e=0),s.setSeconds(s.getSeconds()+e*3600)}function $c(s,e,t){const n=t||{hour:"2-digit",minute:"2-digit"};return new Intl.DateTimeFormat(e.sysCultureName,n).format(s)}class Ce{_getEntitySchemaColumnsDataValueTypesMap(e){return e.columns.reduce((t,n)=>(t[n.name]=n.dataValueType,t),{})}_getEntityColumnsDataValueTypesMap(e){return Object.keys(e).reduce((t,n)=>(t[n]=e[n].dataValueType,t),{})}_parseRawColumnValue(e,t){switch(t){case de.Date:case de.Time:case de.DateTime:return go(e);default:return e}}_parseRawEntityObject(e,t){const n={};return Object.keys(e).forEach(i=>{const o=e[i];n[i]=t[i]?this._parseRawColumnValue(o,t[i]):o}),n}deserializeEntity(e,t){S.checkArgumentEmpty("columnsConfig",e),S.checkArgumentEmpty("rawEntity",t);const n=this._getEntityColumnsDataValueTypesMap(e);return this._parseRawEntityObject(t,n)}deserializeEntities(e,t){S.checkArgumentEmpty("columnsConfig",e),S.checkArgumentEmpty("rawEntities",t);const n=this._getEntityColumnsDataValueTypesMap(e);return t.map(i=>this._parseRawEntityObject(i,n))}deserializeEntitySchemaRecord(e,t){S.checkArgumentEmpty("entitySchema",e),S.checkArgumentEmpty("rawEntities",t);const n=this._getEntitySchemaColumnsDataValueTypesMap(e);return this._parseRawEntityObject(t,n)}deserializeEntitySchemaRecords(e,t){S.checkArgumentEmpty("entitySchema",e),S.checkArgumentEmpty("rawEntities",t);const n=this._getEntitySchemaColumnsDataValueTypesMap(e);return t.map(i=>this._parseRawEntityObject(i,n))}static{this.\u0275fac=function(t){return new(t||Ce)}}static{this.\u0275prov=d.\u0275\u0275defineInjectable({token:Ce,factory:Ce.\u0275fac,providedIn:"root"})}}var D=p(78240);class Wi{constructor(e,t){this.operationType=e,this.rootSchemaName=t,S.checkArgumentEmpty("_operationType",e),S.checkArgumentEmpty("_rootSchemaName",t)}getMetadata(){return(0,D.classToPlain)(this,{exposeUnsetFields:!1,excludePrefixes:["_"]})}}class Ot{static{this._instanceOfKey="devkit_BaseFilter"}static get _instanceOfKeys(){return[this._instanceOfKey]}static[Symbol.hasInstance](e){return(e?.constructor?._instanceOfKeys??[]).includes(this._instanceOfKey)}constructor(e){this.isEnabled=!0,this.trimDateTimeParameterToDate=!1,this.filterType=e}static fromJson(e,t,n){throw new Error(`fromJson not supported on filter type ${this.constructor.name}`)}serializeItem(e){return typeof e.toJson=="function"?e.toJson():(0,D.classToPlain)(e,{exposeUnsetFields:!1,excludePrefixes:["_"]})}toJson(){return(0,D.classToPlain)(this,{exposeUnsetFields:!1,excludePrefixes:["_"]})}}class V extends Ot{static{this._instanceOfKey="devkit_SingleFilter"}static get _instanceOfKeys(){return[...Ot._instanceOfKeys,this._instanceOfKey]}constructor(e,t,n){super(e),this.comparisonType=t,this.leftExpression=n?.clone()}toJson(){return{...super.toJson(),leftExpression:this.serializeItem(this.leftExpression)}}_getUsedColumns(){return this.leftExpression._getUsedColumns()}}var te;(function(s){s[s.None=0]="None",s[s.Compare=1]="Compare",s[s.IsNull=2]="IsNull",s[s.Between=3]="Between",s[s.In=4]="In",s[s.Exists=5]="Exists",s[s.FilterGroup=6]="FilterGroup"})(te||(te={}));var R;(function(s){s[s.Between=0]="Between",s[s.Contain=11]="Contain",s[s.End_with=13]="End_with",s[s.Equal=3]="Equal",s[s.Exists=15]="Exists",s[s.Greater=7]="Greater",s[s.Greater_or_equal=8]="Greater_or_equal",s[s.Is_not_null=2]="Is_not_null",s[s.Is_null=1]="Is_null",s[s.Less=5]="Less",s[s.Less_or_equal=6]="Less_or_equal",s[s.Not_contain=12]="Not_contain",s[s.Not_end_with=14]="Not_end_with",s[s.Not_equal=4]="Not_equal",s[s.Not_exists=16]="Not_exists",s[s.Not_start_with=10]="Not_start_with",s[s.Start_with=9]="Start_with"})(R||(R={}));class kt extends V{static{this._instanceOfKey="devkit_BetweenFilter"}static get _instanceOfKeys(){return[...V._instanceOfKeys,this._instanceOfKey]}constructor(e,t,n){super(te.Between,R.Between,e),this.rightLessExpression=t?.clone(),this.rightGreaterExpression=n?.clone()}static fromJson(e,t,n){return new kt(n.fromJson(e.leftExpression,t),n.fromJson(e.rightLessExpression,t),n.fromJson(e.rightGreaterExpression,t))}clone(){const e=new kt(this.leftExpression,this.rightLessExpression,this.rightGreaterExpression);return e.isEnabled=this.isEnabled,e.trimDateTimeParameterToDate=this.trimDateTimeParameterToDate,e}toJson(){return{...super.toJson(),rightLessExpression:this.serializeItem(this.rightLessExpression),rightGreaterExpression:this.serializeItem(this.rightGreaterExpression)}}_getUsedColumns(){return[...super._getUsedColumns(),...this.rightLessExpression._getUsedColumns(),...this.rightGreaterExpression._getUsedColumns()]}}class At extends V{static{this._instanceOfKey="devkit_CompareFilter"}static get _instanceOfKeys(){return[...V._instanceOfKeys,this._instanceOfKey]}constructor(e,t,n){super(te.Compare,e,t),this.rightExpression=n?.clone()}static fromJson(e,t,n){return new At(e.comparisonType,n.fromJson(e.leftExpression,t),n.fromJson(e.rightExpression,t))}clone(){const e=new At(this.comparisonType,this.leftExpression,this.rightExpression);return e.isEnabled=this.isEnabled,e.trimDateTimeParameterToDate=this.trimDateTimeParameterToDate,e}toJson(){return{...super.toJson(),rightExpression:this.serializeItem(this.rightExpression)}}_getUsedColumns(){return[...super._getUsedColumns(),...this.rightExpression._getUsedColumns()]}}class We extends V{static{this._instanceOfKey="devkit_ExistsFilter"}static get _instanceOfKeys(){return[...V._instanceOfKeys,this._instanceOfKey]}constructor(e,t,n=R.Exists,i=!0){super(te.Exists,n,e),this.subFilters=t?.clone(),this.isAggregative=i}static fromJson(e,t,n){const i=n.fromJson(e.leftExpression,t),o=e.subFilters;let a;return o&&(a=t.fromJson(e.subFilters)),new We(i,a,e.comparisonType,e.isAggregative)}clone(){const e=new We(this.leftExpression,this.subFilters,this.comparisonType,this.isAggregative);return e.isEnabled=this.isEnabled,e.trimDateTimeParameterToDate=this.trimDateTimeParameterToDate,e}toJson(){const e=super.toJson();return this.subFilters&&(e.subFilters=this.serializeItem(this.subFilters)),e}_getUsedColumns(){return[...super._getUsedColumns(),...this.subFilters?._getUsedColumns()??[]]}}class Ve extends V{static{this._instanceOfKey="devkit_InFilter"}static get _instanceOfKeys(){return[...V._instanceOfKeys,this._instanceOfKey]}constructor(e,t,n){super(te.In,e,t),this.rightExpressions=n.map(i=>i?.clone())??[]}static fromJson(e,t,n){const i=e.rightExpressions??[];return new Ve(e.comparisonType,n.fromJson(e.leftExpression,t),i.map(o=>n.fromJson(o,t)))}clone(){const e=new Ve(this.comparisonType,this.leftExpression,this.rightExpressions);return e.isEnabled=this.isEnabled,e.trimDateTimeParameterToDate=this.trimDateTimeParameterToDate,e}toJson(){return{...super.toJson(),rightExpressions:this.rightExpressions.map(e=>this.serializeItem(e))}}_getUsedColumns(){const e=this.rightExpressions.map(t=>t._getUsedColumns()).flat();return[...super._getUsedColumns(),...e]}}class ne extends V{static{this._instanceOfKey="devkit_IsNullFilter"}static get _instanceOfKeys(){return[...V._instanceOfKeys,this._instanceOfKey]}constructor(e,t){[R.Is_null,R.Is_not_null].includes(e)||console.warn(`Invalid comparison type: ${R[e]} in IsNullFilter.`),super(te.IsNull,ne._getComparisonType(e),t),this.isNull=!0,this.isNull=this.comparisonType===R.Is_null}static _getComparisonType(e){return e===R.Is_not_null?e:R.Is_null}static fromJson(e,t,n){return new ne(ne._getComparisonType(e.comparisonType),n.fromJson(e.leftExpression,t))}clone(){const e=new ne(ne._getComparisonType(this.comparisonType),this.leftExpression);return e.isEnabled=this.isEnabled,e.trimDateTimeParameterToDate=this.trimDateTimeParameterToDate,e}}var It;(function(s){s[s.And=0]="And",s[s.Or=1]="Or"})(It||(It={}));var Sn;(function(s){s[s.None=0]="None",s[s.CurrentUser=1]="CurrentUser",s[s.CurrentUserContact=2]="CurrentUserContact",s[s.Yesterday=3]="Yesterday",s[s.Today=4]="Today",s[s.Tomorrow=5]="Tomorrow",s[s.PreviousWeek=6]="PreviousWeek",s[s.CurrentWeek=7]="CurrentWeek",s[s.NextWeek=8]="NextWeek",s[s.PreviousMonth=9]="PreviousMonth",s[s.CurrentMonth=10]="CurrentMonth",s[s.NextMonth=11]="NextMonth",s[s.PreviousQuarter=12]="PreviousQuarter",s[s.CurrentQuarter=13]="CurrentQuarter",s[s.NextQuarter=14]="NextQuarter",s[s.PreviousHalfYear=15]="PreviousHalfYear",s[s.CurrentHalfYear=16]="CurrentHalfYear",s[s.NextHalfYear=17]="NextHalfYear",s[s.PreviousYear=18]="PreviousYear",s[s.CurrentYear=19]="CurrentYear",s[s.PreviousHour=20]="PreviousHour",s[s.CurrentHour=21]="CurrentHour",s[s.NextHour=22]="NextHour",s[s.NextYear=23]="NextYear",s[s.NextNDays=24]="NextNDays",s[s.PreviousNDays=25]="PreviousNDays",s[s.NextNHours=26]="NextNHours",s[s.PreviousNHours=27]="PreviousNHours",s[s.PrimaryColumn=34]="PrimaryColumn",s[s.PrimaryDisplayColumn=35]="PrimaryDisplayColumn",s[s.PrimaryImageColumn=36]="PrimaryImageColumn",s[s.DayOfYearToday=37]="DayOfYearToday",s[s.DayOfYearTodayPlusDaysOffset=38]="DayOfYearTodayPlusDaysOffset",s[s.NextNDaysOfYear=39]="NextNDaysOfYear",s[s.PreviousNDaysOfYear=40]="PreviousNDaysOfYear",s[s.PrimaryColorColumn=41]="PrimaryColorColumn"})(Sn||(Sn={}));var he;(function(s){s[s.SchemaColumn=0]="SchemaColumn",s[s.Function=1]="Function",s[s.Parameter=2]="Parameter",s[s.SubQuery=3]="SubQuery",s[s.ArithmeticOperation=4]="ArithmeticOperation"})(he||(he={}));class G{static{this._instanceOfKey="devkit_BaseExpression"}static get _instanceOfKeys(){return[this._instanceOfKey]}static[Symbol.hasInstance](e){return(e?.constructor?._instanceOfKeys??[]).includes(this._instanceOfKey)}constructor(e){this.isBlock=!1,this.isBlock=e?.isBlock}static fromJson(e,t,n){throw new Error(`fromJson not supported on expression type ${this.constructor.name}`)}serializeItem(e){return typeof e.toJson=="function"?e.toJson():(0,D.classToPlain)(e,{exposeUnsetFields:!1,excludePrefixes:["_"]})}toJson(){return(0,D.classToPlain)(this,{exposeUnsetFields:!1,excludePrefixes:["_"]})}}class T extends G{static{this._instanceOfKey="devkit_ColumnExpression"}static get _instanceOfKeys(){return[...G._instanceOfKeys,this._instanceOfKey]}constructor(e){super(e),this.expressionType=he.SchemaColumn,this.columnPath=e?.columnPath}static fromJson(e){return new T({columnPath:e.columnPath})}clone(){return new T(this)}_getUsedColumns(){return[{path:this.columnPath}]}}class Dt extends G{static{this._instanceOfKey="devkit_FunctionExpression"}static get _instanceOfKeys(){return[...G._instanceOfKeys,this._instanceOfKey]}constructor(e){super(e),this.expressionType=he.Function}}var pe;(function(s){s[s.None=0]="None",s[s.Macros=1]="Macros",s[s.Aggregation=2]="Aggregation",s[s.DatePart=3]="DatePart",s[s.Length=4]="Length",s[s.Window=5]="Window",s[s.DateAdd=6]="DateAdd",s[s.DateDiff=7]="DateDiff"})(pe||(pe={}));class Ge extends Dt{static{this._instanceOfKey="devkit_MacrosFunctionExpression"}static get _instanceOfKeys(){return[...Dt._instanceOfKeys,this._instanceOfKey]}constructor(e){super(e),this.functionType=pe.Macros,this.macrosType=e?.macrosType,this.functionArgument=e?.functionArgument}static fromJson(e,t,n){const i=t&&n&&e.functionArgument?n.fromJson(e.functionArgument,t):void 0;return new Ge({functionArgument:i,macrosType:e.macrosType})}clone(){return new Ge(this)}_getUsedColumns(){return this.functionArgument?._getUsedColumns()??[]}}function mo(s){return s.getFullYear()<1970}function fo(s){const e=s.getTimezoneOffset()*6e4;return new Date(s.getTime()-e).toISOString().slice(0,-1)}function yo(s){const e=s.getFullYear(),t=Je(s.getMonth()+1),n=Je(s.getDate()),i=Je(s.getHours()),o=Je(s.getMinutes()),a=Je(s.getSeconds()),c=bo(s.getMilliseconds());return`${e}-${t}-${n}T${i}:${o}:${a}.${c}`}function Je(s){return String(s).padStart(2,"0")}function bo(s){return String(s).padStart(3,"0")}function _o(s){if(!(s instanceof Date))throw new TypeError;return mo(s)?yo(s):fo(s)}function xo(s){return`"${_o(s)}"`}class K extends G{static{this._instanceOfKey="devkit_ParameterExpression"}static get _instanceOfKeys(){return[...G._instanceOfKeys,this._instanceOfKey]}constructor(e){super(e),this.expressionType=he.Parameter;const t=e?.value;if(t instanceof Date){const n=new Date;n.setTime(t.getTime()),this.value=n}else t?this.value=typeof t=="object"?{...t}:t:this.value=t;this.dataValueType=e?.dataValueType??de.Text,this.parameter={dataValueType:this.dataValueType,...this._getParameterValueMetadata()}}static fromJson(e){return new K(e.parameter)}_convertStringToBlobArray(e){const t=[];let n=0;for(let i=0;i<e.length;i++){const o=e.charCodeAt(i);o<128?t[n++]=String.fromCharCode(o):o<2048?(t[n++]=String.fromCharCode(o>>6|192),t[n++]=String.fromCharCode(o&63|128)):(t[n++]=String.fromCharCode(o>>12|224),t[n++]=String.fromCharCode(o>>6&63|128),t[n++]=String.fromCharCode(o&63|128))}return t}_getParameterValueMetadata(){return this.dataValueType===de.Blob?{arrayValue:this.value?this._convertStringToBlobArray(this.value):[]}:this.value instanceof Date?{value:xo(this.value)}:{value:this.value}}clone(){return new K(this)}_getUsedColumns(){return[]}}(0,r.__decorate)([(0,D.Exclude)(),(0,r.__metadata)("design:type",Object)],K.prototype,"value",void 0),(0,r.__decorate)([(0,D.Exclude)(),(0,r.__metadata)("design:type",Number)],K.prototype,"dataValueType",void 0);class ue extends Ot{static{this._instanceOfKey="devkit_FilterGroup"}static get _instanceOfKeys(){return[...Ot._instanceOfKeys,this._instanceOfKey]}get items(){const e={};return this.filters.forEach((t,n)=>{e[n]=this.serializeItem(t)}),e}constructor(e=It.And,t){super(te.FilterGroup),this.filters=new Map,this.logicalOperation=e,this.rootSchemaName=t}static fromJson(e,t){const n=e.logicalOperation,i=new ue(n||It.And,e.rootSchemaName);return Object.entries(e.items).forEach(([o,a])=>{i.add(t.fromJson(a),o)}),i}toJson(){const e={};return e.filterType=this.filterType,e.isEnabled=this.isEnabled,e.logicalOperation=this.logicalOperation,e.trimDateTimeParameterToDate=this.trimDateTimeParameterToDate,e.items=this.items,this.rootSchemaName&&(e.rootSchemaName=this.rootSchemaName),e}_createParameterValueExpressions(e){return e.map(t=>new K({value:t}))}getItemByIndex(e){return this.items[Object.keys(this.items)[e]]}addSchemaColumnFilterWithParameter(e,t,n,i){const o=new T({columnPath:t}),a=new K({value:n}),c=new At(e,o,a);this.add(c,i)}addSchemaColumnInFilterWithParameters(e,t,n,i){const o=new T({columnPath:t}),a=this._createParameterValueExpressions(n),c=new Ve(e,o,a);this.add(c,i)}addPrimarySchemaColumnInFilter(e,t){const n=new Ge({macrosType:Sn.PrimaryColumn}),i=this._createParameterValueExpressions(e),o=new Ve(R.Equal,n,i);this.add(o,t)}addSchemaColumnIsNullFilter(e,t){const n=new T({columnPath:e}),i=new ne(R.Is_null,n);this.add(i,t)}addSchemaColumnIsNotNullFilter(e,t){const n=new T({columnPath:e}),i=new ne(R.Is_not_null,n);this.add(i,t)}addSchemaColumnBetweenFilterWithParameters(e,t,n,i){const o=new T({columnPath:e}),a=new K({value:t}),c=new K({value:n}),h=new kt(o,a,c);this.add(h,i)}addExistsFilter(e,t,n){const i=new T({columnPath:e}),o=new We(i,t);this.add(o,n)}addNotExistsFilter(e,t,n){const i=new T({columnPath:e}),o=new We(i,t,R.Not_exists);this.add(o,n)}add(e,t){S.checkArgumentEmpty("filter",e);const n=t||ft();this.filters.set(n,e)}clone(){const e=new ue(this.logicalOperation,this.rootSchemaName);return this.filters.forEach((t,n)=>{e.filters.set(n,t.clone())}),e.isEnabled=this.isEnabled,e.trimDateTimeParameterToDate=this.trimDateTimeParameterToDate,e}_getUsedColumns(){const e=[];return this.filters.forEach(t=>{let n=t._getUsedColumns?t._getUsedColumns():[];n=n.map(i=>({path:i.path,schemaName:i.schemaName??this.rootSchemaName})),e.push(...n)}),e}}(0,r.__decorate)([(0,D.Exclude)(),(0,r.__metadata)("design:type",Object)],ue.prototype,"filters",void 0),(0,r.__decorate)([(0,D.Expose)(),(0,r.__metadata)("design:type",Object),(0,r.__metadata)("design:paramtypes",[])],ue.prototype,"items",null);class Tt extends Wi{constructor(e,t){super(e,t),this.filters=new ue}clearFilters(){this.filters.filters.clear()}getMetadata(){return{...super.getMetadata(),filters:this.filters.toJson()}}_getUsedColumns(){const e=this.filters._getUsedColumns();return e.forEach(t=>{t.schemaName||(t.schemaName=this.rootSchemaName)}),e}}(0,r.__decorate)([(0,D.Exclude)(),(0,r.__metadata)("design:type",Object)],Tt.prototype,"filters",void 0);var we;(function(s){s[s.Select=0]="Select",s[s.Insert=1]="Insert",s[s.Update=2]="Update",s[s.Delete=3]="Delete"})(we||(we={}));class vo extends Error{constructor(e){super(`Item with key '${e}' does not exist.`)}}var On;(function(s){s[s.None=0]="None",s[s.Asc=1]="Asc",s[s.Desc=2]="Desc"})(On||(On={}));class J{constructor(e){this.orderDirection=On.None,this.orderPosition=-1,this.isVisible=!0,this.expression=e}withOrdering(e,t){return S.checkArgumentEmpty("orderDirection",e),S.checkArgumentEmpty("orderPosition",t),S.checkArgumentOutOfRange("orderPosition",t,{begin:-1}),this.orderDirection=e,this.orderPosition=t,this}withOptions(e){return S.checkArgumentEmpty("options",e),this.isVisible=e.isVisible??!0,this}withCaption(e){return S.checkArgumentEmpty("caption",e),this.caption=e,this}_getUsedColumns(){return this.expression._getUsedColumns()}}class Co extends J{constructor(e){super(new T({columnPath:e}))}}class Ze extends G{static{this._instanceOfKey="devkit_SubQueryExpression"}static get _instanceOfKeys(){return[...G._instanceOfKeys,this._instanceOfKey]}constructor(e){super(e),this.expressionType=he.SubQuery,this.columnPath=e?.columnPath;const t=e?.subFilters;typeof t?.clone=="function"?this.subFilters=t.clone():t?(this.subFilters=new ue(t.logicalOperation,t.rootSchemaName),this.subFilters.isEnabled=t.isEnabled,Object.entries(t.items).forEach(([n,i])=>{this.subFilters.add(i,n)})):this.subFilters=t,this.subOrderDirection=e.subOrderDirection,this.subOrderColumn=e.subOrderColumn}static fromJson(e,t){return new Ze({columnPath:e.columnPath,subFilters:t.fromJson(e.subFilters),subOrderDirection:e.subOrderDirection,subOrderColumn:e.subOrderColumn})}clone(){return new Ze(this)}toJson(){const e=super.toJson();return this.subFilters&&(e.subFilters=this.serializeItem(this.subFilters)),e}_getUsedColumns(){return[{path:this.columnPath},...this.subFilters?._getUsedColumns()??[]]}}class Pt extends Ze{static{this._instanceOfKey="devkit_AggregationSubQueryExpression"}static get _instanceOfKeys(){return[...Ze._instanceOfKeys,this._instanceOfKey]}constructor(e){super(e),this.aggregationType=e?.aggregationType,this.functionType=e?.functionType}static fromJson(e,t){const n=super.fromJson(e,t);return new Pt({aggregationType:e.aggregationType,functionType:e.functionType,...n})}clone(){return new Pt(this)}}class wo extends J{constructor(e,t,n,i,o){super(new Pt({aggregationType:t,columnPath:e,subFilters:n,subOrderDirection:i,subOrderColumn:o}))}}class jo extends J{constructor(e,t){super(new K({value:e,dataValueType:t}))}}class Mt extends G{static{this._instanceOfKey="devkit_ArithmeticExpression"}static get _instanceOfKeys(){return[...G._instanceOfKeys,this._instanceOfKey]}constructor(e){super(e),this.expressionType=he.ArithmeticOperation,this.arithmeticOperation=e?.arithmeticOperation,this.leftArithmeticOperand=e?.leftArithmeticOperand.clone(),this.rightArithmeticOperand=e?.rightArithmeticOperand.clone()}static fromJson(e,t,n){const i=n?.fromJson(e.leftArithmeticOperand,t),o=n?.fromJson(e.rightArithmeticOperand,t),a={leftArithmeticOperand:i,rightArithmeticOperand:o,arithmeticOperation:e.arithmeticOperation,isBlock:e.isBlock};return new Mt(a)}clone(){return new Mt(this)}_getUsedColumns(){return[...this.leftArithmeticOperand._getUsedColumns(),...this.rightArithmeticOperand._getUsedColumns()]}}class Eo extends J{constructor(e,t,n){super(new Mt({arithmeticOperation:e,leftArithmeticOperand:t,rightArithmeticOperand:n}))}}class So extends J{constructor(e){super(new Ge({macrosType:e}))}}class ie extends Dt{static{this._instanceOfKey="devkit_ArgumentFunctionExpression"}static get _instanceOfKeys(){return[...Dt._instanceOfKeys,this._instanceOfKey]}constructor(e){super(e),this.functionArgument=e?.functionArgument?.clone()}toJson(){const e=super.toJson();return this.functionArgument&&(e.functionArgument=this.serializeItem(this.functionArgument)),e}_getUsedColumns(){return this.functionArgument?._getUsedColumns()??[]}}class Rt extends ie{static{this._instanceOfKey="devkit_DatePartFunctionExpression"}static get _instanceOfKeys(){return[...ie._instanceOfKeys,this._instanceOfKey]}constructor(e){super(e),this.functionType=pe.DatePart,this.datePartType=e?.datePartType}static fromJson(e,t,n){const i=n?.fromJson(e.functionArgument,t),o=e.datePartType;return new Rt({functionArgument:i,datePartType:o,isBlock:e.isBlock})}clone(){return new Rt(this)}}class Oo extends J{constructor(e,t){super(new Rt({datePartType:e,functionArgument:t}))}get datePartType(){return this.expression?.datePartType}}class Ye extends ie{static{this._instanceOfKey="devkit_AggregationFunctionExpression"}static get _instanceOfKeys(){return[...ie._instanceOfKeys,this._instanceOfKey]}constructor(e){super(e),this.functionType=pe.Aggregation,this.aggregationType=e?.aggregationType,this.aggregationEvalType=e?.aggregationEvalType}static fromJson(e,t,n){const i=n?.fromJson(e.functionArgument,t),o=e.aggregationType,a=e.aggregationEvalType;return new Ye({functionArgument:i,aggregationType:o,aggregationEvalType:a,isBlock:e.isBlock})}clone(){return new Ye(this)}}class ko extends J{constructor(e,t,n){super(new Ye({aggregationType:e,aggregationEvalType:t,functionArgument:n}))}}class Lt extends ie{static{this._instanceOfKey="devkit_LengthFunctionExpression"}static get _instanceOfKeys(){return[...ie._instanceOfKeys,this._instanceOfKey]}constructor(e){super(e),this.functionType=pe.Length}static fromJson(e,t,n){const i=n?.fromJson(e.functionArgument,t);return new Lt({functionArgument:i,isBlock:e.isBlock})}clone(){return new Lt(this)}}class Ao extends J{constructor(e){super(new Lt({functionArgument:e}))}}class Bt extends ie{static{this._instanceOfKey="devkit_WindowFunctionExpression"}static get _instanceOfKeys(){return[...ie._instanceOfKeys,this._instanceOfKey]}constructor(e){super(e),this.functionType=pe.Window}static fromJson(e,t,n){const i=n?.fromJson(e.functionArgument,t);return new Bt({functionArgument:i,isBlock:e.isBlock})}clone(){return new Bt(this)}}class Io extends J{constructor(e){super(new Bt({functionArgument:e}))}}var Ft;(function(s){s[s.None=0]="None",s[s.All=1]="All",s[s.Distinct=2]="Distinct"})(Ft||(Ft={}));class kn extends Tt{constructor(e){super(we.Select,e),this._columns=new Map,this.isDistinct=!1,this.rowCount=-1,this.rowsOffset=-1,this.useLocalization=!0,this.useRecordDeactivation=!1,this._getIsPageable=()=>this.rowCount>0&&this.rowsOffset>-1}_internalAddColumn(e,t){this._columns.has(e)||this._columns.set(e,t)}getColumn(e){if(!this._columns.has(e))throw new vo(e);return this.findColumn(e)}findColumn(e){return this._columns.get(e)}getMetadata(){return{...super.getMetadata(),columns:{items:(0,D.classToPlain)(this._columns,{exposeUnsetFields:!1,excludePrefixes:["_"]})},allColumns:!1,isDistinct:this.isDistinct,ignoreDisplayValues:!1,rowCount:this.rowCount,rowsOffset:this.rowsOffset,adminUnitRoleSources:this.adminUnitRoleSources,isPageable:this._getIsPageable(),conditionalValues:this.conditionalValues?this.conditionalValues:null,isHierarchical:!1,hierarchicalMaxDepth:0,hierarchicalColumnName:null,hierarchicalColumnValue:null,useLocalization:this.useLocalization,useRecordDeactivation:this.useRecordDeactivation}}addColumn(e,t){return this._internalAddColumn(t,e),e}addSchemaColumn(e,t){S.checkArgumentEmpty("columnPath",e);const n=new Co(e);return this._internalAddColumn(t||e,n),n}addAggregationSubQueryColumn(e,t,n,i){const o=new wo(e,t,n.filter,n.sortByDirection,n.sortByColumn);return this._internalAddColumn(i||e,o),o}addParameterColumn(e,t,n){const i=new jo(e,t);return this._internalAddColumn(n,i),i}addArithmeticColumn(e,t,n,i){const o=new Eo(e,t,n);return this._internalAddColumn(i,o),o}addMacrosFunctionColumn(e,t){const n=new So(e);return this._internalAddColumn(t,n),n}addDatePartFunctionColumn(e,t,n){const i=new T({columnPath:e}),o=new Oo(t,i);return this._internalAddColumn(n,o),o}addAggregationFunctionColumn(e,t,n,i=Ft.None){const o=new T({columnPath:e}),a=new ko(t,i,o);return this._internalAddColumn(n,a),a}addLengthFunctionColumn(e,t){const n=new T({columnPath:e}),i=new Ao(n);return this._internalAddColumn(t,i),i}addWindowFunctionColumn(e,t,n,i=Ft.None){const o=new Ye({aggregationType:t,aggregationEvalType:i,functionArgument:new T({columnPath:e})}),a=new Io(o);return this._internalAddColumn(n,a),a}_getUsedColumns(){const e=[];return this._columns.forEach(t=>{e.push(...t._getUsedColumns())}),e.forEach(t=>{t.schemaName||(t.schemaName=this.rootSchemaName)}),[...e,...super._getUsedColumns()]}}class Do extends kn{}class Vi extends Wi{constructor(e){super(we.Insert,e),this._columnValues=new Map}get columnValues(){return{items:(0,D.classToPlain)(this._columnValues)}}addColumn(e,t,n){S.checkArgumentEmpty("columnName",e),this._columnValues.set(e,new K({value:t,dataValueType:n}))}}(0,r.__decorate)([(0,D.Expose)(),(0,r.__metadata)("design:type",Object),(0,r.__metadata)("design:paramtypes",[])],Vi.prototype,"columnValues",null);class Gi extends Tt{constructor(e){super(we.Update,e),this._columnValues=new Map,this.isForceUpdate=!1}get columnValues(){return{items:(0,D.classToPlain)(this._columnValues)}}addColumn(e,t,n){S.checkArgumentEmpty("columnName",e),this._columnValues.set(e,new K({value:t,dataValueType:n}))}}(0,r.__decorate)([(0,D.Expose)(),(0,r.__metadata)("design:type",Object),(0,r.__metadata)("design:paramtypes",[])],Gi.prototype,"columnValues",null);class To extends Tt{constructor(e){super(we.Delete,e)}}var Xe;(function(s){s[s.General=0]="General",s[s.Limited=1]="Limited"})(Xe||(Xe={}));var An;(function(s){s[s.Undefined=0]="Undefined",s[s.Filter=1]="Filter",s[s.FilterSummary=2]="FilterSummary"})(An||(An={}));var In;(function(s){s[s.Session=0]="Session",s[s.Workspace=1]="Workspace",s[s.Application=2]="Application"})(In||(In={}));class Po{constructor(e=In.Session,t="",n=""){this._cacheLevel=e,this._cacheGroup=t,this._cacheItemName=n}getMetadata(){return{cacheLevel:this._cacheLevel,cacheGroup:this._cacheGroup,cacheItemName:this._cacheItemName}}}class zt extends Error{constructor(e){const t=e?.error?.responseStatus?.Message||e?.responseStatus?.Message||e?.message;super(t),this.errorCode=e?.error?.responseStatus?.ErrorCode}}class Ji extends Error{constructor(e){super(`Query with config
${JSON.stringify(e.getMetadata())}
finished with error.`)}}let Nt=class extends le{constructor(e,t,n){super(),this._sysSettingsService=e,this._httpClient=t,this._dataServiceUri=n,this._defaultDebounceTime=200,this._debounceTimeSysSettingName="QueryExecutorDebounceTime",this._requests=new x.Subject,S.checkArgumentEmpty("_httpClient",t),S.checkArgumentEmpty("_dataServiceUri",n)}_executeWritableQuery(e,t){const i={...e.getMetadata(),queryKind:Xe.General};return this._httpClient.post(t,i).pipe((0,C.catchError)(o=>{throw new zt(o)}),(0,C.tap)(o=>{if(!(o&&o.success))throw new Ji(e)}))}_getQueryUri(e){if(e instanceof Do)return`${this._dataServiceUri}/SelectLocalizationQuery`;if(e instanceof kn)return`${this._dataServiceUri}/SelectQuery`;if(e instanceof Vi)return`${this._dataServiceUri}/InsertQuery`;if(e instanceof Gi)return`${this._dataServiceUri}/UpdateQuery`;if(e instanceof To)return`${this._dataServiceUri}/DeleteQuery`;throw new Error("Unsupported query type")}_getBundleSettings(){var e=this;return(0,E.A)(function*(){return e._sysSettingsService?{executionDebounceTime:(yield e._sysSettingsService.getByCodes([e._debounceTimeSysSettingName])).values[e._debounceTimeSysSettingName]?.value||e._defaultDebounceTime}:Promise.resolve({executionDebounceTime:e._defaultDebounceTime})})()}_prepareDebouncedResponsesStream(){if(this._responses)return;let e=0;const t=(0,C.buffer)(this._requests.pipe((0,C.switchMap)(()=>(0,x.from)(this._getBundleSettings())),(0,C.tap)(n=>e=n.executionDebounceTime),(0,C.debounceTime)(e)));this._responses=this._requests.pipe(t,(0,C.filter)(n=>!!n.length),(0,C.mergeMap)(n=>{const i=n.map(a=>a.id),o=n.map(a=>a.query);return this.executeBatchSelectQuery(o).pipe((0,C.map)(a=>i.reduce((c,h,u)=>c.set(h,a[u]),new Map)))}),(0,C.share)())}_executeThrottled(e){this._prepareDebouncedResponsesStream();const t={id:ft(),query:e},n=this._responses.pipe((0,C.filter)(i=>i.has(t.id)),(0,C.map)(i=>i.get(t.id)),(0,C.take)(1));return n.subscribe(),this._requests.next(t),n}_executeImmediate(e){S.checkArgumentEmpty("query",e);const t=this._getQueryUri(e),n=this._getQueryRequest(e);return this._httpClient.post(t,n).pipe((0,C.catchError)(i=>{throw new zt(i)}),(0,C.tap)(i=>{if(!i?.rows)throw new Ji(e)}),(0,C.map)(i=>this._toSelectQueryResponse(i)))}_toSelectQueryResponse(e){const t=this.getRowsFromResponse(e);return t.rowsAffected=e.rowsAffected,e.errorInfo&&(t.errorInfo=e.errorInfo),t}_getQueryRequest(e){const t=e.getMetadata();return e instanceof kn?{...t,queryKind:Xe.General,serverESQCacheParameters:new Po().getMetadata(),queryOptimize:!1,useMetrics:!1,querySource:An.Undefined}:{...t,queryKind:Xe.General}}getRowsFromResponse(e){return e.rows}executeSelectQuery(e,t={throttled:!1}){return t.throttled?this._executeThrottled(e):this._executeImmediate(e)}executeInsertQuery(e){return this.execute(e)}executeUpdateQuery(e){return this.execute(e)}executeDeleteQuery(e){return this.execute(e)}execute(e){S.checkArgumentEmpty("query",e);const t=this._getQueryUri(e);return this._executeWritableQuery(e,t)}executeBatchSelectQuery(e){if(S.checkArgumentEmpty("queries",e),e.length===0)return(0,x.of)([]);const t=`${this._dataServiceUri}/BatchQuery`,n={items:[]};return n.items=e.map(i=>({...this._getQueryRequest(i),__type:"Terrasoft.Nui.ServiceModel.DataContract.SelectQuery"})),this._httpClient.post(t,n).pipe((0,C.catchError)(i=>{throw new zt(i)}),(0,C.tap)(i=>{if(!i||i.hasErrors)throw new zt(i)}),(0,C.map)(i=>i.queryResults.map(o=>this._toSelectQueryResponse(o))))}commitTransaction(e){throw new Error("Method not implemented.")}rollbackTransaction(e){throw new Error("Method not implemented.")}};Nt=(0,r.__decorate)([(0,r.__param)(0,(0,d.Optional)()),(0,r.__param)(2,(0,d.Inject)(St)),(0,r.__metadata)("design:paramtypes",[ee,W.HttpClient,String])],Nt);let Dn=class gn extends Nt{constructor(e,t,n,i){super(e,t,i),this._entityDeserializer=n}getRowsFromResponse(e){return this._entityDeserializer.deserializeEntities(e.rowConfig,e.rows)}static{this.\u0275fac=function(t){return new(t||gn)(d.\u0275\u0275inject(ee,8),d.\u0275\u0275inject(W.HttpClient),d.\u0275\u0275inject(Ce),d.\u0275\u0275inject(St))}}static{this.\u0275prov=d.\u0275\u0275defineInjectable({token:gn,factory:gn.\u0275fac})}};Dn=(0,r.__decorate)([Fs({requestType:"crt.DataServiceQueryExecutor"}),(0,r.__metadata)("design:paramtypes",[ee,W.HttpClient,Ce,String])],Dn);class Qe{static{this.\u0275fac=function(t){return new(t||Qe)}}static{this.\u0275mod=d.\u0275\u0275defineNgModule({type:Qe})}static{this.\u0275inj=d.\u0275\u0275defineInjector({providers:[$i,{provide:le,useClass:Dn}]})}}class Tn{static{this.\u0275fac=function(t){return new(t||Tn)}}static{this.\u0275mod=d.\u0275\u0275defineNgModule({type:Tn})}static{this.\u0275inj=d.\u0275\u0275defineInjector({providers:[$i,{provide:le,useFactory:(e,t,n)=>new Nt(e,t,n),deps:[[new d.Optional,ee],W.HttpClient,St]}]})}}var ge=p(93883),qe=p(23023),je=p(52989);function Mo(s,e){if(s&1&&d.\u0275\u0275element(0,"mat-icon",5),s&2){const t=d.\u0275\u0275nextContext();d.\u0275\u0275property("svgIcon",t.icon)}}function Ro(s,e){if(s&1&&d.\u0275\u0275element(0,"mat-icon",10),s&2){const t=d.\u0275\u0275nextContext().$implicit;d.\u0275\u0275property("svgIcon",t==null?null:t.icon)}}function Lo(s,e){if(s&1){const t=d.\u0275\u0275getCurrentView();d.\u0275\u0275elementStart(0,"button",8),d.\u0275\u0275listener("click",function(i){const o=d.\u0275\u0275restoreView(t).$implicit,a=d.\u0275\u0275nextContext(2);return d.\u0275\u0275resetView(a.onActionClick(o==null?null:o.handler,i))}),d.\u0275\u0275template(1,Ro,1,1,"mat-icon",9),d.\u0275\u0275elementStart(2,"span"),d.\u0275\u0275text(3),d.\u0275\u0275elementEnd()()}if(s&2){const t=e.$implicit;d.\u0275\u0275advance(),d.\u0275\u0275property("ngIf",t==null?null:t.icon),d.\u0275\u0275advance(2),d.\u0275\u0275textInterpolate(t==null?null:t.caption)}}function Bo(s,e){if(s&1&&(d.\u0275\u0275elementStart(0,"div",6),d.\u0275\u0275template(1,Lo,4,2,"button",7),d.\u0275\u0275elementEnd()),s&2){const t=d.\u0275\u0275nextContext();d.\u0275\u0275advance(),d.\u0275\u0275property("ngForOf",t.actions)}}function Fo(s,e){if(s&1){const t=d.\u0275\u0275getCurrentView();d.\u0275\u0275elementStart(0,"button",11),d.\u0275\u0275pipe(1,"translate"),d.\u0275\u0275listener("click",function(i){d.\u0275\u0275restoreView(t);const o=d.\u0275\u0275nextContext();return d.\u0275\u0275resetView(o.onClose(i))}),d.\u0275\u0275element(2,"mat-icon",12),d.\u0275\u0275elementEnd()}s&2&&d.\u0275\u0275attribute("aria-label",d.\u0275\u0275pipeBind1(1,1,"Dialog.Close"))}class Ee{constructor(e,t){this.snackBarRef=e,this.data=t,this.message=t.message,this.actions=t.actions,this.closeMode=t.closeMode,this.icon=t.icon}onClose(e){e?.stopPropagation(),this.snackBarRef.dismiss()}onActionClick(e,t){var n=this;return(0,E.A)(function*(){yield e?.call(n,t),n.snackBarRef.dismiss()})()}static{this.\u0275fac=function(t){return new(t||Ee)(d.\u0275\u0275directiveInject(ge.MatLegacySnackBarRef),d.\u0275\u0275directiveInject(ge.MAT_LEGACY_SNACK_BAR_DATA))}}static{this.\u0275cmp=d.\u0275\u0275defineComponent({type:Ee,selectors:[["ts-notify"]],decls:7,vars:6,consts:[[1,"crt-notify-container"],["class","crt-notify-icon",3,"svgIcon",4,"ngIf"],["data-qa","notificationPopup",1,"crt-notify-message"],["class","crt-notify-actions",4,"ngIf"],["mat-flat-button","","class","crt-notify-close-button-icon","type","button",3,"click",4,"ngIf"],[1,"crt-notify-icon",3,"svgIcon"],[1,"crt-notify-actions"],["type","button","mat-flat-button","",3,"click",4,"ngFor","ngForOf"],["type","button","mat-flat-button","",3,"click"],["class","crt-notify-action-button-icon",3,"svgIcon",4,"ngIf"],[1,"crt-notify-action-button-icon",3,"svgIcon"],["mat-flat-button","","type","button",1,"crt-notify-close-button-icon",3,"click"],["svgIcon","icon_close_24"]],template:function(t,n){t&1&&(d.\u0275\u0275elementStart(0,"div",0),d.\u0275\u0275template(1,Mo,1,1,"mat-icon",1),d.\u0275\u0275elementStart(2,"output",2),d.\u0275\u0275text(3),d.\u0275\u0275pipe(4,"translate"),d.\u0275\u0275elementEnd(),d.\u0275\u0275template(5,Bo,2,1,"div",3)(6,Fo,3,3,"button",4),d.\u0275\u0275elementEnd()),t&2&&(d.\u0275\u0275advance(),d.\u0275\u0275property("ngIf",n.icon),d.\u0275\u0275advance(2),d.\u0275\u0275textInterpolate(d.\u0275\u0275pipeBind1(4,4,n.message)),d.\u0275\u0275advance(2),d.\u0275\u0275property("ngIf",n.actions==null?null:n.actions.length),d.\u0275\u0275advance(),d.\u0275\u0275property("ngIf",n.closeMode!=="auto"))},dependencies:[P.NgForOf,P.NgIf,qe.MatLegacyButton,je.MatIcon,z.TranslatePipe],styles:[".crt-notify-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center}.crt-notify-container[_ngcontent-%COMP%]   .crt-notify-message[_ngcontent-%COMP%]{flex:1}.crt-notify-container[_ngcontent-%COMP%]   .crt-notify-icon[_ngcontent-%COMP%]{width:16px;margin-inline-end:8px}.crt-notify-container[_ngcontent-%COMP%]   .crt-notify-close-button-icon[_ngcontent-%COMP%]{padding:0;min-width:initial;margin-inline-start:16px}.crt-notify-container[_ngcontent-%COMP%]   .crt-notify-actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center;margin-inline-start:40px}.crt-notify-container[_ngcontent-%COMP%]   .crt-notify-actions[_ngcontent-%COMP%]   .crt-notify-action-button-icon[_ngcontent-%COMP%]{width:16px;margin-inline-end:4px}"]})}}class Se{constructor(e,t,n){this._snackBar=e,this._zone=t,this._environment=n,this._defaultDuration=this._environment?.defaultNotifyPopupDuration||5e3}show(e){const{message:t,duration:n,panelClass:i,icon:o,closeMode:a="default",actions:c=[]}=e||{},h=i?Array.isArray(i)?i:[i]:[],u=this._zone.run(()=>this._snackBar.openFromComponent(Ee,{data:{message:t,actions:c,closeMode:a,icon:o},duration:a==="manual"?0:n??this._defaultDuration,verticalPosition:"bottom",panelClass:["crt-notify",...h]}));return Promise.resolve(u)}error({message:e,duration:t}){return this.show({message:e,duration:t,panelClass:"notify-service-error"})}warn({message:e,duration:t}){return this.show({message:e,duration:t,panelClass:"notify-service-warn"})}info({message:e,duration:t}){return this.show({message:e,duration:t,panelClass:"notify-service-info"})}static{this.\u0275fac=function(t){return new(t||Se)(d.\u0275\u0275inject(ge.MatLegacySnackBar),d.\u0275\u0275inject(d.NgZone),d.\u0275\u0275inject("environment",8))}}static{this.\u0275prov=d.\u0275\u0275defineInjectable({token:Se,factory:Se.\u0275fac})}}var L;(function(s){s.connection="connection",s.defaultConnection="defaultConnection",s.label="label",s.root="root",s.shape="shape"})(L||(L={}));const Oe={root:{id:"root1",type:L.root}},b={element:{deleteElementsExecuted:"commandStack.elements.delete.executed",paste:"elements.paste",updateLabel:"element.updateLabel",updateLabelExecuted:"commandStack.element.updateLabel.executed",mouseDown:"element.mousedown",doubleClick:"element.dblclick",update:"element.update",updated:"element.updated",typeUpdated:"element.typeUpdated",click:"element.click",updateExecuted:"commandStack.element.update.executed",validation:"element.validation",canUpdateType:"element.canUpdateType"},elements:{create:"elements.create",move:"elements.move",delete:"elements.delete",removing:"elements.removing",updatingTypeValidate:"elements.updatingTypeValidate",canCopy:"elements.canCopy",changed:"elements.changed"},directEditing:{activate:"directEditing.activate",complete:"directEditing.complete",cancel:"directEditing.cancel",resize:"directEditing.resize"},label:{createExecuted:"commandStack.label.create.executed",create:"label.create"},lane:{create:"lane.create",resize:"lane.resize",split:"lane.split"},diagram:{create:"diagram.create",changed:"diagram.changed",initialized:"diagram.initialized"},selection:{changed:"selection.changed"},shape:{createExecuted:"commandStack.shape.create.executed",moveExecuted:"commandStack.shape.move.executed",resizeExecuted:"commandStack.shape.resize.executed",deleteExecuted:"commandStack.shape.delete.executed",move:"shape.move.move",end:"shape.move.end",shapeMove:"shape.move",shapeCreate:"shape.create",shapeResize:"shape.resize",shapeDelete:"shape.delete"},import:{elementAdd:"import.element.add"},connection:{createExecuted:"commandStack.connection.create.executed",update:"connection.update",updateExecuted:"commandStack.connection.update.executed",moveExecuted:"commandStack.connection.move.executed",layoutExecuted:"commandStack.connection.layout.executed",reconnectEndExecuted:"commandStack.connection.reconnectEnd.executed",updateWaypointsExecuted:"commandStack.connection.updateWaypoints.executed",reconnectExecuted:"commandStack.connection.reconnect.executed",deleteExecuted:"commandStack.connection.delete.executed",changeDirection:"connection.changeDirection",changeDirectionExecuted:"commandStack.connection.changeDirection.executed",reconnect:"connection.reconnect",moveConnectionLabel:"connection.move.label",highlight:"commandStack.connection.highlight.executed"},connect:{move:"connect.move",hover:"connect.hover",end:"connect.end"},create:{move:"create.move",end:"create.end"}};var zo=p(13457);class ke{getFeatureValues(e){return(0,x.of)([]).subscribe(()=>e({}))}static{this.\u0275fac=function(t){return new(t||ke)}}static{this.\u0275prov=d.\u0275\u0275defineInjectable({token:ke,factory:ke.\u0275fac})}}const Ut=new d.InjectionToken("DiagramFeaturesToken");class et{get data(){return this.diagramData}set data(e){this.diagramData=e}get diagram(){return this.internalDiagram}set diagram(e){this.internalDiagram=e}getDiagramDataId(){return this.diagramData?this.diagramData.id:null}getDiagramDataCaption(){return this.diagramData?this.diagramData.caption:null}hasDiagramData(){return!!this.diagramData}static{this.\u0275fac=function(t){return new(t||et)}}static{this.\u0275prov=d.\u0275\u0275defineInjectable({token:et,factory:et.\u0275fac,providedIn:"root"})}}class Z{constructor(){this.error$=new x.Subject,this.updateElementCaption$=new x.Subject,this.updateConnectionCaption$=new x.Subject,this.updateCaption$=new x.Subject,this.changed$=new x.Subject,this.startLoading$=new x.Subject,this.endLoading$=new x.ReplaySubject(1)}init(){}bufferiseOps(e,t,n){}load(e,t){return(0,E.A)(function*(){return Promise.resolve(null)})()}getDiagramConfig(){return(0,E.A)(function*(){return Promise.resolve()})()}diagramInitialized(){}commit(e){return(0,E.A)(function*(){})()}undo(){}redo(){}clearCash(){}static{this.\u0275fac=function(t){return new(t||Z)}}static{this.\u0275prov=d.\u0275\u0275defineInjectable({token:Z,factory:Z.\u0275fac})}}const No=["diagramContainer"],Uo=["resetZoomButton"];class Ae{set _isReadOnly(e){this.isReadOnly=e==="true"}set _isStraightConnection(e){this.isStraightConnection=e==="true"}set _isRtl(e){this.isRtl=e==="rtl"}get diagramEventHandlerController(){return this.get("diagramEventHandlerController")}get _diagramLoader(){return this.get("diagramLoader")}get modeling(){return this.get("modeling")}constructor(e){this.injector=e,this._initScale=1,this._unloaded$=new x.Subject,this._defaultTool="arrow",this.isRtl=!1,this.destroyed$=new x.Subject,this.initScroll={x:0,y:0},this.loaded=new x.Subject,this.loading=!0,this.elementDblClick=new d.EventEmitter,this.elementSelected=new d.EventEmitter,this.diagramInitialized=new d.EventEmitter,this.afterViewInit=new d.EventEmitter,this.loadProgress$=new x.Subject,this.isReadOnly=!1,this.isStraightConnection=!1,this.injectDependencies()}_initDiagram(e){this.diagramContainer=new d.ElementRef(document.querySelector(".diagram-container")),this.diagram=new zo.A({canvas:{container:this.diagramContainer.nativeElement},keyboard:{bindTo:window},modules:[this.features,{loggerService:["value",this.loggerService]}],isReadOnly:this.isReadOnly,isStraightConnection:this.isStraightConnection,isRtl:this.isRtl,popupMenu:{scale:{min:1,max:1}},contextPad:{scale:{min:1,max:1}},initScroll:this.initScroll,initScale:this._initScale,...e}),this.diagramDataService.diagram=this.diagram,this.diagramEventHandlerController.service=this.service;const t=this.get("canvas"),n=this.get("editorActions"),i=this.get("elementFactory"),o=this.get("eventBus");o.fire("attach",{}),o.fire("editorActions.init",{editorActions:n});const a=i.createRoot({id:Oe.root.id});t.setRootElement(a),this.tool=this._defaultTool,this._serviceSubscriptions=this._subscribeService(),this.get("featureProvider").featureService=this.featureService}_setSelectedElement(e){if(e){const t=this.get("eventBus"),i=this.get("elementRegistry").get(e);i&&t.fire("element.click",{element:i})}}_subscribeLoadingData(){var e=this;const t=this.service.startLoading$.subscribe(i=>{this.dataId!==i&&(this.loading=!0)}),n=this.service.endLoading$.pipe((0,C.filter)(i=>i&&this.dataId!==i.id)).subscribe(function(){var i=(0,E.A)(function*(o){e._unloaded$.next(),yield e.loadDiagramData(o)});return function(o){return i.apply(this,arguments)}}());this._serviceSubscriptions.push(t,n),this.diagramInitialized.emit(),this.get("eventBus").fire(b.diagram.initialized)}_getCancellationToken(){const e=new x.Subject;return(0,x.merge)(this.destroyed$,this._unloaded$).subscribe(()=>{e.next(),e.complete()}),e}_subscribeService(){var e=this;const t=this.diagramEventHandlerController.subscribeServerChanges();return t.push(this.service.error$.pipe((0,C.takeUntil)(this.destroyed$),(0,C.debounceTime)(1e3)).subscribe(function(){var n=(0,E.A)(function*(i){yield e.notifyService.error({message:i});const o=e.diagramDataService.getDiagramDataId();e.loggerService.exception(i,{loggerName:"DiagramService"},{diagramDataId:o})});return function(i){return n.apply(this,arguments)}}()),this.service.updateCaption$.subscribe(n=>this._changeCaption(n))),t}_unsubscribeService(){this._serviceSubscriptions&&this._serviceSubscriptions.forEach(e=>e.unsubscribe())}unloadDiagramData(){this.diagram&&(this.get("directEditing").complete(),this._clearDiagram())}initDiagramData(e){var t=this;return(0,E.A)(function*(){t._initLocalStorage(),t._initZoomScroll(),t.diagramEventHandlerController.stopSync(),t.unloadDiagramData();const n=yield t._diagramLoader.load(t.diagramDataService.data,e,t.loadProgress$);if(e.isStopped)return;const i=n&&n[0];i&&(yield t.notifyService.show({message:i})),t.diagramEventHandlerController.startSync()})()}_changeCaption(e){this.caption=e.value}_initLocalStorage(){const e=this.get("localStorage");e.diagramId=this.diagramDataService.getDiagramDataId()}_initZoomScroll(){this.get("zoomScroll").initZoomScroll()}_subscribeDiagramChanges(){const e=this.get("eventBus");e.on(["create.end","connect.end","element.click","shape.move.end"],t=>{this._onSelectedElementChanged(t.element||t.context.shape||t.context.connection)}),e.on(["shape.replaced"],t=>g.defer(()=>this._onSelectedElementChanged(t))),e.on(["selection.changed"],t=>{const n=t.newSelection,i=n.length===1&&n[0];i&&!this.loading&&this._onSelectedElementChanged(i)}),e.on(["tool-manager.update"],t=>this._onToolChanged(t.tool)),e.on(["element.dblclick"],()=>this._elementDblClick())}_elementDblClick(){this.elementDblClick.emit()}_onSelectedElementChanged(e){let t=null;const n={source:this,id:t};e&&e.type!==Oe.root.type&&(t=(e.labelTarget||e).id,n.id=t),this.elementSelected.emit(n),this.get("eventBus").fire("diagram.item.selected",{id:t})}_onToolChanged(e){this.tool=e||this._defaultTool}_getLocalizationObject(e){return{get:t=>{const n=t.split(".");let i=e;for(const o of n){if(!i||!i.hasOwnProperty(o))return t;i=i[o]}return i??t}}}_getDiagramLocalizableStrings(e){var t=this;return(0,E.A)(function*(){const n=t.translateService,i=n.getDefaultLang(),o=n.currentLang;let a,c;i===o?c=n.translations[o]?(0,x.of)({...n.translations[o],...n.translations[o]?.diagram}):n.getTranslation(o).pipe((0,C.map)(({diagram:u})=>u)):(a=n.translations?(0,x.zip)((0,x.of)(n.translations[i]),(0,x.of)(n.translations[o])):(0,x.zip)(n.getTranslation(i),n.getTranslation(o)),c=a.pipe((0,C.map)(([u,m])=>g.merge(u?.diagram,m?.diagram))));const h=yield(0,x.lastValueFrom)(c.pipe((0,C.first)()),{defaultValue:null});return t._getLocalizationObject({...h,...e})})()}_reloadDiagram(){var e=this;return(0,E.A)(function*(){const t=yield e._getDiagramConfig();e.diagramDataService.hasDiagramData()&&e._clearDiagram(),e._destroyDiagram(),e._unsubscribeService(),e._initDiagram(t),e._subscribeLoadingData(),e._subscribeDiagramChanges(),e.diagramDataService.hasDiagramData()&&(yield e.initDiagramData(e._getCancellationToken()))})()}_clearDiagram(){this.diagramEventHandlerController.stopSync(),this.diagram.clear()}_destroyDiagram(){this.diagram&&(this.get("eventBus").fire("detach",{}),this.diagram.destroy())}_getDiagramConfig(){var e=this;return(0,E.A)(function*(){const t=yield e.service.getDiagramConfig();return{localizableStrings:yield e._getDiagramLocalizableStrings(t&&t.customLocalizableStrings),...t}})()}injectDependencies(){this.diagramDataService=this.injector.get(et),this.service=this.injector.get(Z),this.translateService=this.injector.get(z.TranslateService),this.notifyService=this.injector.get(Se),this.featureService=this.injector.get(ke),this.loggerService=this.injector.get(ce),this.features=this.injector.get(Ut)}loadDiagramData(e){var t=this;return(0,E.A)(function*(){const n=t._getCancellationToken();if(!(t.destroyed$.isStopped||t._unloaded$.isStopped))if(t.diagramDataService.data=e,t.diagramDataService.hasDiagramData()){if(yield t.initDiagramData(n),n.isStopped)return;t.caption=t.diagramDataService.getDiagramDataCaption(),t.loading=!1,t.loaded.next(e.id),t._setSelectedElement(t.elementSelect)}else{t.loading=!1;const i=`Error. Diagram with id = "${e.id}" does not exists`;t.loaded.error(i)}})()}ngOnInit(){this.translateService.onLangChange.pipe((0,C.takeUntil)(this.destroyed$)).subscribe(()=>{this.loading?this.service.endLoading$.pipe((0,C.first)()).subscribe(()=>this._reloadDiagram()):this._reloadDiagram()})}ngAfterViewInit(){var e=this;return(0,E.A)(function*(){const t=yield e._getDiagramConfig();e._initDiagram(t),e._subscribeLoadingData(),e._subscribeDiagramChanges(),e._initZoomScroll(),e.afterViewInit.emit()})()}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete(),this._unsubscribeService(),this.diagramDataService.hasDiagramData()&&this.unloadDiagramData(),this._destroyDiagram()}get(e){return this.diagram.get(e)}onHandClick(){this.get("toolManager").setActive(null),this.get("dragging").cancel()}onLassoClick(){this.get("lassoTool").toggle()}onSpaceClick(){this.get("spaceTool").toggle()}onUndoClick(){this.service.undo()}onRedoClick(){this.service.redo()}update(e){this.modeling.updateLabel(e.id,e.value)}static{this.\u0275fac=function(t){return new(t||Ae)(d.\u0275\u0275directiveInject(d.Injector))}}static{this.\u0275cmp=d.\u0275\u0275defineComponent({type:Ae,selectors:[["ts-app-diagram"]],viewQuery:function(t,n){if(t&1&&(d.\u0275\u0275viewQuery(No,7,d.ElementRef),d.\u0275\u0275viewQuery(Uo,7,d.ElementRef)),t&2){let i;d.\u0275\u0275queryRefresh(i=d.\u0275\u0275loadQuery())&&(n.diagramContainer=i.first),d.\u0275\u0275queryRefresh(i=d.\u0275\u0275loadQuery())&&(n.resetZoomButton=i.first)}},hostVars:1,hostBindings:function(t,n){t&2&&d.\u0275\u0275attribute("data-qa",n.caption)},inputs:{_isReadOnly:[d.\u0275\u0275InputFlags.None,"readonly","_isReadOnly"],_isStraightConnection:[d.\u0275\u0275InputFlags.None,"straightconnection","_isStraightConnection"],_isRtl:[d.\u0275\u0275InputFlags.None,"dir","_isRtl"],elementSelect:"elementSelect"},outputs:{elementDblClick:"elementDblClick",elementSelected:"elementSelected",diagramInitialized:"diagramInitialized",afterViewInit:"afterViewInit"},decls:2,vars:0,consts:[["diagramContainer",""],[1,"diagram-container"]],template:function(t,n){t&1&&d.\u0275\u0275element(0,"div",1,0)},styles:[`.diagram-container{position:relative;height:100%;width:100%;margin:0}.diagram-container svg{display:block}.djs-container{direction:ltr}.djs-tooltip{border-radius:4px;padding:8px;width:150px;opacity:.9;backdrop-filter:blur(5px);z-index:1010}.djs-palette{left:10px;top:10px;border-radius:4px;overflow:hidden;padding-top:6px;padding-bottom:6px}.djs-palette.open,.djs-palette.two-column.open{width:46px}.djs-palette .group{padding:0!important;width:100%}.djs-palette .entry{width:32px;height:32px;line-height:32px;margin-left:6px;cursor:pointer}.djs-palette .entry.active{border-radius:7px}.djs-palette .entry.create-menu:after{content:"";position:absolute;width:0;height:0;border-top:3px solid transparent;border-bottom:3px solid transparent;border-left:3px solid #006ce0;margin-top:13px;margin-left:-4px}.djs-context-pad.open{display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch;border-radius:4px;pointer-events:auto}.djs-context-pad.open .group{display:grid;grid-template-columns:auto auto;padding:3px}.djs-context-pad.open .group:not(:first-child){padding-left:0}.djs-context-pad.open.one-column-grid .group{grid-template-columns:auto}.djs-context-pad.open .entry{height:32px;width:32px;background:transparent;margin:0;box-shadow:none;border-radius:3px}.djs-context-pad.open .entry.entry-separator{height:0;margin-top:4px;margin-bottom:4px}.djs-context-pad.open .entry.noop-entry:hover{background:inherit!important}.djs-context-pad.open .entry img{padding:4px}.entry.entry-separator{height:0;margin-top:4px;margin-bottom:4px}@supports (backdrop-filter: none){.djs-context-pad.open{backdrop-filter:blur(5px);background:#ffffffc7}.djs-context-pad.open .entry{background:transparent}}.djs-context-pad{max-width:72px}.djs-element.djs-connection.djs-updating path,.djs-element.djs-connection.selected path,.djs-element.djs-connection.animated path{stroke:#1186d8!important}.djs-element.djs-connection.djs-updating path.connection-end-marker,.djs-element.djs-connection.selected path.connection-end-marker,.djs-element.djs-connection.animated path.connection-end-marker{fill:#1186d8!important}.djs-element.djs-connection.animated path.connection{stroke-width:3!important;stroke-dasharray:20,3;animation:dash 5s linear infinite}@keyframes dash{0%{stroke-dashoffset:115}}.djs-bendpoint .djs-visual{fill:#fff;stroke-width:1px;stroke:#1186d8}.djs-bendpoint.floating .djs-visual{display:none}.djs-bendpoints.hover .djs-visual{stroke:#8095b3}.djs-element.hover .djs-outline{stroke:#a7c6ff}.laneSet.hover .djs-visual,.lane.hover .djs-visual{opacity:initial}.djs-element.selected .djs-outline{stroke:#3168cc}.djs-segment-dragger .djs-visual{fill:transparent;stroke:transparent}.djs-snap-line{stroke-width:1px}.djs-popup{overflow-y:auto;overflow-x:hidden;max-height:calc(100% - 20px);opacity:0;transition:opacity .2s ease-out}.djs-popup .entry{display:flex;flex-direction:row-reverse;justify-content:flex-end;align-items:stretch;padding:5px 7px}.djs-popup .entry img{height:24px;width:24px}.djs-popup .djs-popup-header{display:flex;margin:0 9px}.djs-popup .djs-popup-header .entry.active{border:none}.djs-popup .djs-popup-header .entry:first-child{margin-left:0}.djs-popup .djs-popup-header .entry{height:34px;width:34px;padding:4px;margin:2px 1px 2px 4px}.djs-dragger .djs-visual rect{fill:none}.djs-direct-editing-parent:not(.djs-direct-editing-parent-no-border){display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch;pointer-events:none}.djs-direct-editing-parent:not(.djs-direct-editing-parent-no-border) .djs-direct-editing-content{margin:0 auto;pointer-events:auto;text-align:center}.djs-direct-editing-content{user-select:text!important;overflow:hidden;outline:none;resize:none}.djs-direct-editing-parent-no-border .djs-direct-editing-content{border:0}.djs-direct-editing-rotate-90{transform:rotate(-90deg);transition:transform .1s ease}.djs-direct-editing-rotate-90 .djs-direct-editing-content{border:none;transition:border .1s ease}.djs-direct-editing-rotate-0{transform:rotate(0)}.djs-text-hidden text{display:none}.djs-text-hidden foreignObject{display:none}.djs-direct-editing-resize-handle{display:none}.djs-shape.connect-ok.textAnnotation .djs-visual>:nth-child(1):not(path),.djs-shape.connect-not-ok.textAnnotation .djs-visual>:nth-child(1):not(path){fill:inherit!important}.djs-element.lane.hover:not(.selected) .djs-outline{stroke:none}.djs-element.laneSet.hover:not(.selected) .djs-outline{stroke:none}foreignObject.djs-label{overflow:visible}.foreign-text-container{display:flex;justify-content:center;height:100%}.laneSet .foreign-text-container,.lane .foreign-text-container{align-items:center}.eventSubProcessExpanded .foreign-text-container{height:initial;padding:5px}.foreign-text{text-align:center;box-sizing:border-box;outline:none;font-family:Open Sans,sans-serif;font-size:12px;font-weight:400;line-height:1.2;overflow-wrap:break-word;white-space:pre-line}.label .foreign-text{max-width:130px;user-select:text}.textAnnotation .foreign-text{padding:12px;max-width:none;text-align:left;line-height:1.41667;word-wrap:break-word}.textAnnotation foreignObject{height:100%}.eventSubProcessExpanded .foreign-text,.laneSet .foreign-text,.lane .foreign-text{white-space:nowrap;text-overflow:ellipsis;overflow:hidden}@supports (-webkit-line-clamp: 2){.eventSubProcessExpanded .foreign-text,.laneSet .foreign-text,.lane .foreign-text{vertical-align:center;overflow:hidden;text-overflow:ellipsis;white-space:initial;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}}.foreign-text-helper{max-width:128px;min-height:14.39px;width:fit-content;margin:0 auto;overflow-wrap:break-word}.diagram-create-popup-menu{border-top:none!important}.diagram-create-popup-menu .entry{cursor:move}.djs-minimap{position:absolute;right:8px;bottom:11px;width:248px;height:33px;border-radius:4px;opacity:1;overflow:hidden;box-sizing:border-box;user-select:none;transition:height .2s cubic-bezier(0,0,.2,1)}.djs-minimap .map-buttons{position:absolute;bottom:0;left:0;right:0;height:32px;display:flex;padding:0 5px;z-index:1}.djs-minimap .map-buttons .map-button{min-width:32px;height:32px;cursor:pointer;line-height:32px;font-size:16px;padding:0 8px;background-position:center;transition:background .8s}.djs-minimap .map-buttons .map-button:active{background-size:100%;transition:background 0s}.djs-minimap .map-buttons .map-button.preview-button{padding:0 12px 0 10px;margin:0 4px 0 0;min-width:40px}.djs-minimap .map-buttons .map-button.zoom-button{width:100%;height:100%;padding:0 16px 0 0;text-align:right}.djs-minimap .map-buttons .map-button.zoom-button:after{content:"";position:absolute;width:0;height:0;right:9px;top:16px}.djs-minimap .map{width:248px;height:148px;margin-bottom:32px;cursor:crosshair}.djs-minimap.open{transition:height .2s cubic-bezier(.18,.89,.32,1.28);height:180px}.djs-minimap.open .overlay{position:absolute;inset:0;pointer-events:none}.djs-minimap .viewport{fill:none;stroke:none}.djs-minimap .viewport-dom{position:absolute;border-radius:2px;box-sizing:border-box;cursor:move}.djs-minimap .cursor-crosshair{cursor:crosshair}.djs-minimap .cursor-move{cursor:move}.djs-popup.zoom{right:8px;bottom:47px;top:inherit!important;left:inherit!important}.djs-popup.zoom .entry{display:flex;flex-direction:row;justify-content:space-between;align-items:stretch}.djs-popup.zoom .entry.entry-separator{padding:0!important;margin:4px 10px!important}#canvas_svg_export{position:absolute;left:50px;top:50px;box-shadow:0 0 9px 2px #0000007a}#canvas_svg_export .close-button{position:absolute;right:8px;width:16px;height:16px;cursor:pointer}
`,`.djs-outline{fill:none;visibility:hidden}.djs-element.hover .djs-outline,.djs-element.selected .djs-outline{visibility:visible;shape-rendering:crispEdges;stroke-dasharray:3,3}.djs-element.selected .djs-outline{stroke:#88f;stroke-width:1px}.djs-element.hover .djs-outline{stroke:#f88;stroke-width:1px}svg.drop-not-ok{background:#f9dee5!important}.djs-connection.connect-ok .djs-visual>:nth-child(1),.djs-connection.drop-ok .djs-visual>:nth-child(1){stroke:#90dd5f!important}.djs-connection.connect-not-ok .djs-visual>:nth-child(1),.djs-connection.drop-not-ok .djs-visual>:nth-child(1){stroke:#e56283!important}.drop-not-ok,.connect-not-ok{cursor:not-allowed}.djs-element.attach-ok .djs-visual>:nth-child(1){stroke-width:5px!important;stroke:#ff7400b3!important}.djs-frame.connect-not-ok .djs-visual>:nth-child(1),.djs-frame.drop-not-ok .djs-visual>:nth-child(1){stroke-width:3px!important;stroke:#e56283!important;fill:none!important}.djs-lasso-overlay{fill:#ff7400;fill-opacity:.1;stroke-dasharray:5 1 3 1;stroke:#ff7400;shape-rendering:crispEdges;pointer-events:none}.djs-resize-overlay{fill:none;stroke-dasharray:5 1 3 1;stroke:#ff7400;pointer-events:none}.djs-resizer-hit{fill:none;pointer-events:all}.djs-resizer-visual{fill:#fff;stroke-width:1px;stroke:#000;shape-rendering:crispEdges;stroke-opacity:.2}.djs-cursor-resize-ns,.djs-resizer-n,.djs-resizer-s{cursor:ns-resize}.djs-cursor-resize-ew,.djs-resizer-e,.djs-resizer-w{cursor:ew-resize}.djs-cursor-resize-nwse,.djs-resizer-nw,.djs-resizer-se{cursor:nwse-resize}.djs-cursor-resize-nesw,.djs-resizer-ne,.djs-resizer-sw{cursor:nesw-resize}.djs-shape.djs-resizing>.djs-outline{visibility:hidden!important}.djs-shape.djs-resizing>.djs-resizer{visibility:hidden}.djs-dragger>.djs-resizer{visibility:hidden}marker.djs-dragger circle,marker.djs-dragger path,marker.djs-dragger polygon,marker.djs-dragger polyline,marker.djs-dragger rect{fill:#ff7400!important;stroke:none!important}marker.djs-dragger text,marker.djs-dragger tspan{fill:none!important;stroke:#ff7400!important}.djs-dragging{opacity:.3}.djs-dragging,.djs-dragging>*{pointer-events:none!important}.djs-dragging .djs-context-pad,.djs-dragging .djs-outline{display:none!important}.djs-visual,.djs-outline{pointer-events:none}.djs-element.attach-ok .djs-hit{stroke-width:60px!important}.djs-element>.djs-hit-all{pointer-events:all}.djs-element>.djs-hit-stroke,.djs-element>.djs-hit-click-stroke{pointer-events:stroke}.djs-drag-active .djs-element>.djs-hit-click-stroke{pointer-events:all}.djs-connection .djs-visual{stroke-width:2px;fill:none}.djs-cursor-grab{cursor:grab}.djs-cursor-grabbing{cursor:grabbing}.djs-cursor-crosshair{cursor:crosshair}.djs-cursor-move{cursor:move}.djs-cursor-resize-ns{cursor:ns-resize}.djs-cursor-resize-ew{cursor:ew-resize}.djs-snap-line{stroke:#ffc342;stroke:#ffc34280;stroke-linecap:round;stroke-width:2px;pointer-events:none}.djs-crosshair{stroke:#555;stroke-linecap:round;stroke-width:1px;pointer-events:none;shape-rendering:crispEdges;stroke-dasharray:5,5}.djs-palette{position:absolute;left:20px;top:20px;box-sizing:border-box;width:48px}.djs-palette .separator{margin:0 5px;padding-top:5px;border:none;border-bottom:solid 1px #DDD;clear:both}.djs-palette .entry:before{vertical-align:text-bottom}.djs-palette .djs-palette-toggle{cursor:pointer}.djs-palette .entry,.djs-palette .djs-palette-toggle{color:#333;font-size:30px;text-align:center}.djs-palette .entry{float:left}.djs-palette .entry img{max-width:100%}.djs-palette .djs-palette-entries:after{content:"";display:table;clear:both}.djs-palette .djs-palette-toggle:hover{background:#666}.djs-palette .entry:hover{color:#ff7400}.djs-palette .highlighted-entry{color:#ff7400!important}.djs-palette .entry,.djs-palette .djs-palette-toggle{width:46px;height:46px;line-height:46px;cursor:default}.djs-palette.two-column.open{width:94px}.djs-palette:not(.open) .djs-palette-entries{display:none}.djs-palette:not(.open){overflow:hidden}.djs-palette.open .djs-palette-toggle{display:none}.djs-overlay-context-pad{width:72px}.djs-context-pad{position:absolute;display:none;pointer-events:none}.djs-context-pad .entry{width:22px;height:22px;text-align:center;display:inline-block;font-size:22px;margin:0 2px 2px 0;border-radius:3px;cursor:default;background-color:#fefefe;box-shadow:0 0 2px 1px #fefefe;pointer-events:all}.djs-context-pad .entry:before{vertical-align:top}.djs-context-pad .entry:hover{background:#fffcb0}.djs-context-pad.open{display:block}.djs-popup .entry{line-height:20px;white-space:nowrap;cursor:default}.djs-popup .entry:before{vertical-align:middle;font-size:20px}.djs-popup .entry>span{vertical-align:middle;font-size:14px}.djs-popup .entry:hover,.djs-popup .entry.active:hover{background:#fffcb0}.djs-popup .entry.disabled{background:inherit}.djs-popup .djs-popup-header .entry{display:inline-block;padding:2px 3px;border:solid 1px transparent;border-radius:3px}.djs-popup .djs-popup-header .entry.active{color:#ff7400;border:solid 1px rgb(255,116,0);background-color:#f6f6f6}.djs-popup-body .entry{padding:4px 10px 4px 5px}.djs-popup-body .entry>span{margin-left:5px}.djs-popup-body{background-color:#fefefe}.djs-popup-header{border-bottom:1px solid #DDD}.djs-popup-header .entry{margin:1px 1px 1px 3px}.djs-popup-header .entry:last-child{margin-right:3px}.djs-popup,.djs-palette{background:#fafafa;border:solid 1px #CCC;border-radius:2px}.djs-shape,.djs-connection{touch-action:none}.djs-segment-dragger,.djs-bendpoint{display:none}.djs-segment-dragger .djs-visual{fill:#ffff7933;stroke-width:1px;stroke-opacity:1;stroke:#ffff794d}.djs-bendpoint .djs-visual{fill:#ffff79cc;stroke-width:1px;stroke-opacity:.5;stroke:#000}.djs-segment-dragger:hover,.djs-bendpoints.hover .djs-segment-dragger,.djs-bendpoints.selected .djs-segment-dragger,.djs-bendpoint:hover,.djs-bendpoints.hover .djs-bendpoint,.djs-bendpoints.selected .djs-bendpoint{display:block}.djs-drag-active .djs-bendpoints *{display:none}.djs-bendpoints:not(.hover) .floating{display:none}.djs-segment-dragger:hover .djs-visual,.djs-segment-dragger.djs-dragging .djs-visual,.djs-bendpoint:hover .djs-visual,.djs-bendpoint.floating .djs-visual{fill:#ff0;stroke-opacity:.5;stroke:#000}.djs-bendpoint.floating .djs-hit{pointer-events:none}.djs-segment-dragger .djs-hit,.djs-bendpoint .djs-hit{pointer-events:all;fill:none}.djs-segment-dragger.horizontal .djs-hit{cursor:ns-resize}.djs-segment-dragger.vertical .djs-hit{cursor:ew-resize}.djs-segment-dragger.djs-dragging .djs-hit{pointer-events:none}.djs-updating,.djs-updating>*{pointer-events:none!important}.djs-updating .djs-context-pad,.djs-updating .djs-outline,.djs-updating .djs-bendpoint,.connect-ok .djs-bendpoint,.connect-not-ok .djs-bendpoint,.drop-ok .djs-bendpoint,.drop-not-ok .djs-bendpoint{display:none!important}.djs-segment-dragger.djs-dragging,.djs-bendpoint.djs-dragging{display:block;opacity:1}.djs-segment-dragger.djs-dragging .djs-visual,.djs-bendpoint.djs-dragging .djs-visual{fill:#ff0;stroke-opacity:.5}.djs-tooltip-error{font-size:11px;line-height:18px;text-align:left;padding:5px;opacity:.7}.djs-tooltip-error>*{width:160px;background:#fcecf0;color:#9e4c4c;padding:3px 7px;border-radius:5px;border-left:solid 5px rgb(174,73,73)}.djs-tooltip-error:hover{opacity:1}.djs-search-container{position:absolute;top:20px;left:0;right:0;margin-left:auto;margin-right:auto;width:25%;min-width:300px;max-width:400px;z-index:10;font-size:1.05em;opacity:.9;background:#fafafa;border:solid 1px #CCC;border-radius:2px}.djs-search-container:not(.open){display:none}.djs-search-input input{font-size:1.05em;width:100%;padding:6px 10px;border:1px solid #ccc}.djs-search-input input:focus{outline:none;border-color:#52b415}.djs-search-results{position:relative;overflow-y:auto;max-height:200px}.djs-search-results:hover{cursor:pointer}.djs-search-result{width:100%;padding:6px 10px;background:#fff;border-bottom:solid 1px #AAA;border-radius:1px}.djs-search-highlight{color:#000}.djs-search-result-primary{margin:0 0 10px}.djs-search-result-secondary{font-family:monospace;margin:0}.djs-search-result:hover{background:#fdffd6}.djs-search-result-selected{background:#fffcb0}.djs-search-result-selected:hover{background:#f7f388}.djs-search-overlay{background:#ff0;opacity:.3}.djs-element-hidden,.djs-element-hidden .djs-hit,.djs-element-hidden .djs-outline,.djs-label-hidden .djs-label{display:none!important}
`],encapsulation:2})}}class me extends Ae{constructor(){super(...arguments),this.initScroll={x:61,y:0}}get modeling(){return this.get("modeling")}static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=d.\u0275\u0275getInheritedFactory(me)))(n||me)}})()}static{this.\u0275cmp=d.\u0275\u0275defineComponent({type:me,selectors:[["ts-campaign-diagram"]],features:[d.\u0275\u0275InheritDefinitionFeature],decls:2,vars:0,consts:[["diagramContainer",""],[1,"diagram-container"]],template:function(t,n){t&1&&d.\u0275\u0275element(0,"div",1,0)},styles:[`.label .foreign-text-container{height:auto}.label .foreign-text-container.campaign-label-description .foreign-text{color:#999}.info_outline{fill:transparent}
`,`.djs-outline{fill:none;visibility:hidden}.djs-element.hover .djs-outline,.djs-element.selected .djs-outline{visibility:visible;shape-rendering:crispEdges;stroke-dasharray:3,3}.djs-element.selected .djs-outline{stroke:#88f;stroke-width:1px}.djs-element.hover .djs-outline{stroke:#f88;stroke-width:1px}svg.drop-not-ok{background:#f9dee5!important}.djs-connection.connect-ok .djs-visual>:nth-child(1),.djs-connection.drop-ok .djs-visual>:nth-child(1){stroke:#90dd5f!important}.djs-connection.connect-not-ok .djs-visual>:nth-child(1),.djs-connection.drop-not-ok .djs-visual>:nth-child(1){stroke:#e56283!important}.drop-not-ok,.connect-not-ok{cursor:not-allowed}.djs-element.attach-ok .djs-visual>:nth-child(1){stroke-width:5px!important;stroke:#ff7400b3!important}.djs-frame.connect-not-ok .djs-visual>:nth-child(1),.djs-frame.drop-not-ok .djs-visual>:nth-child(1){stroke-width:3px!important;stroke:#e56283!important;fill:none!important}.djs-lasso-overlay{fill:#ff7400;fill-opacity:.1;stroke-dasharray:5 1 3 1;stroke:#ff7400;shape-rendering:crispEdges;pointer-events:none}.djs-resize-overlay{fill:none;stroke-dasharray:5 1 3 1;stroke:#ff7400;pointer-events:none}.djs-resizer-hit{fill:none;pointer-events:all}.djs-resizer-visual{fill:#fff;stroke-width:1px;stroke:#000;shape-rendering:crispEdges;stroke-opacity:.2}.djs-cursor-resize-ns,.djs-resizer-n,.djs-resizer-s{cursor:ns-resize}.djs-cursor-resize-ew,.djs-resizer-e,.djs-resizer-w{cursor:ew-resize}.djs-cursor-resize-nwse,.djs-resizer-nw,.djs-resizer-se{cursor:nwse-resize}.djs-cursor-resize-nesw,.djs-resizer-ne,.djs-resizer-sw{cursor:nesw-resize}.djs-shape.djs-resizing>.djs-outline{visibility:hidden!important}.djs-shape.djs-resizing>.djs-resizer{visibility:hidden}.djs-dragger>.djs-resizer{visibility:hidden}marker.djs-dragger circle,marker.djs-dragger path,marker.djs-dragger polygon,marker.djs-dragger polyline,marker.djs-dragger rect{fill:#ff7400!important;stroke:none!important}marker.djs-dragger text,marker.djs-dragger tspan{fill:none!important;stroke:#ff7400!important}.djs-dragging{opacity:.3}.djs-dragging,.djs-dragging>*{pointer-events:none!important}.djs-dragging .djs-context-pad,.djs-dragging .djs-outline{display:none!important}.djs-visual,.djs-outline{pointer-events:none}.djs-element.attach-ok .djs-hit{stroke-width:60px!important}.djs-element>.djs-hit-all{pointer-events:all}.djs-element>.djs-hit-stroke,.djs-element>.djs-hit-click-stroke{pointer-events:stroke}.djs-drag-active .djs-element>.djs-hit-click-stroke{pointer-events:all}.djs-connection .djs-visual{stroke-width:2px;fill:none}.djs-cursor-grab{cursor:grab}.djs-cursor-grabbing{cursor:grabbing}.djs-cursor-crosshair{cursor:crosshair}.djs-cursor-move{cursor:move}.djs-cursor-resize-ns{cursor:ns-resize}.djs-cursor-resize-ew{cursor:ew-resize}.djs-snap-line{stroke:#ffc342;stroke:#ffc34280;stroke-linecap:round;stroke-width:2px;pointer-events:none}.djs-crosshair{stroke:#555;stroke-linecap:round;stroke-width:1px;pointer-events:none;shape-rendering:crispEdges;stroke-dasharray:5,5}.djs-palette{position:absolute;left:20px;top:20px;box-sizing:border-box;width:48px}.djs-palette .separator{margin:0 5px;padding-top:5px;border:none;border-bottom:solid 1px #DDD;clear:both}.djs-palette .entry:before{vertical-align:text-bottom}.djs-palette .djs-palette-toggle{cursor:pointer}.djs-palette .entry,.djs-palette .djs-palette-toggle{color:#333;font-size:30px;text-align:center}.djs-palette .entry{float:left}.djs-palette .entry img{max-width:100%}.djs-palette .djs-palette-entries:after{content:"";display:table;clear:both}.djs-palette .djs-palette-toggle:hover{background:#666}.djs-palette .entry:hover{color:#ff7400}.djs-palette .highlighted-entry{color:#ff7400!important}.djs-palette .entry,.djs-palette .djs-palette-toggle{width:46px;height:46px;line-height:46px;cursor:default}.djs-palette.two-column.open{width:94px}.djs-palette:not(.open) .djs-palette-entries{display:none}.djs-palette:not(.open){overflow:hidden}.djs-palette.open .djs-palette-toggle{display:none}.djs-overlay-context-pad{width:72px}.djs-context-pad{position:absolute;display:none;pointer-events:none}.djs-context-pad .entry{width:22px;height:22px;text-align:center;display:inline-block;font-size:22px;margin:0 2px 2px 0;border-radius:3px;cursor:default;background-color:#fefefe;box-shadow:0 0 2px 1px #fefefe;pointer-events:all}.djs-context-pad .entry:before{vertical-align:top}.djs-context-pad .entry:hover{background:#fffcb0}.djs-context-pad.open{display:block}.djs-popup .entry{line-height:20px;white-space:nowrap;cursor:default}.djs-popup .entry:before{vertical-align:middle;font-size:20px}.djs-popup .entry>span{vertical-align:middle;font-size:14px}.djs-popup .entry:hover,.djs-popup .entry.active:hover{background:#fffcb0}.djs-popup .entry.disabled{background:inherit}.djs-popup .djs-popup-header .entry{display:inline-block;padding:2px 3px;border:solid 1px transparent;border-radius:3px}.djs-popup .djs-popup-header .entry.active{color:#ff7400;border:solid 1px rgb(255,116,0);background-color:#f6f6f6}.djs-popup-body .entry{padding:4px 10px 4px 5px}.djs-popup-body .entry>span{margin-left:5px}.djs-popup-body{background-color:#fefefe}.djs-popup-header{border-bottom:1px solid #DDD}.djs-popup-header .entry{margin:1px 1px 1px 3px}.djs-popup-header .entry:last-child{margin-right:3px}.djs-popup,.djs-palette{background:#fafafa;border:solid 1px #CCC;border-radius:2px}.djs-shape,.djs-connection{touch-action:none}.djs-segment-dragger,.djs-bendpoint{display:none}.djs-segment-dragger .djs-visual{fill:#ffff7933;stroke-width:1px;stroke-opacity:1;stroke:#ffff794d}.djs-bendpoint .djs-visual{fill:#ffff79cc;stroke-width:1px;stroke-opacity:.5;stroke:#000}.djs-segment-dragger:hover,.djs-bendpoints.hover .djs-segment-dragger,.djs-bendpoints.selected .djs-segment-dragger,.djs-bendpoint:hover,.djs-bendpoints.hover .djs-bendpoint,.djs-bendpoints.selected .djs-bendpoint{display:block}.djs-drag-active .djs-bendpoints *{display:none}.djs-bendpoints:not(.hover) .floating{display:none}.djs-segment-dragger:hover .djs-visual,.djs-segment-dragger.djs-dragging .djs-visual,.djs-bendpoint:hover .djs-visual,.djs-bendpoint.floating .djs-visual{fill:#ff0;stroke-opacity:.5;stroke:#000}.djs-bendpoint.floating .djs-hit{pointer-events:none}.djs-segment-dragger .djs-hit,.djs-bendpoint .djs-hit{pointer-events:all;fill:none}.djs-segment-dragger.horizontal .djs-hit{cursor:ns-resize}.djs-segment-dragger.vertical .djs-hit{cursor:ew-resize}.djs-segment-dragger.djs-dragging .djs-hit{pointer-events:none}.djs-updating,.djs-updating>*{pointer-events:none!important}.djs-updating .djs-context-pad,.djs-updating .djs-outline,.djs-updating .djs-bendpoint,.connect-ok .djs-bendpoint,.connect-not-ok .djs-bendpoint,.drop-ok .djs-bendpoint,.drop-not-ok .djs-bendpoint{display:none!important}.djs-segment-dragger.djs-dragging,.djs-bendpoint.djs-dragging{display:block;opacity:1}.djs-segment-dragger.djs-dragging .djs-visual,.djs-bendpoint.djs-dragging .djs-visual{fill:#ff0;stroke-opacity:.5}.djs-tooltip-error{font-size:11px;line-height:18px;text-align:left;padding:5px;opacity:.7}.djs-tooltip-error>*{width:160px;background:#fcecf0;color:#9e4c4c;padding:3px 7px;border-radius:5px;border-left:solid 5px rgb(174,73,73)}.djs-tooltip-error:hover{opacity:1}.djs-search-container{position:absolute;top:20px;left:0;right:0;margin-left:auto;margin-right:auto;width:25%;min-width:300px;max-width:400px;z-index:10;font-size:1.05em;opacity:.9;background:#fafafa;border:solid 1px #CCC;border-radius:2px}.djs-search-container:not(.open){display:none}.djs-search-input input{font-size:1.05em;width:100%;padding:6px 10px;border:1px solid #ccc}.djs-search-input input:focus{outline:none;border-color:#52b415}.djs-search-results{position:relative;overflow-y:auto;max-height:200px}.djs-search-results:hover{cursor:pointer}.djs-search-result{width:100%;padding:6px 10px;background:#fff;border-bottom:solid 1px #AAA;border-radius:1px}.djs-search-highlight{color:#000}.djs-search-result-primary{margin:0 0 10px}.djs-search-result-secondary{font-family:monospace;margin:0}.djs-search-result:hover{background:#fdffd6}.djs-search-result-selected{background:#fffcb0}.djs-search-result-selected:hover{background:#f7f388}.djs-search-overlay{background:#ff0;opacity:.3}.djs-element-hidden,.djs-element-hidden .djs-hit,.djs-element-hidden .djs-outline,.djs-label-hidden .djs-label{display:none!important}
`,`.diagram-container{position:relative;height:100%;width:100%;margin:0}.diagram-container svg{display:block}.djs-container{direction:ltr}.djs-tooltip{border-radius:4px;padding:8px;width:150px;opacity:.9;backdrop-filter:blur(5px);z-index:1010}.djs-palette{left:10px;top:10px;border-radius:4px;overflow:hidden;padding-top:6px;padding-bottom:6px}.djs-palette.open,.djs-palette.two-column.open{width:46px}.djs-palette .group{padding:0!important;width:100%}.djs-palette .entry{width:32px;height:32px;line-height:32px;margin-left:6px;cursor:pointer}.djs-palette .entry.active{border-radius:7px}.djs-palette .entry.create-menu:after{content:"";position:absolute;width:0;height:0;border-top:3px solid transparent;border-bottom:3px solid transparent;border-left:3px solid #006ce0;margin-top:13px;margin-left:-4px}.djs-context-pad.open{display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch;border-radius:4px;pointer-events:auto}.djs-context-pad.open .group{display:grid;grid-template-columns:auto auto;padding:3px}.djs-context-pad.open .group:not(:first-child){padding-left:0}.djs-context-pad.open.one-column-grid .group{grid-template-columns:auto}.djs-context-pad.open .entry{height:32px;width:32px;background:transparent;margin:0;box-shadow:none;border-radius:3px}.djs-context-pad.open .entry.entry-separator{height:0;margin-top:4px;margin-bottom:4px}.djs-context-pad.open .entry.noop-entry:hover{background:inherit!important}.djs-context-pad.open .entry img{padding:4px}.entry.entry-separator{height:0;margin-top:4px;margin-bottom:4px}@supports (backdrop-filter: none){.djs-context-pad.open{backdrop-filter:blur(5px);background:#ffffffc7}.djs-context-pad.open .entry{background:transparent}}.djs-context-pad{max-width:72px}.djs-element.djs-connection.djs-updating path,.djs-element.djs-connection.selected path,.djs-element.djs-connection.animated path{stroke:#1186d8!important}.djs-element.djs-connection.djs-updating path.connection-end-marker,.djs-element.djs-connection.selected path.connection-end-marker,.djs-element.djs-connection.animated path.connection-end-marker{fill:#1186d8!important}.djs-element.djs-connection.animated path.connection{stroke-width:3!important;stroke-dasharray:20,3;animation:dash 5s linear infinite}@keyframes dash{0%{stroke-dashoffset:115}}.djs-bendpoint .djs-visual{fill:#fff;stroke-width:1px;stroke:#1186d8}.djs-bendpoint.floating .djs-visual{display:none}.djs-bendpoints.hover .djs-visual{stroke:#8095b3}.djs-element.hover .djs-outline{stroke:#a7c6ff}.laneSet.hover .djs-visual,.lane.hover .djs-visual{opacity:initial}.djs-element.selected .djs-outline{stroke:#3168cc}.djs-segment-dragger .djs-visual{fill:transparent;stroke:transparent}.djs-snap-line{stroke-width:1px}.djs-popup{overflow-y:auto;overflow-x:hidden;max-height:calc(100% - 20px);opacity:0;transition:opacity .2s ease-out}.djs-popup .entry{display:flex;flex-direction:row-reverse;justify-content:flex-end;align-items:stretch;padding:5px 7px}.djs-popup .entry img{height:24px;width:24px}.djs-popup .djs-popup-header{display:flex;margin:0 9px}.djs-popup .djs-popup-header .entry.active{border:none}.djs-popup .djs-popup-header .entry:first-child{margin-left:0}.djs-popup .djs-popup-header .entry{height:34px;width:34px;padding:4px;margin:2px 1px 2px 4px}.djs-dragger .djs-visual rect{fill:none}.djs-direct-editing-parent:not(.djs-direct-editing-parent-no-border){display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch;pointer-events:none}.djs-direct-editing-parent:not(.djs-direct-editing-parent-no-border) .djs-direct-editing-content{margin:0 auto;pointer-events:auto;text-align:center}.djs-direct-editing-content{user-select:text!important;overflow:hidden;outline:none;resize:none}.djs-direct-editing-parent-no-border .djs-direct-editing-content{border:0}.djs-direct-editing-rotate-90{transform:rotate(-90deg);transition:transform .1s ease}.djs-direct-editing-rotate-90 .djs-direct-editing-content{border:none;transition:border .1s ease}.djs-direct-editing-rotate-0{transform:rotate(0)}.djs-text-hidden text{display:none}.djs-text-hidden foreignObject{display:none}.djs-direct-editing-resize-handle{display:none}.djs-shape.connect-ok.textAnnotation .djs-visual>:nth-child(1):not(path),.djs-shape.connect-not-ok.textAnnotation .djs-visual>:nth-child(1):not(path){fill:inherit!important}.djs-element.lane.hover:not(.selected) .djs-outline{stroke:none}.djs-element.laneSet.hover:not(.selected) .djs-outline{stroke:none}foreignObject.djs-label{overflow:visible}.foreign-text-container{display:flex;justify-content:center;height:100%}.laneSet .foreign-text-container,.lane .foreign-text-container{align-items:center}.eventSubProcessExpanded .foreign-text-container{height:initial;padding:5px}.foreign-text{text-align:center;box-sizing:border-box;outline:none;font-family:Open Sans,sans-serif;font-size:12px;font-weight:400;line-height:1.2;overflow-wrap:break-word;white-space:pre-line}.label .foreign-text{max-width:130px;user-select:text}.textAnnotation .foreign-text{padding:12px;max-width:none;text-align:left;line-height:1.41667;word-wrap:break-word}.textAnnotation foreignObject{height:100%}.eventSubProcessExpanded .foreign-text,.laneSet .foreign-text,.lane .foreign-text{white-space:nowrap;text-overflow:ellipsis;overflow:hidden}@supports (-webkit-line-clamp: 2){.eventSubProcessExpanded .foreign-text,.laneSet .foreign-text,.lane .foreign-text{vertical-align:center;overflow:hidden;text-overflow:ellipsis;white-space:initial;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}}.foreign-text-helper{max-width:128px;min-height:14.39px;width:fit-content;margin:0 auto;overflow-wrap:break-word}.diagram-create-popup-menu{border-top:none!important}.diagram-create-popup-menu .entry{cursor:move}.djs-minimap{position:absolute;right:8px;bottom:11px;width:248px;height:33px;border-radius:4px;opacity:1;overflow:hidden;box-sizing:border-box;user-select:none;transition:height .2s cubic-bezier(0,0,.2,1)}.djs-minimap .map-buttons{position:absolute;bottom:0;left:0;right:0;height:32px;display:flex;padding:0 5px;z-index:1}.djs-minimap .map-buttons .map-button{min-width:32px;height:32px;cursor:pointer;line-height:32px;font-size:16px;padding:0 8px;background-position:center;transition:background .8s}.djs-minimap .map-buttons .map-button:active{background-size:100%;transition:background 0s}.djs-minimap .map-buttons .map-button.preview-button{padding:0 12px 0 10px;margin:0 4px 0 0;min-width:40px}.djs-minimap .map-buttons .map-button.zoom-button{width:100%;height:100%;padding:0 16px 0 0;text-align:right}.djs-minimap .map-buttons .map-button.zoom-button:after{content:"";position:absolute;width:0;height:0;right:9px;top:16px}.djs-minimap .map{width:248px;height:148px;margin-bottom:32px;cursor:crosshair}.djs-minimap.open{transition:height .2s cubic-bezier(.18,.89,.32,1.28);height:180px}.djs-minimap.open .overlay{position:absolute;inset:0;pointer-events:none}.djs-minimap .viewport{fill:none;stroke:none}.djs-minimap .viewport-dom{position:absolute;border-radius:2px;box-sizing:border-box;cursor:move}.djs-minimap .cursor-crosshair{cursor:crosshair}.djs-minimap .cursor-move{cursor:move}.djs-popup.zoom{right:8px;bottom:47px;top:inherit!important;left:inherit!important}.djs-popup.zoom .entry{display:flex;flex-direction:row;justify-content:space-between;align-items:stretch}.djs-popup.zoom .entry.entry-separator{padding:0!important;margin:4px 10px!important}#canvas_svg_export{position:absolute;left:50px;top:50px;box-shadow:0 0 9px 2px #0000007a}#canvas_svg_export .close-button{position:absolute;right:8px;width:16px;height:16px;cursor:pointer}
`],encapsulation:2})}}class tt extends Z{constructor(e){super(),this.customEventClient=e,this.changeBuffer=[],this.elementNameChanged$=this.customEventClient.subscribe("updateElementName"),this.elementCaptionChanged$=this.customEventClient.subscribe("elementCaptionChanged"),this.elementRemoved$=this.customEventClient.subscribe("elementRemoved"),this.removeCancelled$=this.customEventClient.subscribe("removeCancelled"),this.elementUpdateType$=this.customEventClient.subscribe("elementUpdateType"),this.elementIsValidChanged$=this.customEventClient.subscribe("setIsElementValid"),this.elementSelected$=this.customEventClient.subscribe("elementSelected"),this.elementCenterViewBox$=this.customEventClient.subscribe("elementCenterViewBox"),this.elementMarkersChanged$=this.customEventClient.subscribe("updateElementMarkers"),this.init()}init(){super.init(),this.customEventClient.subscribe("diagramDataLoaded").subscribe(e=>this.endLoading$.next(e))}bufferiseOps(e,t,n){this.changeBuffer.push({commandType:e,path:t,newValues:n})}commit(){var e=this;return(0,E.A)(function*(){if(e.changeBuffer.length){const t=g.cloneDeep(e.changeBuffer);e.changeBuffer=[],e.customEventClient.createOutboundChannel("diagramChanged").next(t)}})()}getDiagramConfig(){var e=this;return(0,E.A)(function*(){const t=(0,x.lastValueFrom)(e.customEventClient.subscribe("setDiagramConfig").pipe((0,C.first)()),{defaultValue:null});return e.customEventClient.createOutboundChannel("getDiagramConfig").next({}),t})()}diagramInitialized(){this.customEventClient.createOutboundChannel("diagramInitialized").next({})}removing(e){return this.customEventClient.createOutboundChannel("diagramElementRemoving").next(e),!1}updatingTypeValidate({id:e,config:t}){return this.customEventClient.createOutboundChannel("diagramElementValidateUpdatingType").next({id:e,config:t}),!1}typeUpdated(e){this.customEventClient.createOutboundChannel("diagramElementTypeUpdated").next(e)}selectionChanged(e){this.customEventClient.createOutboundChannel("diagramElementClick").next(e)}elementDoubleClick(e){this.customEventClient.createOutboundChannel("diagramElementDoubleClick").next(e)}pasteElement(e){this.customEventClient.createOutboundChannel("pasteDiagramElement").next(e)}canCopy(e){var t=this;return(0,E.A)(function*(){const n=(0,x.lastValueFrom)(t.customEventClient.subscribe("setCanCopy").pipe((0,C.first)()),{defaultValue:null});return t.customEventClient.createOutboundChannel("getCanCopy").next(e),n})()}static{this.\u0275fac=function(t){return new(t||tt)(d.\u0275\u0275inject(ae))}}static{this.\u0275prov=d.\u0275\u0275defineInjectable({token:tt,factory:tt.\u0275fac})}}class nt extends tt{constructor(e){super(e),this.customEventClient=e,this.connectionHighlighted$=this.customEventClient.subscribe("highlightConnection"),this.elementDescriptionChanged$=this.customEventClient.subscribe("elementDescriptionChange")}static{this.\u0275fac=function(t){return new(t||nt)(d.\u0275\u0275inject(ae))}}static{this.\u0275prov=d.\u0275\u0275defineInjectable({token:nt,factory:nt.\u0275fac})}}(0,Ne.marker)("diagram.connections.connection"),(0,Ne.marker)("diagram.connections.defaultConnection");const Ho={connection:{caption:"connections.connection",order:{containers:["laneSet","lane","subProcessExpanded","eventSubProcessExpanded"],level:3},propertiesImage:"assets/images/SequenceFlowProperties.svg",type:L.connection}},U={label:{height:20,minHeight:20,type:L.label,width:130,editStyle:{fontFamily:'"Open Sans", sans-serif',fontSize:12,fontWeight:"normal",lineHeight:1.2},padding:{paddingTop:1,paddingBottom:2,paddingLeft:2,paddingRight:2},minWidth:65,order:{level:10}}};let H=class{constructor(e={}){this.config=e,this.items=this.getItems()}getItems(){const e=this.config.customDiagramElements||{};return{...U,...Ho,...Oe,...e}}getConfig(e){return this.items[e.userTaskType||e.type]}};H=(0,r.__decorate)([(0,r.__param)(0,M("config")),(0,r.__metadata)("design:paramtypes",[Object])],H);let Ie=class{constructor(e){this.config=e}getElements(){return{}}};Ie=(0,r.__decorate)([(0,r.__param)(0,M("config")),(0,r.__metadata)("design:paramtypes",[Object])],Ie);var Ht=p(10018),se;(function(s){s.connection="connection",s.root="root",s.shape="shape",s.label="label"})(se||(se={}));class _{static centerViewboxOnElement(e,t){const n=t.viewbox(),i=(0,Ht.U7)(e),o={x:Math.round(i.x+i.width/2-n.outer.width/2),y:Math.round(i.y+i.height/2-n.outer.height/2),width:n.outer.width,height:n.outer.height};t.viewbox(o),t.zoom(n.scale)}static isLabel(e){return e.type===se.label}static isRoot(e){return e.type===se.root}static getCorrectSpaceToolDelta(e,t){const n=t.context,i=n.axis,o=n.minAllowedDelta;return o!==null&&(i==="x"&&e.x<o&&(e.x=o),i==="y"&&e.y<o&&(e.y=o)),e}static getOriginalWaypoint(e,t){return[t.y,t.y+t.height].includes(e.y)?{x:e.x,y:t.y+Math.round(t.height/2)}:{x:t.x+Math.round(t.width/2),y:e.y}}getContainersType(){return[]}setProcessRelativePosition(e,t){const n=(i,o)=>{o.id===Oe.root.id?(!g.isNumber(i.rx)&&i.x&&(i.rx=i.x),!g.isNumber(i.ry)&&i.y&&(i.ry=i.y)):(!g.isNumber(i.rx)&&i.x&&o.x&&(i.rx=i.x-o.x),!g.isNumber(i.ry)&&i.y&&o.y&&(i.ry=i.y-o.y))};Object.keys(Ai(e.elements)).forEach(i=>{const o=e.elements[i],a=e.elements[o.parent];n(o,a||{id:"root1"})}),Object.keys(Ai(e.labels)).forEach(i=>{const o=e.labels[i],a=e.connections[o.parent]||e.elements[o.parent];let c=a;if(a)this.isConnection(a)&&(c=e.elements[a.source]);else{const h=`Element with id "${a}" - not found in process "${e.id}"`;t.error(h,{loggerName:"setProcessRelativePosition"}),console.error(h)}n(o,c||{id:"root1"})})}isConnection(e){return se.connection===e.type}isFlow(e){return se.connection===e.type}findRealElementParent(e,t,n){for(const i of t)if(e.x>i.x&&e.x<i.x+i.width&&e.y>i.y&&e.y<i.y+i.height)return i;return n}getAllContainers(e){const t=this.getContainersType(),n=[];return e.forEach(i=>{if(t.includes(i.type)){const o=i.children?i.children.filter(a=>t.includes(a.type)):[];n.push({container:i,count:o.length})}},this),n.sort((i,o)=>i.count-o.count).map(i=>i.container)}}var Ko=p(41666),$o=p(20418),Wo=p(39255),Vo=p(54100),Go=p(95576),Jo=p(85284),Zo=p(26316),Yo=p(78768),Xo=p(54559),Zi=p(46902),Qo=p(50317),qo=p(50101),er=p(77648),tr=p(79691),nr=p(85868),ir=p(76357),sr=p(25342),or=p(88729),rr=p(41458),ar=p(28400),cr=p(23550),lr=p(64916),dr=p(32959),hr=p(81284),pr=p(43537);function O(){return function(s,e,t){const n=t.value;t.value=function(){return this.isReadOnly?!1:n.apply(this,arguments)}}}let k=class extends pr.A{constructor(e,t){super(e),this.isReadOnly=!1,this.isReadOnly=t.isReadOnly}canConnect(e,t){return e.type!==L.root&&e.type!==L.connection&&t.type!==L.root&&t.type!==L.connection}addRule(e,t){super.addRule(e,t)}init(){super.addRule("connection.create",this.canConnectionCreate.bind(this)),super.addRule("connection.reconnect",this.canReconnect.bind(this)),super.addRule("elements.move",this.canElementMove.bind(this)),super.addRule("shape.create",this.canElementMove.bind(this)),super.addRule("elements.create",this.canElementMove.bind(this)),super.addRule("shape.resize",this.canElementResize.bind(this)),super.addRule("element.copy",this.canElementCopy.bind(this)),super.addRule("element.paste",this.canElementPaste.bind(this)),super.addRule("elements.delete",this.canElementsDelete.bind(this)),super.addRule("canOpenContextPad",this.canOpenContextPad.bind(this)),super.addRule("canShowConnectionOutline",this.canShowConnectionOutline.bind(this)),super.addRule("canConnectionSegmentMove",this.canConnectionSegmentMove.bind(this)),super.addRule("canLabelEdit",this.canLabelEdit.bind(this)),super.addRule("canShowPalette",this.canShowPalette.bind(this)),super.addRule("canShowLabelOutline",this.canShowLabelOutline.bind(this)),super.addRule("canElementMarkerUpdate",this.canElementMarkerUpdate.bind(this)),super.addRule("element.canUpdateType",this.canElementUpdateType.bind(this)),super.addRule("connection.updateWaypoints",this.canConnectionUpdateWaypoints.bind(this))}canElementMarkerUpdate(){return!0}canShowLabelOutline(){return!0}canConnectionSegmentMove(){return!0}canShowPalette(){return!0}canLabelEdit(){return!0}canShowConnectionOutline(){return!0}canOpenContextPad(){return!0}canConnectionCreate(e){return this.canConnect(e.target,e.source)}canReconnect(e){if(_.isRoot(e.target)||_.isRoot(e.source))return!1;switch(e.type){case"reconnectEnd":return this.canReconnectEnd(e);case"reconnectStart":return this.canReconnectStart(e);default:return this.canReconnectEnd(e)||this.canReconnectStart(e)}}canReconnectStart(e){return this.canConnect(e.target,e.source)}canReconnectEnd(e){return this.canConnect(e.target,e.source)}canElementMove(e){return!0}canElementResize(e){return!1}canElementCopy(e){return!0}canElementPaste(e){return!0}canElementsDelete(e){return!0}canElementUpdateType(e){return!0}canConnectionUpdateWaypoints(){return!1}};(0,r.__decorate)([O(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",void 0)],k.prototype,"canElementMarkerUpdate",null),(0,r.__decorate)([O(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",void 0)],k.prototype,"canConnectionSegmentMove",null),(0,r.__decorate)([O(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",void 0)],k.prototype,"canShowPalette",null),(0,r.__decorate)([O(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",void 0)],k.prototype,"canLabelEdit",null),(0,r.__decorate)([O(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",void 0)],k.prototype,"canShowConnectionOutline",null),(0,r.__decorate)([O(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",void 0)],k.prototype,"canOpenContextPad",null),(0,r.__decorate)([O(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",void 0)],k.prototype,"canConnectionCreate",null),(0,r.__decorate)([O(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Boolean)],k.prototype,"canReconnect",null),(0,r.__decorate)([O(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",void 0)],k.prototype,"canElementMove",null),(0,r.__decorate)([O(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",void 0)],k.prototype,"canElementResize",null),(0,r.__decorate)([O(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",void 0)],k.prototype,"canElementCopy",null),(0,r.__decorate)([O(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",void 0)],k.prototype,"canElementPaste",null),(0,r.__decorate)([O(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",void 0)],k.prototype,"canElementsDelete",null),(0,r.__decorate)([O(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",void 0)],k.prototype,"canElementUpdateType",null),k=(0,r.__decorate)([(0,r.__param)(0,M("eventBus")),(0,r.__param)(1,M("config")),(0,r.__metadata)("design:paramtypes",[Object,Object])],k);var ur=p(6513);const A={MIN:100,LOW:500,MEDIUM:1e3,HIGH:1500,MAX:5e3};let Kt=class extends ur.A{constructor(e,t,n,i,o,a){super(e,t,n,i,o),this.eventBus=e,this.canvas=t,this.interactionEvents=n,this.bendpointMove=i,this.connectionSegmentMove=o,this.rules=a,e.on("element.marker.update",A.HIGH,this.onElementMarkerUpdate.bind(this))}onElementMarkerUpdate(e){this.rules.allowed("canElementMarkerUpdate")||(e.element={})}getConnectionBendpointsFilter(e,t,n){return t===0||t===n.length-1}};Kt=(0,r.__decorate)([(0,r.__param)(0,M("eventBus")),(0,r.__param)(1,M("canvas")),(0,r.__param)(2,M("interactionEvents")),(0,r.__param)(3,M("bendpointMove")),(0,r.__param)(4,M("connectionSegmentMove")),(0,r.__param)(5,M("rules")),(0,r.__metadata)("design:paramtypes",[Object,Object,Object,Object,Object,Object])],Kt);const l=M;var Pn=p(69034),y=p(87004);let Mn=class extends Pn.A{constructor(e,t,n,i){super(e,t,n,i),this._canvas=e,this._eventBus=t,this._graphicsFactory=n,this._elementRegistry=i,t.on(["canvas.init"],o=>this.onInit(o))}onInit(e){const t=(0,y.vt)("defs");(0,y.BC)(e.svg,t)}zoom(e,t){const n=super.zoom(e,t);return this._eventBus.fire("zoom.changed",n),n}bringToFrontElement(e){const n=this._elementRegistry.getGraphics(e).parentNode,i=n.parentNode;i.removeChild(n),i.appendChild(n)}};Mn=(0,r.__decorate)([(0,r.__param)(0,l("config.canvas")),(0,r.__param)(1,l("eventBus")),(0,r.__param)(2,l("graphicsFactory")),(0,r.__param)(3,l("elementRegistry")),(0,r.__metadata)("design:paramtypes",[Object,Object,Object,Object])],Mn);var gr=p(17389);let Rn=class extends gr.A{constructor(e,t){super(e,t),this.eventBus=e}undo(){this.eventBus.fire("undo")}redo(){this.eventBus.fire("redo")}};Rn=(0,r.__decorate)([(0,r.__param)(0,l("eventBus")),(0,r.__param)(1,l("injector")),(0,r.__metadata)("design:paramtypes",[Object,Object])],Rn);let $t=class{constructor(e,t,n,i,o){this.eventBus=e,this.canvas=t,this.elementRegistry=n,this.config=i,this.diagramUtils=o,this.highlightClassName="animated",this.subscribeEvents()}get supportHighlight(){return this.config.isReadOnly}onSelectionChanged(e){const{newSelection:t,oldSelection:n}=e;n.forEach(i=>this.changeConnectionSelection(i,!1)),t.forEach(i=>this.changeConnectionSelection(i,!0))}changeConnectionSelection(e,t){const n=this.elementRegistry.filter(i=>i.source===e||i.target===e);n.forEach(i=>{t?this.canvas.addMarker(i,this.highlightClassName):this.canvas.removeMarker(i,this.highlightClassName)}),this.bringToFront(n,e)}bringToFrontElement(e){this.canvas.bringToFrontElement(e)}subscribeEvents(){this.supportHighlight&&this.eventBus.on(["selection.changed"],A.LOW,e=>this.onSelectionChanged(e))}bringToFront(e,t){e.forEach(i=>this.bringToFrontElement(i)),this.elementRegistry.filter(i=>!this.diagramUtils.isConnection(i)).forEach(i=>this.bringToFrontElement(i)),this.bringToFrontElement(t)}};$t=(0,r.__decorate)([(0,r.__param)(0,l("eventBus")),(0,r.__param)(1,l("canvas")),(0,r.__param)(2,l("elementRegistry")),(0,r.__param)(3,l("config")),(0,r.__param)(4,l("diagramUtils")),(0,r.__metadata)("design:paramtypes",[Object,Object,Object,Object,_])],$t);var mr=p(28012);let Ln=class extends mr.A{constructor(e,t,n,i){super(e,t,n,i),this._injector=e,this._canvas=t,this._graphicsFactory=n,this._elementFactory=i}createNoopConnection(e,t){const n=(0,y.vt)("polyline");return(0,y.CF)(n,{stroke:"#8095b3",strokeWidth:2}),(0,y.CF)(n,{points:[e.x,e.y,t.x,t.y]}),n}};Ln=(0,r.__decorate)([(0,r.__param)(0,l("injector")),(0,r.__param)(1,l("canvas")),(0,r.__param)(2,l("graphicsFactory")),(0,r.__param)(3,l("elementFactory")),(0,r.__metadata)("design:paramtypes",[Object,Object,Object,Object])],Ln);var fr=p(45041),yr=p(76584),Yi=p(52874),j=p(98218),f=p(52687),br=p(44156);let fe=class extends br.A{constructor(e,t,n){super({style:g.cloneDeep(U.label.editStyle)}),this.config=e,this.elements=t,this.diagramUtils=n,this.style=g.cloneDeep(U.label.editStyle)}getElementLabelPosition(e,t){return t.delta?{x:Math.round(e.x+t.delta.x+t.width/2),y:Math.round(e.y+t.delta.y+t.height/2)}:{x:Math.round(e.x+e.width/2),y:Math.round(e.y+e.height+U.label.height/2)}}layoutToFirstLine(e,t){const i=e[0].textContent,o=super.layoutText(i,t);return o.element.children[0].textContent=i.substring(0,i.length-3)+"...",o}layoutRtlText(e,t){const n=e.element.children||[];n.length>1&&(e=this.layoutToFirstLine(n,t)),e.element.style.direction="rtl";const i=e.element.children||[];for(const o of i)o.style.direction="ltr";return e}getLabelPaddingTop(e,t){return 7}isIEOrEdge(){return/msie\s|trident\/|edge\//i.test(window.navigator.userAgent)}applySvgHelperContent(e,t){const n=this.isEmptyText(t)?"dummy":t;e.textContent=n}createForeignText(e,t,n){const i=document.createElement("div"),o=`color: ${g.get(n,"style.fill","initial")}`;return i.setAttribute("class","foreign-text"),i.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),i.setAttribute("style",`width: ${t}px; ${o}`),i.textContent=e,i}createForeignTextContainer(e,t,n){const i=document.createElement("div");i.setAttribute("class","foreign-text-container"),i.setAttribute("xmlns","http://www.w3.org/1999/xhtml");const o=this.createForeignText(e,t,n);return i.append(o),i}createForeignObject(e,t){const n=document.createElementNS("http://www.w3.org/2000/svg","foreignObject"),i=e.height,o=e.width;n.setAttribute("height",i.toString()),n.setAttribute("width",o.toString());const a=this.createForeignTextContainer(e.text,e.width,t);return n.append(a),n}getTextLayout(e,t){const n=(0,j.assign)({},{},t.box);let i={height:n.height,width:n.width,text:e};if(t.needRecalcDimensions){const o=i.height===void 0?i.width:null,a=this.getHelperSvg(o);i={...this.getTextBBox(e,a),text:e},(0,f.remove)(a)}return i}getLabelOptions(e){return{box:{x:Math.round(e.width/2+e.x),y:Math.round(e.height/2+e.y),width:e.width||U.label.width,height:e.height},style:{direction:"ltr",...this.style}}}getHelperSvg(e){let t=document.getElementById("helper-svg");return t||(t=document.createElement("div"),t.setAttribute("id","helper-svg"),t.setAttribute("class","foreign-text foreign-text-helper"),e&&t.setAttribute("style",`max-width: ${e}px`),document.body.appendChild(t)),t}getTextBBox(e,t){this.applySvgHelperContent(t,e);const n=t.getBoundingClientRect();return{width:this.isEmptyText(e)?0:n.width,height:n.height}}getDimensions(e,t){return t.needRecalcDimensions=!0,this.layoutText(e,t).dimensions}createText(e,t){return super.createText(e,t)}layoutText(e,t){if(this.isIEOrEdge()){const o=super.layoutText(e,t);return this.config.isRtl?this.layoutRtlText(o,t):o}const n=this.getTextLayout(e,t),i=this.createForeignObject(n,t);return{dimensions:{width:n.width,height:n.height},element:i}}getConnectionLabelPosition(e,t){const n=Math.floor(e.length/2-1),i=e[n],o=e[n+1],a={x:Math.round((o.x-i.x)/2),y:Math.round((o.y-i.y)/2)},c=i.x+a.x;let h=i.y+a.y;return i.y===o.y&&(h+=Math.round(t.height/2)+5),{x:c,y:h}}getLabelBounds(e,t){const n=this.getLabelOptions(e),i=this.getDimensions(t,n);return{height:i.height,width:i.width,x:Math.round(e.x+e.width/2-i.width/2),y:Math.round(e.y)}}isEmptyText(e){return!e||!e.trim()}resetLabelPosition(e){const{width:i,height:o}=this.getLabelBounds(e,e.labelTarget.caption);e.width=i,e.height=o;const a=e.parent;e.x=Math.round(a.x+a.width/2-e.width/2),e.y=Math.round(a.y+a.height+U.label.height/2)-1*2-1}addLabel(e,t,n,i=t.caption){if(!this.isEmptyText(i)){const o=this.getLabelPosition(t,n);o.y+=this.getLabelPaddingTop(t,n.delta);const a={id:Yi.Guid.create().toString(),getDimensions:!0,...g.pick(n,["type","width","height"])};e.createLabel(t,o,a)}}getLabelPosition(e,t=U.label){return this.diagramUtils.isConnection(e)?this.getConnectionLabelPosition(e.waypoints,t):this.getElementLabelPosition(e,t)}};fe=(0,r.__decorate)([(0,r.__param)(0,l("config")),(0,r.__param)(1,l("elements")),(0,r.__param)(2,l("diagramUtils")),(0,r.__metadata)("design:paramtypes",[Object,H,_])],fe);let Wt=class{constructor(e,t){this.modeling=e,this.diagramText=t}setText(e,t){const n=e.label||e,i=e.labelTarget||e;return i.caption=t,[n,i]}preExecute(e){const t=e.element;t&&!t.label&&!_.isLabel(t)&&this.diagramText.addLabel(this.modeling,t,U.label,e.text)}execute(e){e.oldText=e.element.caption||"";const t=(e.text||"").trim();return this.setText(e.element,t)}revert(e){return this.setText(e.element,e.oldText)}resizeShape(e,t){this.modeling.resizeShape(e,t,{height:0,width:0})}postExecute(e){const t=e.element.label;if(!t)return;const n=this.diagramText;if(n.isEmptyText(e.text))this.modeling.removeShape(t,{unsetLabel:!1});else{const i=t.labelTarget.caption;if(i){const o=e.newBounds||n.getLabelBounds(t,i);this.resizeShape(t,o)}}}};Wt=(0,r.__decorate)([(0,r.__param)(0,l("modeling")),(0,r.__param)(1,l("diagramText")),(0,r.__metadata)("design:paramtypes",[Object,fe])],Wt);var _r=p(2050);class Bn{constructor(e){this.utils=e}_setAbsolutePosition(e,t,n){if(n.includes(e.id)||g.isUndefined(e.rx)||g.isUndefined(e.ry))return;const i=e.parent;let o=t.elements[i]||t.connections[i];o?(this.utils.isConnection(o)&&(o=t.elements[o.source]),this._setAbsolutePosition(o,t,n),e.x=o.x+e.rx,e.y=o.y+e.ry):(e.x=e.rx,e.y=e.ry),n.push(e.id)}setRelativePosition(e,t=null){let n=t||e.labelTarget||e.parent;n.id===Oe.root.id?(e.rx=e.x,e.ry=e.y):(this.utils.isConnection(n)&&(n=n.source),e.rx=e.x-n.x,e.ry=e.y-n.y)}setShapeAbsolutePosition(e,t=null){let n=t||e.labelTarget||e.parent;n.id===Oe.root.id?(g.isUndefined(e.rx)||(e.x=e.rx),g.isUndefined(e.ry)||(e.y=e.ry)):(this.utils.isConnection(n)&&(n=n.source),g.isUndefined(e.rx)||(e.x=n.x+e.rx),g.isUndefined(e.ry)||(e.y=n.y+e.ry))}setAbsolutePosition(e){if(!e)return;const t=[];g.forEach(e.elements,n=>{this._setAbsolutePosition(n,e,t)}),g.forEach(e.labels,n=>{this._setAbsolutePosition(n,e,t)})}}let Fn=class extends _r.A{constructor(e,t){super(e),this.canvas=e,this.diagramUtils=t,this.convertUtils=new Bn(t)}execute(e){const t=super.execute(e);return this.convertUtils.setRelativePosition(t),t}};Fn=(0,r.__decorate)([(0,r.__param)(0,l("canvas")),(0,r.__param)(1,l("diagramUtils")),(0,r.__metadata)("design:paramtypes",[Object,Object])],Fn);var xr=p(34635);let zn=class extends xr.A{constructor(e,t){super(e),this.canvas=e,this.diagramUtils=t,this.convertUtils=new Bn(t)}execute(e){const t=super.execute(e);return this.convertUtils.setRelativePosition(t,e.labelTarget),t}};zn=(0,r.__decorate)([(0,r.__param)(0,l("canvas")),(0,r.__param)(1,l("diagramUtils")),(0,r.__metadata)("design:paramtypes",[Object,Object])],zn);var vr=p(97970),ye=p(65911);let it=class extends vr.A{constructor(e){super(e)}execute(e){super.execute(e)}postExecute(e){const{connection:t,hints:n}=e;n&&n.docking&&(e.dockingOrPoints=n.docking==="source"?(0,ye.pp)(t.source):(0,ye.pp)(t.target)),super.postExecute(e)}};it=(0,r.__decorate)([(0,r.__param)(0,l("modeling")),(0,r.__metadata)("design:paramtypes",[Object])],it);var Cr=p(90006);let Vt=class extends Cr.A{constructor(e,t){super(e),this.modeling=e,this.canvas=t}getParent(e,t){const n=this.canvas.getRootElement();let i=super.getParent(e,t);return _.isLabel(i)&&(i=n),i}preExecute(e){super.preExecute(e)}};Vt=(0,r.__decorate)([(0,r.__param)(0,l("modeling")),(0,r.__param)(1,l("canvas")),(0,r.__metadata)("design:paramtypes",[Object,Object])],Vt);var wr=p(12301);let Gt=class extends wr.A{constructor(e,t,n,i){super(e),this.modeling=e,this.elementRegistry=t,this.canvas=n,this.diagramUtils=i}setParent(e){const t=e.newParent;t&&(this.diagramUtils.isFlow(t)&&(e.targetConnection=t,e.newParent=this.getRealParent(e)),_.isLabel(t)&&(e.newParent=this.getRealParent(e)))}getRealParent(e){const t=this.diagramUtils.getAllContainers(this.elementRegistry.getAllElements()),n=this.canvas.getRootElement(),i=e.shapes[0];return this.diagramUtils.findRealElementParent({x:i.x,y:i.y},t,n)}postExecute(e){this.setParent(e),super.postExecute(e)}};Gt=(0,r.__decorate)([(0,r.__param)(0,l("modeling")),(0,r.__param)(1,l("elementRegistry")),(0,r.__param)(2,l("canvas")),(0,r.__param)(3,l("diagramUtils")),(0,r.__metadata)("design:paramtypes",[Object,Object,Object,_])],Gt);var jr=p(57261),Er=p(45240);let Nn=class extends jr.A{constructor(e){super(e),this.modeling=e,this.postExecute=function(t){const n=t.movingShapes,i=t.delta;this.modeling.moveElements(n,i,void 0,{autoResize:!1,attach:!1})},this.preExecute=function(t){const n=t.resizingShapes,i=t.delta,o=t.direction;n.forEach(a=>{const c=(0,Er.Ih)(a,o,i);this.modeling.resizeShape(a,c)})}}};Nn=(0,r.__decorate)([(0,r.__param)(0,l("modeling")),(0,r.__metadata)("design:paramtypes",[Object])],Nn);const Sr={CENTER:"center",RIGHT:"right",LEFT:"left"},Or={TOP:"top",CENTER:"center",BOTTOM:"bottom"};let Y=class extends yr.A{constructor(e,t,n,i,o,a,c,h,u){super(e,t,n,i),this.eventBus=e,this.elementFactory=t,this.commandStack=n,this.canvas=i,this.registry=o,this.diagramText=a,this.elements=c,this.rules=h,this.diagramUtils=u,this.convertUtils=new Bn(u)}addShapeHandlers(e){e[b.shape.shapeCreate]=Fn}addLabelHandlers(e){e[b.label.create]=zn}getLabelPositionByX(e,t){return e.horizontalAlignment===Sr.CENTER?e.x:e.x+t.width/2}getLabelPositionByY(e,t){return e.verticalAlignment===Or.CENTER?e.y:e.y+t.height/2}getLabelPosition(e,t,n){let i,o;if(this.needResetLabelPosition(e,t)){const a=this.diagramText.getLabelPosition(t,n),c=this.getFixedLabelPosition(a,n,t);i=!g.isUndefined(e.x)&&g.isUndefined(e.y)?this.getLabelPositionByX(e,n):c.x,o=!g.isUndefined(e.y)&&g.isUndefined(e.x)?this.getLabelPositionByY(e,n):c.y}else i=this.getLabelPositionByX(e,n),o=this.getLabelPositionByY(e,n);return{x:Math.round(i),y:Math.round(o)}}getLabelSize(e,t){let n;if(e.width&&e.height)n={width:e.width,height:e.height};else{const i=e.caption||t.caption,o=this.diagramText.getLabelBounds(e,i);n={width:o.width,height:o.height}}return n}addElementHandlers(e){e[b.element.updateLabel]=Wt}addConnectionHandlers(e){e[b.connection.update]=it,e[b.connection.reconnect]=it}getFixedLabelPosition(e,t,n){const a=e.x,c=this.diagramUtils.isConnection(n)?e.y:e.y+t.height/2-1*2-1;return{x:Math.round(a),y:Math.round(c)}}needResetLabelPosition(e,t){return g.isUndefined(e.x)||g.isUndefined(e.y)}getElement(e){return typeof e=="string"?this.registry.get(e):e}addElementsHandlers(e){e[b.elements.create]=Vt,e[b.elements.move]=Gt}getLabelAttributes(e,t,n,i){return{id:t.id,type:e.type,width:n.width,height:n.height,caption:e.caption,backgroundStyle:e.backgroundStyle,style:e.style,hidden:i?.hidden,tooltip:e.tooltip,tooltipConfig:e.tooltipConfig}}getElementAttributes(e,t,n){const{caption:i,type:o}=t,a=t.width||n.width,c=t.height||n.height,h=t.largeImage||n.largeImage,u=t.name;return{id:e,type:o,width:a,height:c,largeImage:h,name:u,caption:i&&i.toString(),tooltip:t.tooltip,tooltipConfig:t.tooltipConfig}}centerViewbox(e){_.centerViewboxOnElement(e,this.canvas)}getElementPosition(e,t){const{x:n=0,y:i=0}=e,o=e.width||t.width,a=e.height||t.height;return{x:Math.round(n+o/2),y:Math.round(i+a/2)}}createDiagramLabel(e){const t=g.cloneDeep(e.value),n=this.registry.get(t.parent);if(n){this.convertUtils.setShapeAbsolutePosition(t,n);const i=this.getLabelSize(t,n);t.height=t.height||i.height;const o=this.getLabelPosition(t,n,i),a=this.getLabelAttributes(t,e,i,n);return this.createLabel(n,o,a,n)}}createDiagramElement(e,t){if(this.registry.get(e))return;const n=this.elements.items.root.id,i=g.cloneDeep(t[e]),o=i.parent||n;let a=this.registry.get(o);a||(this.createDiagramElement(o,t),a=this.registry.get(o)),this.convertUtils.setShapeAbsolutePosition(i,a);const c=this.elements.getConfig(i),h=this.getElementAttributes(e,i,c),u=this.getElementPosition(i,c);this.createShape(h,u,a,0,{generateUniqueCaption:!1})}getHandlers(){const e=super.getHandlers(this);return e.spaceTool=Nn,this.addLabelHandlers(e),this.addShapeHandlers(e),this.addElementHandlers(e),this.addElementsHandlers(e),this.addConnectionHandlers(e),e}moveConnection(e,t,n,i){super.moveConnection(e,t,e.parent,n,i)}createShape(e,t,n,i,o){return super.createShape(e,t,n,i,o)}pasteElements(e,t,n){super.pasteElements(e,t,n)}moveShape(e,t,n=null,i=null,o=null){super.moveShape(e,t,n,i,o)}updateWaypoints(e,t,n={}){const i=this.getElement(e);i&&(g.defaults(n,{doUpdateLabelPosition:!0}),super.updateWaypoints(i,t,n))}reconnect(e,t,n,i,o){o&&o.docking==="target"&&g.defaults(o,{isUpdateConnectionType:!0});const a=this.getElement(e),c=this.getElement(t),h=this.getElement(n);a&&(c||h)&&super.reconnect(a,c,h,i,o)}reconnectStart(e,t,n,i={}){if(!n){const o=this.getElement(e),a=o.waypoints[0];n=a.original||_.getOriginalWaypoint(a,o.source)}super.reconnectStart(e,t,n,i)}reconnectEnd(e,t,n,i={}){if(!n){const o=this.getElement(e),a=o.waypoints,c=a[a.length-1];n=c.original||_.getOriginalWaypoint(c,o.target)}super.reconnectEnd(e,t,n,i)}createLabel(e,t,n,i){if(this.registry.get(n.id))return;const o=super.createLabel(e,t,n,i);return o.parent=e,o}removeConnection(e){const t=this.getElement(e);t&&super.removeConnection(t)}connect(e,t,n,i){const o=this.canvas.getRootElement();return n=n||{},this.createConnection(e,t,n,o,i)}createConnection(e,t,n,i,o,a){if(typeof n=="object"&&(a=o,o=i,i=n,n=void 0),!this.registry.get(i.id))return o=o||this.canvas.getRootElement(),super.createConnection(e,t,n,i,o,a)}updateLabel(e,t,n=null){const i=this.getElement(e);i&&this.commandStack.execute(b.element.updateLabel,{element:i,text:t,newBounds:n})}moveConnectionLabel(e,t){const n={connection:e,hints:t};this.eventBus.fire(b.connection.moveConnectionLabel,{context:n})}removeElementChildren(e){const t=e.children;for(t.length&&this.eventBus.fire(b.elements.removing,{elements:t});t.length>0;){const n=t[0];this.removeShape(n,{force:!0})}}resizeShape(e,t,n,i){super.resizeShape(e,t,n,i)}removeShape(e,t){super.removeShape(e,t)}removeElements(e,t=!1){(t||this.rules.allowed(b.elements.delete,{elements:e}))&&super.removeElements(e)}clearDiagram(){const e=this.registry.getAllElements();super.removeElements(e)}layoutConnection(e,t){super.layoutConnection(e,t)}};Y=(0,r.__decorate)([(0,r.__param)(0,l("eventBus")),(0,r.__param)(1,l("elementFactory")),(0,r.__param)(2,l("commandStack")),(0,r.__param)(3,l("canvas")),(0,r.__param)(4,l("elementRegistry")),(0,r.__param)(5,l("diagramText")),(0,r.__param)(6,l("elements")),(0,r.__param)(7,l("rules")),(0,r.__param)(8,l("diagramUtils")),(0,r.__metadata)("design:paramtypes",[Object,Object,Object,Object,Object,Object,H,Object,_])],Y);let Jt=class extends fr.A{constructor(e,t,n,i,o,a,c){super(e,t,n,i,c,a),this.rules=o;const h=this.start;this.start=(u,m,w)=>{this.rules.allowed("canConnectionSegmentMove")&&h.call(this,u,m,w)}}};Jt=(0,r.__decorate)([(0,r.__param)(0,l("injector")),(0,r.__param)(1,l("eventBus")),(0,r.__param)(2,l("canvas")),(0,r.__param)(3,l("dragging")),(0,r.__param)(4,l("rules")),(0,r.__param)(5,l("modeling")),(0,r.__param)(6,l("graphicsFactory")),(0,r.__metadata)("design:paramtypes",[Object,Object,Object,Object,Object,Y,Object])],Jt);const Xi=".entry";let Un=class{constructor(e,t,n,i){this.eventBus=e,this.overlays=t,this.rules=n,this.canvas=i,this._providers=[],this.current=null,this.init()}init(){this.eventBus.on("selection.changed",e=>{const t=e.newSelection;t.length===1?this.open(t[0]):this.close()}),this.eventBus.on("elements.delete",e=>{const t=e.elements;(0,j.forEach)(t,n=>{this.isOpen(n)&&this.close()})}),this.eventBus.on("element.changed",e=>{const t=e.element,n=this.current;n&&n.element===t&&this.open(t,!0)}),this.eventBus.on("canvas.viewbox.changing",()=>{this.isOpen()&&(0,j.assign)(this.current.pad.html.style,{visibility:"hidden"})}),this.eventBus.on("canvas.viewbox.changed",()=>{const e=this.current&&this.current.element;e&&this.open(e,!0)}),this.eventBus.on("diagram.clear",()=>{this.close()})}canOpen(e){return this.rules.allowed("canOpenContextPad",{})}getSeparatorConfig(){return{className:"entry-separator"}}getNoopConfig(){return{noop:{className:"noop-entry"}}}sliceObj(e,t,n){return Object.keys(e).slice(t,n).reduce((i,o)=>(i[o]=e[o],i),{})}addNoopEntry(e){const t=Object.keys(e);return t.length<=2||t[1]==="setup"?e:{...this.sliceObj(e,0,1),...this.getNoopConfig(),...this.sliceObj(e,1,t.length)}}addSeparators(e){const t=Object.keys(e);return t.length<=1?e:t.length===2?t[1]==="setup"?e:(this.oneColumnMode=!0,{...this.sliceObj(e,0,1),separator1:this.getSeparatorConfig(),...this.sliceObj(e,1,t.length)}):{...this.sliceObj(e,0,2),separator1:this.getSeparatorConfig(),separator2:this.getSeparatorConfig(),...this.sliceObj(e,2,t.length)}}fixConnectToolPosition(e){const t=Object.keys(e);if(t.length<=2)return e;const n=t.indexOf("connect");if(n<0||n%2===0)return e;const i=t[n-1];return{...this.sliceObj(e,0,n-1),connect:e.connect,[i]:e[i],...this.sliceObj(e,n+1,t.length)}}fixEntries(e){return this.oneColumnMode=!1,e=this.addNoopEntry(e),e=this.addSeparators(e),e=this.fixConnectToolPosition(e),e}trigger(e,t,n=!1){const{entries:i,element:o}=this.current,a=t.delegateTarget||t.target;if(!a)return t.preventDefault();const c=(0,f.attr)(a,"data-action"),u=i[c].action,m=t.originalEvent||t;if((0,j.isFunction)(u)){if(e==="click")return u(m,o,n)}else if(u[e])return u[e](m,o,n);t.preventDefault()}getConnectionBBox(e){const t=(0,Ht.U7)(e);return{x:t.x,y:t.y,width:t.width,height:t.height}}getElementBBox(e){return{x:e.x,y:e.y,width:e.width,height:e.height}}getPadPosition(e){const t={left:9,top:-6},n=this.canvas.viewbox(),i=e.waypoints?this.getConnectionBBox(e):this.getElementBBox(e),o=i.x+i.width+t.left-n.x,a=i.y+t.top-n.y,c=n.scale;return{x:Math.round(o*c),y:Math.round(a*c)}}getEntryControl(e,t){const{className:n,title:i,imageUrl:o}=t,a=(0,f.domify)(`<div class="entry" draggable="true" data-action="${e}"></div>`);if(n){const c=(0,f.classes)(a);((0,j.isArray)(n)?n:n.split(/\s+/g)).forEach(u=>{c.add(u)})}return i&&(0,f.attr)(a,"title",i),o&&a.appendChild((0,f.domify)('<img src="'+o+'">')),a}addEntriesContainer(e){const t=(0,f.domify)('<div class="group"></div>');return(0,j.forEach)(e,(n,i)=>{const o=this.getEntryControl(i,n);t.appendChild(o)}),t}getPad(e){if(this.isOpen())return this.current.pad;const t=(0,f.domify)('<div class="djs-context-pad"></div>');f.delegate.bind(t,Xi,"click",o=>{this.trigger("click",o)}),f.delegate.bind(t,Xi,"dragstart",o=>{this.trigger("dragstart",o)}),f.event.bind(t,"mousedown",o=>{o.stopPropagation()});const n=this.getPadPosition(e);(0,j.assign)(t.style,{position:"absolute",left:n.x+"px",top:n.y+"px",visibility:"visible"});const i={html:t};return this.eventBus.fire("contextPad.create",{element:e,pad:i}),i}getEntries(e){const t={};return(0,j.forEach)(this._providers,n=>{const i=n.getContextPadEntries(e);(0,j.forEach)(i,(o,a)=>{t[a]=o})}),this.fixEntries(t)}registerProvider(e){this._providers.push(e)}open(e,t=!1){if(!t&&this.isOpen(e)||(this.close(),!this.canOpen(e)))return;const n=this.getEntries(e);if(g.isEmpty(n))return;const i=this.addEntriesContainer(n),o=this.getPad(e),a=o.html;a.appendChild(i),(0,f.classes)(a).add("open"),(0,f.classes)(a).toggle("one-column-grid",this.oneColumnMode),this.canvas.getContainer().appendChild(a),this.current={element:e,pad:o,entries:n},this.eventBus.fire("contextPad.open",{current:this.current})}isOpen(e){return this.current&&(!e||this.current.element===e)}close(){this.isOpen()&&((0,f.remove)(this.current.pad.html),this.eventBus.fire("contextPad.close",{current:this.current}),this.current.pad.html=null,this.current=null)}};Un=(0,r.__decorate)([(0,r.__param)(0,l("eventBus")),(0,r.__param)(1,l("overlays")),(0,r.__param)(2,l("rules")),(0,r.__param)(3,l("canvas")),(0,r.__metadata)("design:paramtypes",[Object,Object,Object,Object])],Un);var kr=p(7034);let Hn=class extends kr.A{constructor(e,t,n,i,o,a,c,h,u,m){super(e,t,n,i,o,a,c,h),this.canvas=e,this.create=t,this.clipboard=n,this.elementFactory=i,this.eventBus=o,this.modeling=a,this.mouse=c,this.rules=h,this.diagramText=u,this.config=m,this.init()}_onPasteElement(e){Object.assign(e.hints,{generateUniqueCaption:!1,isElementCopyPaste:!0})}onCopyElement({element:e,descriptor:t}){this.copyProperties.forEach(n=>t[n]=(0,g.clone)(e[n]))}init(){this.copyProperties=["type","caption"],this.eventBus.on("copyPaste.pasteElements",e=>this._onPasteElement(e)),this.eventBus.on("copyPaste.copyElement",e=>this.onCopyElement(e))}resetLabelsPosition(e){const t=e.filter(n=>_.isLabel(n));t.length===1&&e.length===2&&this.diagramText.resetLabelPosition(t[0])}_createElements(e){const t=super._createElements(e);return this.resetLabelsPosition(t),t}createShape(e){const t=e.id,n=super.createShape(e);return n.sourceId=t,n}};Hn=(0,r.__decorate)([(0,r.__param)(0,l("canvas")),(0,r.__param)(1,l("create")),(0,r.__param)(2,l("clipboard")),(0,r.__param)(3,l("elementFactory")),(0,r.__param)(4,l("eventBus")),(0,r.__param)(5,l("modeling")),(0,r.__param)(6,l("mouse")),(0,r.__param)(7,l("rules")),(0,r.__param)(8,l("diagramText")),(0,r.__param)(9,l("config")),(0,r.__metadata)("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object,Object,Object,Object])],Hn);let De=class{constructor(e,t){this.eventBus=e,this.canvas=t}getEntry(e,t){const n=(0,j.matchPattern)({id:t}),i=(0,j.find)(e,n);if(!i)throw new Error("entry not found");return i}createContainer(){const t=this.canvas.getContainer().getBoundingClientRect(),i=(0,f.query)(`[data-action="${this.paletteEntryId}"]`).getBoundingClientRect(),o={x:12,y:-5},a={x:i.left+i.width+o.x-t.left,y:i.top+o.y-t.top},c=(0,f.domify)('<div class="djs-popup diagram-create-popup-menu">');return(0,j.assign)(c.style,{position:"absolute",left:a.x+"px",top:a.y+"px",visibility:"hidden"}),c}alignPosition(e){const n=this.canvas.getContainer().getBoundingClientRect(),i=e.getBoundingClientRect(),o=10,a=i.top+i.height-(n.top+n.height)+o;if(a>0){let c=i.top-n.top-a;c=c>o?c:o,(0,j.assign)(e.style,{top:c+"px"})}}entryAction(e,t,n){n.preventDefault();const i=n.delegateTarget||n.target,o=(0,f.attr)(i,"data-id"),a=this.getEntry(e,o),c=a.action[t];c&&c.call(null,n,a)}attachContainer(e,t){const n=this.canvas.getContainer();f.delegate.bind(t,".entry","dragstart",this.entryAction.bind(this,e,"dragstart")),f.delegate.bind(t,".entry","click",this.entryAction.bind(this,e,"click")),n.appendChild(t),this.alignPosition(t),(0,j.assign)(t.style,{visibility:"visible","z-index":1e3,opacity:1}),this.subscribeEvents(),t.onwheel=i=>this.onWheel(i)}createEntriesContainer(e){const t=(0,f.domify)('<div class="djs-popup-body">');return(0,j.forEach)(e,n=>{const i=this.createEntry(n);t.appendChild(i)}),t}createEntry(e){if(!e.id)throw new Error("every entry must have the id property set");const t=(0,f.domify)('<div class="entry" draggable="true"></div>');(0,f.classes)(t).add("entry"),(0,f.attr)(t,"data-id",e.id);const i=(0,f.domify)("<span>");return i.textContent=e.label,t.appendChild(i),t.appendChild((0,f.domify)('<img src="'+e.imageUrl+'" />')),t}subscribeEvents(){const e=this.eventBus;e.once("contextPad.close",this.close.bind(this)),e.once("popupMenu.open",this.close.bind(this)),e.once("canvas.viewbox.changing",this.close.bind(this)),e.once("commandStack.changed",this.close.bind(this)),e.once("element.mousedown",A.HIGH,this.close.bind(this)),e.once("keyboard.keydown",A.HIGH,this.close.bind(this))}unsubscribeEvents(){const e=this.eventBus;e.off("contextPad.close",this.close.bind(this)),e.off("popupMenu.open",this.close.bind(this)),e.off("canvas.viewbox.changed",this.close.bind(this)),e.off("commandStack.changed",this.close.bind(this)),e.off("element.mousedown",this.close.bind(this)),e.off("keyboard.keydown",this.close.bind(this))}open(e,t,n){if(this.isOpen()&&(this.close(),e.type===this.currentElement.type))return;this.currentElement=e,this.paletteEntryId=t,this.eventBus.fire("createPopupMenu.open",{paletteEntryId:t});const i=this.createContainer(),o=this.createEntriesContainer(n);i.appendChild(o),this.attachContainer(n,i),this.container=i}close(){if(!this.isOpen())return;const e=this.paletteEntryId;this.eventBus.fire("createPopupMenu.close",{paletteEntryId:e}),this.unsubscribeEvents(),(0,f.remove)(this.container),this.container=null}isOpen(){return!!this.container}onWheel(e){const t=e.wheelDeltaY||-(e.deltaY*25);this.container.scrollTop-=t,e.stopPropagation(),e.returnValue=!1}};De=(0,r.__decorate)([(0,r.__param)(0,l("eventBus")),(0,r.__param)(1,l("canvas")),(0,r.__metadata)("design:paramtypes",[Object,Object])],De);var Ar=p(20990);let Kn=class extends Ar.A{constructor(e,t){super(t,e),this.injector=e}_registerDefaultActions(){super._registerDefaultActions.call(this,this.injector);const e=this.injector.get("elementRegistry",!1),t=this.injector.get("selection",!1);e&&t&&super._registerAction("selectAll",()=>{const n=e.getAllElements();return t.select(n),n})}};Kn=(0,r.__decorate)([(0,r.__param)(0,l("injector")),(0,r.__param)(1,l("eventBus")),(0,r.__metadata)("design:paramtypes",[Object,Object])],Kn);var Ir=p(15176);class Qi extends Ir.A{constructor(){super(),bn().config({disableDefaultAlphabetLength:!0}),bn().characters("0123456789abcdefghijklmnopqrstuvwxyz")}generateId(e){return e+"_"+bn().generate()}create(e,t){return t=Object.assign({},t),t.type||(t.type=e),t.id||(t.id=this.generateId(t.type)),super.create(e,t)}}var Dr=p(54343);let $n=class extends Dr.A{constructor(e){super(),this.injector=e}getAllElements(){const t=this.injector.get("canvas",!1).getRootElement();return super.filter(n=>n!==t)}getAll(){return this.getAllElements()}getGraphics(e,t){return super.getGraphics(e,t)}get(e){return super.get(e)}};$n=(0,r.__decorate)([(0,r.__param)(0,l("injector")),(0,r.__metadata)("design:paramtypes",[Object])],$n),(0,Ne.marker)("diagram.elementTools.connect.connect"),(0,Ne.marker)("diagram.elementTools.remove"),(0,Ne.marker)("diagram.elementTools.changeType");const Tr="assets/images/icon_tools_del.svg",Pr="assets/images/icon_tools_setup.svg",Mr="assets/images/icon_tools_arrow.svg";let Zt=class{constructor(e,t){this.elements=e,this.config=t,this.addItems=this.getAddItems(),this.tools=this.getTools()}getAddItems(){return[]}getTools(){const e=this.config.localizableStrings;return{connect:{imageUrl:Mr,title:e.get("elementTools.connect.connect")},setup:{imageUrl:Pr,title:e.get("elementTools.changeType")},delete:{imageUrl:Tr,title:e.get("elementTools.remove")}}}};Zt=(0,r.__decorate)([(0,r.__param)(0,l("elements")),(0,r.__param)(1,l("config")),(0,r.__metadata)("design:paramtypes",[H,Object])],Zt);var Rr=p(77117),qi=p(34495);const B={Backspace:{code:"Backspace",keyCode:8},Tab:{code:"Tab",keyCode:9},Enter:{code:"Enter",keyCode:13},NumpadEnter:{code:"NumpadEnter",keyCode:13},Escape:{code:"Escape",keyCode:27},Space:{code:"Space",keyCode:32},PageUp:{code:"PageUp",keyCode:33},PageDown:{code:"PageDown",keyCode:34},End:{code:"End",keyCode:35},Home:{code:"Home",keyCode:36},ArrowLeft:{code:"ArrowLeft",keyCode:37},ArrowUp:{code:"ArrowUp",keyCode:38},ArrowRight:{code:"ArrowRight",keyCode:39},ArrowDown:{code:"ArrowDown",keyCode:40},Insert:{code:"Insert",keyCode:45},Delete:{code:"Delete",keyCode:46},ShiftLeft:{code:"ShiftLeft",keyCode:16},ShiftRight:{code:"ShiftRight",keyCode:16},ControlLeft:{code:"ControlLeft",keyCode:17},ControlRight:{code:"ControlRight",keyCode:17},AltLeft:{code:"AltLeft",keyCode:18},AltRight:{code:"AltRight",keyCode:18},CapsLock:{code:"CapsLock",keyCode:20},OSLeft:{code:"OSLeft",keyCode:91},OSRight:{code:"OSRight",keyCode:92},Digit0:{code:"Digit0",keyCode:48},Digit1:{code:"Digit1",keyCode:49},Digit2:{code:"Digit2",keyCode:50},Digit3:{code:"Digit3",keyCode:51},Digit4:{code:"Digit4",keyCode:52},Digit5:{code:"Digit5",keyCode:53},Digit6:{code:"Digit6",keyCode:54},Digit7:{code:"Digit7",keyCode:55},Digit8:{code:"Digit8",keyCode:56},Digit9:{code:"Digit9",keyCode:57},KeyA:{code:"KeyA",keyCode:65},KeyB:{code:"KeyB",keyCode:66},KeyC:{code:"KeyC",keyCode:67},KeyD:{code:"KeyD",keyCode:68},KeyE:{code:"KeyE",keyCode:69},KeyF:{code:"KeyF",keyCode:70},KeyG:{code:"KeyG",keyCode:71},KeyH:{code:"KeyH",keyCode:72},KeyI:{code:"KeyI",keyCode:73},KeyJ:{code:"KeyJ",keyCode:74},KeyK:{code:"KeyK",keyCode:75},KeyL:{code:"KeyL",keyCode:76},KeyM:{code:"KeyM",keyCode:77},KeyN:{code:"KeyN",keyCode:78},KeyO:{code:"KeyO",keyCode:79},KeyP:{code:"KeyP",keyCode:80},KeyQ:{code:"KeyQ",keyCode:81},KeyR:{code:"KeyR",keyCode:82},KeyS:{code:"KeyS",keyCode:83},KeyT:{code:"KeyT",keyCode:84},KeyU:{code:"KeyU",keyCode:85},KeyV:{code:"KeyV",keyCode:86},KeyW:{code:"KeyW",keyCode:87},KeyX:{code:"KeyX",keyCode:88},KeyY:{code:"KeyY",keyCode:89},KeyZ:{code:"KeyZ",keyCode:90},NumpadMultiply:{code:"NumpadMultiply",keyCode:106},NumpadAdd:{code:"NumpadAdd",keyCode:107},NumpadDecimal:{code:"NumpadDecimal",keyCode:108},NumpadSubtract:{code:"NumpadSubtract",keyCode:109},NumpadDivide:{code:"NumpadDivide",keyCode:111},F1:{code:"F1",keyCode:112},F2:{code:"F2",keyCode:113},F3:{code:"F3",keyCode:114},F4:{code:"F4",keyCode:115},F5:{code:"F5",keyCode:116},F6:{code:"F6",keyCode:117},F7:{code:"F7",keyCode:118},F8:{code:"F8",keyCode:119},F9:{code:"F9",keyCode:120},F10:{code:"F10",keyCode:121},F11:{code:"F11",keyCode:122},F12:{code:"F12",keyCode:123},F13:{code:"F13",keyCode:124},F14:{code:"F14",keyCode:125},F15:{code:"F15",keyCode:126},F16:{code:"F16",keyCode:127},F17:{code:"F17",keyCode:128},F18:{code:"F18",keyCode:129},F19:{code:"F19",keyCode:130},F20:{code:"F20",keyCode:131},F21:{code:"F21",keyCode:132},F22:{code:"F22",keyCode:133},F23:{code:"F23",keyCode:134},F24:{code:"F24",keyCode:135},NumLock:{code:"NumLock",keyCode:144},Semicolon:{code:"Semicolon",keyCode:186},Equal:{code:"Equal",keyCode:187},Comma:{code:"Comma",keyCode:188},Minus:{code:"Minus",keyCode:189},Period:{code:"Period",keyCode:190},Slash:{code:"Slash",keyCode:191},Backquote:{code:"Backquote",keyCode:192},IntlRo:{code:"IntlRo",keyCode:193},BracketLeft:{code:"BracketLeft",keyCode:219},Backslash:{code:"Backslash",keyCode:220},BracketRight:{code:"BracketRight",keyCode:221},Quote:{code:"Quote",keyCode:222},IntlYen:{code:"IntlYen",keyCode:255}};function st(s){const e=B[s.code];return e?e.keyCode:s.keyCode}function Lr(s){if(s.ctrlKey||s.metaKey||s.altKey)return!1;const e=s.which||s.keyCode;return e>47&&e<58||e>64&&e<91||e>95&&e<112||e>185&&e<193||e>218&&e<223}function X(s,e,t={}){return!g.isUndefined(t.ctrl)&&t.ctrl!==(0,qi.nM)(s)||!g.isUndefined(t.shift)&&t.shift!==(0,qi.Tu)(s)?!1:st(s)===e.keyCode}function Br(s){return st(s)===B.Enter.keyCode}function Fr(s,e){s.shiftKey||(s.stopPropagation(),s.preventDefault(),s.ctrlKey||s.altKey?document.execCommand("insertText",!1,`
`):e())}class zr extends Rr.A{registerBindings(e,t){const o=(a,c)=>{t.isRegistered(a)&&e.addListener(c)};o("stepZoom",a=>{const c=a.keyEvent;if(X(c,B.Equal,{ctrl:!0})||X(c,B.NumpadAdd,{ctrl:!0}))return t.trigger("stepZoom",{value:1}),!0}),o("undo",a=>{const c=a.keyEvent;if(X(c,B.KeyZ,{ctrl:!0,shift:!1}))return t.trigger("undo"),!0}),o("redo",a=>{const c=a.keyEvent;if(X(c,B.KeyY,{ctrl:!0})||X(c,B.KeyZ,{ctrl:!0,shift:!0}))return t.trigger("redo"),!0}),o("copy",a=>{const c=a.keyEvent;if(X(c,B.KeyC,{ctrl:!0}))return t.trigger("copy"),!0}),o("paste",a=>{const c=a.keyEvent;if(X(c,B.KeyV,{ctrl:!0}))return t.trigger("paste"),!0}),o("selectAll",a=>{const c=a.keyEvent;if(X(c,B.KeyA,{ctrl:!0}))return t.trigger("selectAll"),!0}),super.registerBindings(e,t)}}var Nr=p(40406);let Wn=class extends Nr.A{constructor(e,t,n,i,o,a){super(e,t,n,i,o,a),this.eventBus=e,this.canvas=t,this.dragging=n,this.elementRegistry=i,this.selection=o,this.toolManager=a}select(e,t){const n=(0,Ht.rx)(e,t),i=(0,j.values)(n),o=i.filter(a=>_.isLabel(a)&&i.includes(a.parent)||!_.isLabel(a));this.selection.select(o)}};Wn=(0,r.__decorate)([(0,r.__param)(0,l("eventBus")),(0,r.__param)(1,l("canvas")),(0,r.__param)(2,l("dragging")),(0,r.__param)(3,l("elementRegistry")),(0,r.__param)(4,l("selection")),(0,r.__param)(5,l("toolManager")),(0,r.__metadata)("design:paramtypes",[Object,Object,Object,Object,Object,Object])],Wn);let Yt=class{constructor(e,t,n,i,o){this.elementRegistry=e,this.diagramModeling=t,this.elements=n,this.eventBus=i,this.logger=o,this.errors=[],this.loadRenderInterval=500}createElement(e,t){this.diagramModeling.createDiagramElement(e,t)}createLabel(e,t){this.diagramModeling.createDiagramLabel({value:e,id:t})}createConnection(e,t){const n=g.cloneDeep(e),{source:i,target:o}=n,a=this.elementRegistry,c=a.get(i),h=a.get(o),u=this.getConnectionAttributes(t,n);this.diagramModeling.connect(c,h,u,e.hints||{})}addOriginalToWaypoint(e,t){if(!e.original){const n=this.elementRegistry.get(t);n&&(e.original=_.getOriginalWaypoint(e,n))}}addOriginalToConnection(e){const t=e.waypoints;if(t&&t.length>1){const n=t[0];this.addOriginalToWaypoint(n,e.source);const i=t[t.length-1];this.addOriginalToWaypoint(i,e.target)}}getConnectionAttributes(e,t){const{waypoints:n,name:i,type:o=L.connection}=t;this.addOriginalToConnection(t);let{caption:a,documentation:c}=t;return a=a&&a.toString(),c=c&&c.toString(),{id:e,waypoints:n,name:i,caption:a,documentation:c,type:o}}load(e,t,n){var i=this;return(0,E.A)(function*(){i.errors=[];const o=[...g.map(e.elements,(c,h)=>({handler:()=>i.createElement(h,e.elements),id:h})),...g.map(e.connections,(c,h)=>({handler:()=>i.createConnection(c,h),id:h})),...g.map(e.labels,(c,h)=>({handler:()=>i.createLabel(c,h),id:h}))];let a=Number(new Date);try{for(let c=0,h=o.length;c<h&&!t.isStopped;c++){try{o[c].handler()}catch(m){i.errors.push(o[c].id+" "+m.toString()),console.error(m)}if(Number(new Date)-a>i.loadRenderInterval){const m=Math.round(c/h*100);n.next(m),yield new Promise(w=>g.delay(w,0)),a=Number(new Date)}}return i.errors.length&&i.logger.exception(`Error when loading process with ID: ${e.id}`,{loggerName:"DiagramLoader"},i.errors),i.errors}finally{n.next(0),t.isStopped||i.eventBus.fire("diagram.loaded")}})()}};Yt=(0,r.__decorate)([(0,r.__param)(0,l("elementRegistry")),(0,r.__param)(1,l("modeling")),(0,r.__param)(2,l("elements")),(0,r.__param)(3,l("eventBus")),(0,r.__param)(4,l("loggerService")),(0,r.__metadata)("design:paramtypes",[Object,Y,H,Object,ce])],Yt);class Te extends Ke{constructor(){super({prefix:"bpmonline-designer.diagram",storageType:"localStorage"}),this.diagramId=""}set(e,t,n=!0){return n&&(e+="."+this.diagramId),super.set(e,t)}get(e,t=!0){return t&&(e+="."+this.diagramId),super.get(e)}remove(...e){return e&&(e=e.map(t=>t+"."+this.diagramId)),super.remove(...e)}static{this.\u0275fac=function(t){return new(t||Te)}}static{this.\u0275prov=d.\u0275\u0275defineInjectable({token:Te,factory:Te.\u0275fac})}}var Ur=p(25141),es=p.n(Ur),Hr=p(12266);const Xt=50,Kr={min:.2,max:4},$r=10,Wr=.1;let Vn=class{constructor(e,t,n,i,o,a,c,h){this.eventBus=e,this.canvas=t,this.elementRegistry=n,this.zoomScroll=i,this.localStorage=o,this.popupMenu=a,this.config=c,this.diagramUtils=h,this.openStateKey="minimap-state",this.loadMiniMapRenderInterval=50,this._onElementAdded=this.onElementAdded.bind(this),this._onElementRemoved=this.onElementRemoved.bind(this),this._onElementsChanged=this.onElementsChanged.bind(this),this._onElementUpdateId=this.onElementUpdateId.bind(this),this.init()}init(){const e=this.getOpenState();this._state={isOpen:e,isDragging:!1,initialDragPosition:null,offsetViewport:null,cachedViewbox:null,dragger:null,svgClientRect:null,parentClientRect:null,zoomDelta:0,data:null},this.createComponent(),this.registerPopupMenu(),this.subscribeEvents()}getOpenState(){return this.localStorage.get(this.openStateKey,!1)}setOpenState(e){(0,j.assign)(this._state,{isOpen:e}),this.localStorage.set(this.openStateKey,e,!1),e?((0,f.classes)(this.parent).add("open"),(0,f.attr)(this.mapButtons.preview,"title",this.config.localizableStrings.get("miniMapClose"))):((0,f.classes)(this.parent).remove("open"),(0,f.attr)(this.mapButtons.preview,"title",this.config.localizableStrings.get("miniMapOpen")))}createComponent(){this.parent=document.createElement("div"),(0,f.classes)(this.parent).add("djs-minimap"),f.event.bind(this.parent,"mousedown",t=>t.stopPropagation());const e=this.canvas.getContainer();this.isOpen()&&(0,f.classes)(this.parent).add("open"),e.appendChild(this.parent),this.initButtons(),this.map=document.createElement("div"),(0,f.classes)(this.map).add("map"),this.parent.appendChild(this.map),this.svg=(0,y.vt)("svg"),(0,y.CF)(this.svg,{width:"100%",height:"100%"}),(0,y.BC)(this.map,this.svg),this.elementsGroup=(0,y.vt)("g"),(0,y.BC)(this.svg,this.elementsGroup),this.viewportGroup=(0,y.vt)("g"),(0,y.BC)(this.svg,this.viewportGroup),this.viewport=(0,y.vt)("rect"),(0,y.Ly)(this.viewport).add("viewport"),(0,y.BC)(this.viewportGroup,this.viewport),this.viewportDom=document.createElement("div"),(0,f.classes)(this.viewportDom).add("viewport-dom"),this.parent.appendChild(this.viewportDom),this.overlay=document.createElement("div"),(0,f.classes)(this.overlay).add("overlay"),this.parent.appendChild(this.overlay)}initButtons(){const e=document.createElement("div");(0,f.classes)(e).add("map-buttons"),this.mapButtons={},this.getMapButtonsConfig().forEach(n=>{const i=document.createElement("div");if(["map-button",...n.classes].forEach(o=>(0,f.classes)(i).add(o)),n.title){let o=this.config.localizableStrings.get(n.title);n.shortcut&&(o+=` (${n.shortcut})`),(0,f.attr)(i,"title",o)}n.caption&&(i.textContent=n.caption),this.subscribeUserEvent(i,"click",n.click),this.mapButtons[n.id]=i,e.appendChild(i)}),this.parent.appendChild(e)}getMapButtonsConfig(){return[{id:"preview",classes:["material-icons","preview-button"],title:this.isOpen()?"miniMapClose":"miniMapOpen",caption:"icon_preview_16",click:()=>this.preview()},{id:"fitToView",classes:["material-icons","fit-to-view-button"],title:"fitToView",shortcut:"Ctrl+0",caption:"icon_fullscreen_16",click:()=>this.fitToView()},{id:"resetView",classes:["reset-view-button"],title:"resetView",caption:"1:1",click:()=>this.resetView()},{id:"zoomOut",classes:["material-icons","zoom-out-button"],title:"zoomOut",shortcut:"Ctrl+-",caption:"icon_zoom_out_16",click:()=>this.zoomScroll.zoomOut()},{id:"zoomIn",classes:["material-icons","zoom-in-button"],title:"zoomIn",shortcut:"Ctrl++",caption:"icon_zoom_in_16",click:()=>this.zoomScroll.zoomIn()},{id:"zoom",classes:["zoom-button"],caption:"100%",click:()=>this.togglePopupMenu()}]}subscribeEvents(){let e=!0;this.eventBus.on("diagram.loaded",()=>{e?(e=!1,this.isOpen()&&this.open().then(()=>{this.onDiagramLoaded().then()})):this.onDiagramLoaded().then()}),this.subscribeUserEvent(this.svg,"click",t=>this.onSvgClick(t)),f.event.bind(this.viewportDom,"mousedown",t=>this.onMousedown(!1,t)),f.event.bind(this.svg,"mousedown",t=>this.onMousedown(!0,t)),this.subscribeUserEvent(this.parent,"wheel",t=>this.onParentWheel(t)),this.eventBus.on("canvas.viewbox.changed",()=>this.onViewBoxChanged()),this.eventBus.on("canvas.resized",()=>this.onCanvasResized()),this.eventBus.on("zoom.changed",(t,n)=>this._onZoomChanged(n)),this.eventBus.on("keyboard.keydown",t=>this.onKeyDown(t)),this.eventBus.on("diagram.clear",()=>this.onClear())}onDiagramLoaded(){var e=this;return(0,E.A)(function*(){e.isOpen()&&(yield e.loadData(),e.subscribeElementEvents())})()}onSvgClick(e){this.setViewboxCenteredAroundClickEvent(e)}onViewBoxChanged(){this._state.isDragging||this.update()}onCanvasResized(){document.body.contains(this.parent)&&(this._state.isDragging||this.update(),this._state._svgClientRect=this.svg.getBoundingClientRect())}onKeyDown({keyEvent:e}){if(e.ctrlKey&&st(e)===B.Digit0.keyCode)return this.fitToView(),!1}onClear(){this.isOpen()&&this.unsubscribeElementEvents(),this.elementRegistry.getAllElements().forEach(e=>this.removeElement(e))}subscribeUserEvent(e,t,n){f.event.bind(e,t,i=>{i.preventDefault(),i.stopPropagation(),n.call(this,i)})}onParentWheel(e){if(!e.ctrlKey||(this.updateSvgClientRect(),!this.isPointInside(e,this._state._svgClientRect)))return;const{deltaMode:t,deltaX:n,deltaY:i}=e,o=t===0?.02:.32,a=Math.sqrt(Math.pow(i,2)+Math.pow(n,2))*Math.sign(i)*-o;if(this._state.zoomDelta+=a,Math.abs(this._state.zoomDelta)>Wr){const c=a>0?1:-1,h=Math.log(this.canvas.zoom())/Math.log(10),u=this.getStepSize(Kr,$r*2),m=Math.round(h/u)*u+u*c,w=Math.pow(10,m);this.zoomScroll.setZoom(w),this._state.zoomDelta=0;const v=this.mapMousePositionToDiagramPoint(e);this.setViewboxCenteredAroundPoint(v),this.update()}}update(){if(!this.isOpen())return;const e=this.canvas.viewbox(),t=e.inner,n=e.outer;if(!this.validViewbox(e))return;let i,o,a,c;const h=n.width-t.width,u=n.height-t.height;t.width<n.width?(i=t.x-h/2,a=n.width,t.x+t.width<n.width&&(i=Math.min(0,t.x))):(i=t.x,a=t.width),t.height<n.height?(o=t.y-u/2,c=n.height,t.y+t.height<n.height&&(o=Math.min(0,t.y))):(o=t.y,c=t.height),i=i-Xt,o=o-Xt,a=a+Xt*2,c=c+Xt*2,this.lastViewbox={x:i,y:o,width:a,height:c},(0,y.CF)(this.svg,{viewBox:i+", "+o+", "+a+", "+c}),(0,y.CF)(this.viewport,{x:e.x,y:e.y,width:e.width,height:e.height});const m=this.map.getBoundingClientRect();this._state._parentClientRect=m;const w=this.viewport.getBoundingClientRect(),v={top:w.top-m.top,left:w.left-m.left,width:w.width,height:w.height};(0,j.assign)(this.viewportDom.style,{top:v.top+"px",left:v.left+"px",width:v.width+"px",height:v.height+"px"});const Q=this.getOverlayClipPath(m,v);(0,j.assign)(this.overlay.style,{clipPath:Q})}setViewboxCenteredAroundClickEvent(e){this.updateSvgClientRect();const t=this.mapMousePositionToDiagramPoint(e);this.setViewboxCenteredAroundPoint(t),this.update()}onMousedown(e,t){if(t.button!==0)return;this.updateSvgClientRect(),e&&this.setViewboxCenteredAroundClickEvent(t);const n=this.mapMousePositionToDiagramPoint(t),i=this.canvas.viewbox(),o=this.getOffsetViewport(n,i),a=this.viewportDom.getBoundingClientRect(),c={x:t.clientX-a.left+1,y:t.clientY-a.top+1};(0,j.assign)(this._state,{cachedViewbox:i,initialDragPosition:{x:t.clientX,y:t.clientY},isDragging:!0,offsetViewport:o,offsetViewportDom:c,viewportClientRect:this.viewport.getBoundingClientRect(),parentClientRect:this.map.getBoundingClientRect()}),f.event.bind(document,"mousemove",this.onMousemove.bind(this)),f.event.bind(document,"mouseup",this.onMouseup.bind(this))}updateSvgClientRect(){(!this._state._svgClientRect||this.isZeroDimensional(this._state._svgClientRect))&&(this._state._svgClientRect=this.svg.getBoundingClientRect())}onMousemove(e){if(this._state.isDragging){this.updateSvgClientRect();const t=this._state.offsetViewportDom,n=this._state.viewportClientRect,i=this._state.parentClientRect;(0,j.assign)(this.viewportDom.style,{top:e.clientY-t.y-i.top+"px",left:e.clientX-t.x-i.left+"px"});const o=this.getOverlayClipPath(i,{top:e.clientY-t.y-i.top,left:e.clientX-t.x-i.left,width:n.width,height:n.height});(0,j.assign)(this.overlay.style,{clipPath:o});const a=this.mapMousePositionToDiagramPoint(e);this.setViewboxCenteredAroundPoint({x:a.x-this._state.offsetViewport.x,y:a.y-this._state.offsetViewport.y})}}onMouseup(e){if(this._state.isDragging){const t=this._state.initialDragPosition;t.x===e.clientX&&t.y===e.clientY&&this.setViewboxCenteredAroundClickEvent(e),this.update(),(0,j.assign)(this._state,{cachedViewbox:null,initialDragPosition:null,isDragging:!1,offsetViewport:null,offsetViewportDom:null}),f.event.unbind(document,"mousemove",this.onMousemove.bind(this)),f.event.unbind(document,"mouseup",this.onMouseup.bind(this))}}_onZoomChanged(e){this.mapButtons.zoom.textContent=Math.round(e*100)+"%"}updateElement(e){try{e.parent!==void 0&&e.parent!==null&&(this.removeElement(e),this.addElement(e))}catch(t){console.warn(`Minimap#updateElement error: ${t}`)}}addElement(e){if(this.removeElement(e),e.hidden)return;let t,n,i;const o=this.createElement(e);if(o){const a=(0,f.query)("#"+es()(e.parent.id),this.elementsGroup),c=this.elementRegistry.getGraphics(e),h=this.elementRegistry.getGraphics(e.parent),u=this.getIndexOfChildInParentChildren(c,h);return u!=="undefined"?a?a.childNodes.length>u?this.insertChildAtIndex(o,a,u):this.insertChildAtIndex(o,a,a.childNodes.length-1):this.elementsGroup.appendChild(o):this.elementsGroup.appendChild(o),this.diagramUtils.isConnection(e)?(t=e.parent,n=0,i=0,typeof t.x<"u"&&typeof t.y<"u"&&(n=-t.x,i=-t.y),(0,y.CF)(o,{transform:"translate("+n+" "+i+")",strokeWidth:"4"})):(n=e.x,i=e.y,a&&(t=e.parent,typeof t.x<"u"&&typeof t.y<"u"&&(n-=t.x,i-=t.y)),(0,y.CF)(o,{transform:"translate("+n+" "+i+")"})),e.children&&e.children.length&&e.children.forEach(m=>{this.addElement(m)}),o}}removeElement(e){const t=this.svg.getElementById(e.id);t&&(0,y.TF)(t)}createElement(e){const t=this.elementRegistry.getGraphics(e);if(t){const n=(0,Hr.P)(t);if(n){const i=(0,y.o8)(n);return(0,y.CF)(i,{id:e.id}),i}}}getOffsetViewport(e,t){return{x:e.x-(t.x+t.width/2),y:e.y-(t.y+t.height/2)}}mapMousePositionToDiagramPoint({clientX:e,clientY:t}){const n={x:e-this._state._svgClientRect.left,y:t-this._state._svgClientRect.top},i=this.svg.getBoundingClientRect(),o=this.fitAspectRatio(this.lastViewbox,i.width/i.height),a=this.mapPosition(n.x,0,i.width,o.x,o.x+o.width),c=this.mapPosition(n.y,0,i.height,o.y,o.y+o.height);return{x:a,y:c}}setViewboxCenteredAroundPoint(e){const t=this.canvas.viewbox(),n=t.width,i=t.height;this.canvas.viewbox({x:e.x-n/2,y:e.y-i/2,width:n,height:i})}fitAspectRatio(e,t){const n=e.width/e.height,i=(0,j.assign)({},{x:e.x,y:e.y,width:e.width,height:e.height});if(n>t){const o=i.width*(1/t),a=i.y-(o-i.height)/2;(0,j.assign)(i,{y:a,height:o})}else if(n<t){const o=i.height*t,a=i.x-(o-i.width)/2;(0,j.assign)(i,{x:a,width:o})}return i}mapPosition(e,t,n,i,o){const a=n-t,c=o-i;return(e-t)*c/a+i}getIndexOfChildInParentChildren(e,t){const n=(0,f.query)(".djs-children",t.parentNode);if(!n)return;const i=[].slice.call(n.childNodes);let o=-1;return i.forEach(function(a,c){(0,f.query)(".djs-element",a)===e&&(o=c)}),o}insertChildAtIndex(e,t,n){const o=[].slice.call(t.childNodes)[n];t.insertBefore(e,o.nextSibling)}isZeroDimensional(e){return e.width===0&&e.height===0}isPointInside(e,t){return e.x>t.left&&e.x<t.left+t.width&&e.y>t.top&&e.y<t.top+t.height}getStepSize(e,t){const n=Math.log(e.min)/Math.log(10),i=Math.log(e.max)/Math.log(10);return(Math.abs(n)+Math.abs(i))/t}getOverlayClipPath(e,t){return`polygon(${[[t.left,t.top],[t.left+t.width,t.top],[t.left+t.width,t.top+t.height],[t.left,t.top+t.height],[t.left,e.height],[e.width,e.height],[e.width,0],[0,0],[0,e.height],[t.left,e.height]].map(([i,o])=>`${i}px ${o}px`).join(", ")})`}validViewbox(e){return(0,j.every)(e,t=>(0,j.isObject)(t)?this.validViewbox(t):(0,j.isNumber)(t)&&isFinite(t))}subscribeElementEvents(){this.eventBus.on(["shape.added","connection.added"],A.MIN,this._onElementAdded),this.eventBus.on(["shape.removed","connection.removed"],A.MIN,this._onElementRemoved),this.eventBus.on(["elements.changed"],A.MIN,this._onElementsChanged),this.eventBus.on(["element.updateId"],A.MIN,this._onElementUpdateId)}unsubscribeElementEvents(){this.eventBus.off(["shape.added","connection.added"],this._onElementAdded),this.eventBus.off(["shape.removed","connection.removed"],this._onElementRemoved),this.eventBus.off(["elements.changed"],this._onElementsChanged),this.eventBus.off(["element.updateId"],this._onElementUpdateId)}onElementAdded({element:e}){this.addElement(e),this.update()}onElementRemoved({element:e}){this.removeElement(e),this.update()}onElementsChanged({elements:e}){e.forEach(t=>this.updateElement(t)),this.update()}onElementUpdateId({element:e,newId:t}){try{const n=(0,f.query)("#"+es()(e.id),this.elementsGroup);n&&(n.id=t)}catch(n){console.warn(`Minimap#updateElementId error: ${n}`)}}registerPopupMenu(){this.popupMenu.registerProvider("zoom",this),this.eventBus.on("minimap.open",()=>this.popupMenu.close()),this.eventBus.on("minimap.close",()=>this.popupMenu.close())}delay(e=0){return new Promise(t=>g.delay(t,e))}loadData(){var e=this;return(0,E.A)(function*(){yield e.delay();let t=Number(new Date);const n=e.elementRegistry.getAllElements();for(let i=0,o=n.length;i<o;i++){try{e.addElement(n[i])}catch(c){console.error(c)}Number(new Date)-t>e.loadMiniMapRenderInterval&&(yield e.delay(),t=Number(new Date))}})()}open(){var e=this;return(0,E.A)(function*(){e.setOpenState(!0),yield e.loadData(),e.update(),e.subscribeElementEvents(),e.eventBus.fire("minimap.open")})()}close(){this.isOpen()&&(this.setOpenState(!1),this.unsubscribeElementEvents(),this.eventBus.fire("minimap.close"))}isOpen(){return this._state.isOpen}resetView(){var e=this;return(0,E.A)(function*(){yield e.zoomScroll.animateResetView()})()}fitToView(){this.zoomScroll.fitToView()}preview(){this.isOpen()?this.close():this.open()}togglePopupMenu(){if(this.popupMenu.isOpen()){this.popupMenu.close();return}this.popupMenu.open({},"zoom",{cursor:{}})}getEntries(){var e=this;return[...[25,50,75,100,200,300].map(n=>({id:`zoom-${n}`,label:`${n}%`,action:function(){var i=(0,E.A)(function*(){yield e.zoomScroll.animateZoom(n/100)});return function(){return i.apply(this,arguments)}}()})),{id:"separator-1",className:"entry-separator",disabled:!0},{id:"reset-view",label:this.config.localizableStrings.get("resetView"),action:()=>this.resetView()},{id:"fit-into-view",label:this.config.localizableStrings.get("fitToView"),action:()=>this.fitToView()}]}};Vn=(0,r.__decorate)([(0,r.__param)(0,l("eventBus")),(0,r.__param)(1,l("canvas")),(0,r.__param)(2,l("elementRegistry")),(0,r.__param)(3,l("zoomScroll")),(0,r.__param)(4,l("localStorage")),(0,r.__param)(5,l("popupMenu")),(0,r.__param)(6,l("config")),(0,r.__param)(7,l("diagramUtils")),(0,r.__metadata)("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object,_])],Vn);var Vr=p(18587);let Gn=class extends Vr.A{constructor(e,t){super(e,t),this.eventBus=e,this.canvas=t,e.on("diagram.init",A.LOW,()=>{this.updateEntries()})}updateEntries(){const e=this.getEntries();(0,j.forEach)(e,function(t,n){const i=(0,f.query)(`[data-action="${n}"]`);t.hasOwnProperty("menu")&&(0,f.classes)(i).add("create-menu")})}getEntries(){return super.getEntries()}};Gn=(0,r.__decorate)([(0,r.__param)(0,l("eventBus")),(0,r.__param)(1,l("canvas")),(0,r.__metadata)("design:paramtypes",[Object,Object])],Gn);let Qt=class{constructor(e,t,n,i,o,a,c,h,u,m,w){this.create=e,this.elementFactory=t,this.palette=n,this.featureProvider=i,this.canvas=o,this.elements=a,this.paletteElements=c,this.rules=h,this.eventBus=u,this.createPopupMenu=m,this.config=w,this.dataActionPrefix="create-",this.init()}init(){this.rules.allowed("canShowPalette")&&(this.palette.registerProvider(this),this.subscribeEvents())}subscribeEvents(){this.eventBus.on("createPopupMenu.open",e=>this.activateEntry(e)),this.eventBus.on("createPopupMenu.close",e=>this.deactivateEntry(e))}getCreateShapeConfig(e){const t=this.elements.getConfig(e),{type:n,width:i,height:o}=t;return{type:n,width:i,height:o}}createActionClick(e,t){const n=this.getCreateShapeConfig(e),i=this.elementFactory.createShape(n);this.create.start(t,i),this.createPopupMenu.close()}openCreateMenu(e,t,n){this.createPopupMenu.open(e,t,n)}getCreateMenuEntries(e){return e.menu.map(t=>this.elements.items[t]).filter(t=>t).map(t=>({action:{dragstart:this.createActionClick.bind(this,t)},id:t.userTaskType||t.type,imageUrl:t.smallImage,label:this.config.localizableStrings.get(t.caption)}))}activateEntry({paletteEntryId:e}){const t=(0,f.query)(`[data-action="${e}"]`);(0,f.classes)(t).add("active")}deactivateEntry({paletteEntryId:e}){const t=(0,f.query)(`[data-action="${e}"]`);(0,f.classes)(t).remove("active")}getPaletteEntries(){const e={};return Object.values(this.paletteElements.getElements()).forEach(t=>{const n=this.dataActionPrefix+t.type,i={group:"elements",action:{dragstart:this.createActionClick.bind(this,t)},...t};if(t.menu){const o=this.getCreateMenuEntries(t);o.length?i.action.click=this.openCreateMenu.bind(this,t,n,o):delete i.menu}e[n]=i}),e}};Qt=(0,r.__decorate)([(0,r.__param)(0,l("create")),(0,r.__param)(1,l("elementFactory")),(0,r.__param)(2,l("palette")),(0,r.__param)(3,l("featureProvider")),(0,r.__param)(4,l("canvas")),(0,r.__param)(5,l("elements")),(0,r.__param)(6,l("paletteElements")),(0,r.__param)(7,l("rules")),(0,r.__param)(8,l("eventBus")),(0,r.__param)(9,l("createPopupMenu")),(0,r.__param)(10,l("config")),(0,r.__metadata)("design:paramtypes",[Object,Object,Object,Object,Object,H,Ie,Object,Object,De,Object])],Qt);let qt=class{constructor(e,t,n,i,o){this.config=e,this.toolManager=t,this.dragging=n,this.lassoTool=i,this.spaceTool=o}getPaletteToolsConfig(){return{arrow:{icon:"icon_arrow_select_24",title:"arrow",click:()=>{this.toolManager.setActive(null),this.dragging.cancel()}},lasso:{icon:"icon_sellect_24",title:"lasso",click:()=>{this.lassoTool.toggle()}},space:{icon:"icon_move_24",title:"space",click:()=>{this.spaceTool.toggle()}}}}getPaletteTools(e=!0){const t={},n=this.getPaletteToolsConfig();return Object.keys(n).forEach(i=>{const{icon:o,title:a,click:c}=n[i];t[i]={group:"tools",html:`<div class="entry material-icons">${o}</div>`,title:this.config.localizableStrings.get(a),action:{click:c}}}),e?{...t,separator:{separator:!0}}:t}};qt=(0,r.__decorate)([(0,r.__param)(0,l("config")),(0,r.__param)(1,l("toolManager")),(0,r.__param)(2,l("dragging")),(0,r.__param)(3,l("lassoTool")),(0,r.__param)(4,l("spaceTool")),(0,r.__metadata)("design:paramtypes",[Object,Object,Object,Object,Object])],qt);let Jn=class{constructor(e,t){this.eventBus=e,this.canvas=t,this._isOpen=!1,this._init()}_init(){this._popupContainer=(0,f.domify)('<div class="djs-diagram-popup"></div>');const e=this.canvas.getContainer();this._popup=e.appendChild(this._popupContainer),this._subscribeEvents()}_subscribeEvents(){this._subscribeEventBusEvents(),this._subscribeDomEvents()}_subscribeDomEvents(){this._popup.onwheel=e=>this._onWheel(e)}_onWheel(e){const t=e.wheelDeltaY||-(e.deltaY*25);this._popup.scrollTop-=t,e.stopPropagation(),e.returnValue=!1}_onViewBoxChanged(){this._state&&this._state.parentContainer&&this.open({parentContainer:this._state.parentContainer,html:this._state.html,width:this._state.width,options:this._state.options})}_subscribeEventBusEvents(){this.eventBus.on(["canvas.resized","zoom.changed","selection.changed"],()=>this.close()),this.eventBus.on("popup.open",e=>this.open(e)),this.eventBus.on("canvas.viewbox.changing",()=>this.hide()),this.eventBus.on("canvas.viewbox.changed",()=>this._onViewBoxChanged())}getPopupPosition(e){const{parentContainer:t}=e,{e:n,f:i}=t.getCTM(),{height:o}=t.getBoundingClientRect(),a=5,c=i+o+a,{width:h}=t.getBoundingClientRect(),u=e.options?.direction||"right";let m=n;return u==="right"&&(m+=h-e.width),u==="left"&&(m-=h),{x:m,y:c}}open(e){if(!e.width)throw new Error("width must be > 0");this._state={parentContainer:e.parentContainer,html:e.html,width:e.width,options:e.options};const{x:t,y:n}=this.getPopupPosition(e);return(0,g.assign)(this._popupContainer.style,{left:`${t}px`,top:`${n}px`,visibility:"visible",width:`${e.width}px`}),this._isOpen=!0,this._popupContainer.innerHTML=e.html,this._popupContainer}close(){this._isOpen&&(this.hide(),this._state={})}hide(){(0,g.assign)(this._popupContainer.style,{visibility:"hidden"}),this._popupContainer.innerHTML=""}};Jn=(0,r.__decorate)([(0,r.__param)(0,l("eventBus")),(0,r.__param)(1,l("canvas")),(0,r.__metadata)("design:paramtypes",[Object,Object])],Jn);var Gr=p(6226);let Zn=class extends Gr.A{constructor(e,t,n){super(e,t,n),this.contextPadItemWidth=32,this.padding=10}subscribeEvents(){this.preventScrollParent(this.getContainer());const e=this._eventBus;e.once("createPopupMenu.open",this.close.bind(this)),e.once("element.mousedown",A.HIGH,this.close.bind(this)),e.once("keyboard.keydown",A.HIGH,this.close.bind(this))}unsubscribeEvents(){const e=this._eventBus;e.off("createPopupMenu.open",this.close.bind(this)),e.off("element.mousedown",this.close.bind(this)),e.off("keyboard.keydown",this.close.bind(this))}fixContainerPosition(e,t){const i=this._canvas.getContainer().getBoundingClientRect(),o=e.getBoundingClientRect(),a=i.y+this.padding;if(o.top<a){const c=this.padding,h=t.x-this.contextPadItemWidth-o.width-this.padding;(0,j.assign)(e.style,{top:`${c}px`,left:`${h}px`})}}getContainer(){return this._current.container}preventScrollParent(e){e.onwheel=t=>this.onWheel(t)}open(e,t,n){super.open(e,t,n);const i=this.getContainer();this.fixContainerPosition(i,n),this.subscribeEvents(),(0,j.assign)(i.style,{opacity:1})}close(){super.close(),this.unsubscribeEvents()}onWheel(e){const t=e.wheelDeltaY||-(e.deltaY*25);this._current.container.scrollTop-=t,e.stopPropagation(),e.returnValue=!1}};Zn=(0,r.__decorate)([(0,r.__param)(0,l("config.popupMenu")),(0,r.__param)(1,l("eventBus")),(0,r.__param)(2,l("canvas")),(0,r.__metadata)("design:paramtypes",[Object,Object,Object])],Zn);var Jr=p(38134);class Zr extends Jr.A{addDragger(e,t,n){const i=super.addDragger(e,t,n);return i.classList.add(e.type),i}}var en=p(95820),Yr=p(97975),Pe=p(19187);const be={Connection:{Fill:"none",MarkerShape:"M-10,3 L2,0 L-10,-3 Z",MarkerfillOpacity:1,StrokeLinejoin:"round",StrokeWidth:1,PathStrokeWidth:2}};var tn;(function(s){s.Connection="connection",s.ConnectionEndMarker="connection-end-marker"})(tn||(tn={}));const Yn={arrowHoverStrokeColor:"#1186D8",arrowStrokeColor:"#8095b3",connectionMarkerFillColor:"#FFFF",connectionMarkerStrokeColor:"#60779F",connectionStrokeColor:"#8095B3"};class Xr{get endMarker(){const e=(0,y.vt)("path");return(0,y.CF)(e,{d:be.Connection.MarkerShape,"fill-opacity":be.Connection.MarkerfillOpacity,fill:Yn.arrowStrokeColor,stroke:Yn.arrowStrokeColor,strokeLinejoin:be.Connection.StrokeLinejoin,strokeWidth:be.Connection.StrokeWidth,class:tn.ConnectionEndMarker}),e}_getLastSegment(e){const t=e.length;return{a:e[t-2],b:e[t-1]}}_getFirstSegment(e){return{a:e[1],b:e[0]}}_angle(e){const t=e.b.y-e.a.y,n=e.b.x-e.a.x;return Math.atan2(t,n)}_renderMarker(e,t,n,i){e&&(this._transformMarker(e,i,n),(0,y.BC)(t,e))}_transformMarker(e,t,n){(0,y.pd)(e,(0,y.uK)(Math.cos(t),Math.sin(t),-Math.sin(t),Math.cos(t),n.x,n.y))}renderMarkers(e,t){const n=t.waypoints,i=this._getLastSegment(n),o=this._angle(i),a=this._getFirstSegment(n),c=this._angle(a),h=this.startMarker(t);this._renderMarker(h,e,a.b,c),this._renderMarker(this.endMarker,e,i.b,o)}startMarker(e){return null}getConnectionAttributes(e){return{class:tn.Connection,fill:be.Connection.Fill,stroke:Yn.connectionStrokeColor,strokeLinejoin:be.Connection.StrokeLinejoin,strokeWidth:be.Connection.PathStrokeWidth}}drawConnection(e,t,n){n.itemName&&(0,y.CF)(t,{"data-item-marker":n.itemName});const i=(0,y.vt)("g"),o=this.getConnectionAttributes(n.type),a=n.waypoints,c=["m"+a[0].x+","+a[0].y];for(let u=1;u<a.length;u++)c.push("L"+a[u].x+","+a[u].y);const h=(0,y.vt)("path");return(0,y.CF)(h,{d:c.join(" ")}),(0,y.CF)(h,o),(0,y.BC)(i,h),this.renderMarkers(i,n),(0,y.BC)(t,i),i}}var _e;(function(s){s[s.before=0]="before",s[s.after=1]="after",s[s.instead=2]="instead"})(_e||(_e={}));function ts(s,e,t=_e.instead){return(n,i,o)=>{o===void 0&&(o=Object.getOwnPropertyDescriptor(n,i));const a=o.value;return e.__instance__ instanceof e||(e.__instance__=new e),o.value=function(){const c=[].slice.call(arguments),h=[...c];let u;if(this.createFeatureContext instanceof Function&&h.unshift(this.createFeatureContext.call(this)),s(...c)){const m=e.__instance__;switch(t){case _e.before:return u=m[i].apply(m,[...h]),a.apply(this,[...c,u]);case _e.after:return u=a.apply(this,c),m[i].apply(m,[...h,u]);default:return m[i].apply(m,[...h])}}return a.apply(this,[...c,u])},o}}class ns{drawConnection(e,t,n){}}(0,r.__decorate)([ts(()=>!0,Xr),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object,Object,Object]),(0,r.__metadata)("design:returntype",Object)],ns.prototype,"drawConnection",null);var is;let ot=class{constructor(e,t,n,i){this.elements=e,this.styles=t,this.diagramText=n,this.eventBus=i}updateClass(e,t){const n=this.elements.getConfig(t),i=e.parentElement||e.parentNode,o=i.classList;(0,g.forEach)(this.elements.items,a=>{o.remove(a.type),o.remove(a.userTaskType)}),i.classList.add(n.userTaskType||n.type)}createText(e,t,n){const i=this.diagramText.createText(t,n);return(0,y.Ly)(i).add("djs-label"),n.className&&(0,y.Ly)(i).add(n.className),(0,y.BC)(e,i),i}drawRect(e,t,n,i,o,a){(0,g.isObject)(o)&&(a=o,o=0),o=o||0,a=this.styles.computeStyle(a,{fill:"none",stroke:"#EBEBEB",strokeWidth:1});const c=(0,y.vt)("rect");return(0,y.CF)(c,{height:n-o*2,rx:i,ry:i,width:t-o*2,x:o,y:o}),(0,y.CF)(c,a),(0,y.BC)(e,c),c}draw(e,t){return this.updateClass(e,t),null}};ot=(0,r.__decorate)([(0,r.__param)(0,l("elements")),(0,r.__param)(1,l("styles")),(0,r.__param)(2,l("diagramText")),(0,r.__param)(3,l("eventBus")),(0,r.__metadata)("design:paramtypes",[Object,typeof(is=typeof Pe.A<"u"&&Pe.A)=="function"?is:Object,fe,Object])],ot);const ss={ELLIPSE:"ellipse",RECTANGLE:"rect"};class Qr{static{this.xmlns="http://www.w3.org/2000/svg"}static createFeFlood(e,t="#000",n=0){return this.createElement(e,{"flood-color":t,"flood-opacity":n||0,result:"colorResult"},"feFlood")}static createFeComposite(e){return this.createElement(e,{operator:"in",in:"colorResult",in2:"blurResult",result:"shadowResult"},"feComposite")}static createFeGaussianBlur(e,t=0){return this.createElement(e,{result:"blurResult",in:"offsetResult",stdDeviation:t},"feGaussianBlur")}static createFeBlend(e){return this.createElement(e,{in:"SourceGraphic",in2:"shadowResult",mode:"normal"},"feBlend")}static setAttribute(e,t){const n=Object.keys(t);for(const i of n)e.setAttribute(i.toString(),t[i])}static createElement(e,t,n){let i;return t&&t.id&&(i=e.getElementById(t.id)),i||(i=document.createElementNS(this.xmlns,n)),t&&this.setAttribute(i,t),i}static createFilter(e,t){return this.createElement(e,{id:t,width:"200%",height:"200%"},"filter")}static createFeOffset(e,t=0,n=0){return this.createElement(e,{result:"offsetResult",in:"SourceAlpha",dx:t,dy:n},"feOffset")}static addDefs(){const e=document.querySelector("svg"),t=e.getElementsByTagName("defs")[0];if(t==null){const n=document.createElementNS(this.xmlns,"defs");return e.appendChild(n)}return t}static createShadowFilter(e){const t=document.querySelector("svg"),n=e.name;if(!n)throw new Error("ArgumentNullOrEmptyException");const i=t.getElementById(n),o="url(#"+n+")";if(i)return o;const a=this.addDefs(),c=this.createFilter(t,n),h=this.createFeOffset(t,e.offsetX,e.offsetY);c.appendChild(h);const u=this.createFeGaussianBlur(t,e.blur);c.appendChild(u);const m=this.createFeFlood(t,e.color,e.opacity);c.appendChild(m);const w=this.createFeComposite(t);c.appendChild(w);const v=this.createFeBlend(t);return c.appendChild(v),a.appendChild(c),o}}class Xn extends ot{getEllipseBackgroundConfig(e){const n=e.backgroundStyle.padding||0,i=Math.round(Math.max(e.width,e.height)/2),o=Math.round(e.height/2);return{rx:i+n,ry:o+n,cx:Math.round(e.width/2),cy:Math.round(e.height/2-1)}}getLabelBackgroundConfig(e){const t=e.backgroundStyle,i=(t&&t.type)===ss.ELLIPSE?this.getEllipseBackgroundConfig(e):this.getDefaultBackgroundConfig(e),o=t&&t.fill;g.assign(i,o?{fill:o}:{style:"fill: transparent;"});const a=t&&t.filter;if(a){const c=Qr.createShadowFilter(a);g.assign(i,{filter:c})}return i}setLabelBackground(e,t){const n=t.backgroundStyle,i=n&&n.type||ss.RECTANGLE,o=(0,y.vt)(i),a=this.getLabelBackgroundConfig(t);(0,y.CF)(o,a),(0,y.BC)(e,o)}getDefaultBackgroundConfig(e){return{height:e.height,width:e.width}}getLabelText(e){return e.caption||e.labelTarget&&e.labelTarget.caption||""}getDrawOptions(e){const t=e.caption?0:3,n={box:{height:e.height,width:e.width+t,x:e.x,y:e.y},fitBox:!1,style:{...this.diagramText.style,direction:"ltr"}};return g.assign(n.style,e.style),n}draw(e,t){super.draw(e,t),this.setLabelBackground(e,t);const n=this.getLabelText(t),i=this.getDrawOptions(t),o=this.diagramText.createText(n,i);return(0,y.Ly)(o).add("djs-label"),(0,y.BC)(e,o),o}}let nn=class{constructor(e,t){this.renderingLabel=e,this.renderingShape=t}create(e){return e===L.label?this.renderingLabel:this.renderingShape}};nn=(0,r.__decorate)([(0,r.__param)(0,l("renderingLabel")),(0,r.__param)(1,l("renderingShape")),(0,r.__metadata)("design:paramtypes",[Xn,ot])],nn);function qr(s,e=_e.before){return ts(()=>!0,s,e)}var os,rs;let sn=class extends Yr.A{constructor(e,t,n,i,o){super(e),this.eventBus=e,this.styles=t,this.diagramText=n,this.renderingFactory=i,this.elementRegistry=o}setDataItemMarker(e,t){let n=t.itemName;if(t.type===L.label){const i=t.labelTarget.itemName;n=n||i&&i+"_label"}n&&e.setAttributeNS(null,"data-item-marker",n)}canRender(){return!0}drawShape(e,t){return this.setDataItemMarker(e,t),this.renderingFactory.create(t.type).draw(e,t)}drawConnection(e,t){return super.drawConnection(e,t)}createFeatureContext(){return{styles:this.styles,diagramText:this.diagramText,elementRegistry:this.elementRegistry}}};(0,r.__decorate)([qr(ns,_e.instead),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object,Object]),(0,r.__metadata)("design:returntype",void 0)],sn.prototype,"drawConnection",null),sn=(0,r.__decorate)([(0,r.__param)(0,l("eventBus")),(0,r.__param)(1,l("styles")),(0,r.__param)(2,l("diagramText")),(0,r.__param)(3,l("renderingShapeFactory")),(0,r.__param)(4,l("elementRegistry")),(0,r.__metadata)("design:paramtypes",[typeof(os=typeof en.A<"u"&&en.A)=="function"?os:Object,typeof(rs=typeof Pe.A<"u"&&Pe.A)=="function"?rs:Object,Object,nn,Object])],sn);var ea=p(19506);let Qn=class extends ea.A{constructor(e,t,n,i,o,a,c,h){super(n,t,e,i,o,a),this.elements=c,this.diagramUtils=h,this.AXIS_TO_DIMENSION={x:"width",y:"height"}}_excludeLabelsWithoutTargets(e){return e.filter(t=>t.type===se.label?e.some(n=>n.id===t.labelTarget.id):!0)}calculateAdjustments(e,t,n,i){const o=[],a=[];return e.forEach(c=>{const h=c[t],u=h+c[this.AXIS_TO_DIMENSION[t]];if(c.parent&&!c.waypoints){if(!this.canResizeShape(c,i,t)&&(n>0&&h>i||n<0&&u<i))return o.push(c);if(this.canResizeShape(c,i,t)||h<i&&u>i&&this._rules.allowed("shape.resize",{shape:c}))return a.push(c)}}),{movingShapes:this._excludeLabelsWithoutTargets(o),resizingShapes:this._excludeLabelsWithoutTargets(a)}}init(e,t){const n=super.init(e,t);return n&&(t.minAllowedDelta=this.getMinAllowedDelta(t.resizingShapes,t.direction,t.movingShapes),t.spaceToolConstraints=null),n}getDelta(e){const t=super.getDelta(e);return _.getCorrectSpaceToolDelta(t,e)}canResizeShape(e,t,n){return!1}getMinAllowedDelta(e,t,n){return null}};Qn=(0,r.__decorate)([(0,r.__param)(0,l("eventBus")),(0,r.__param)(1,l("dragging")),(0,r.__param)(2,l("canvas")),(0,r.__param)(3,l("modeling")),(0,r.__param)(4,l("rules")),(0,r.__param)(5,l("toolManager")),(0,r.__param)(6,l("elements")),(0,r.__param)(7,l("diagramUtils")),(0,r.__metadata)("design:paramtypes",[Object,Object,Object,Object,Object,Object,H,_])],Qn);var ta=p(7264);class na extends ta.A{getDelta(e){const t=super.getDelta(e);return _.getCorrectSpaceToolDelta(t,e)}}let qn=class{constructor(e,t,n){this.eventBus=e,this.Tooltips=t,this.canvas=n,this.tooltipTimeout=400,e.on("element.hover",this.onElementHover.bind(this)),this.Tooltips._updateRoot=()=>{}}onElementHover(e){clearTimeout(this.timeoutHandle),this.timeoutHandle=setTimeout(()=>{const{element:t,gfx:n}=e;this.elementId!==t.id&&this.tooltipId&&this.removeTooltip(),t.tooltip&&!this.tooltipId&&this.addTooltip(n,t)},this.tooltipTimeout)}removeTooltip(){this.Tooltips.remove(this.tooltipId),this.tooltipId=null}addTooltip(e,t){this.elementId=t.id;const n=t.tooltipConfig||{};this.tooltipId=this.Tooltips.add({position:{x:0,y:0},type:n.type,html:this.getTemplate(t.tooltip)}),this.setPosition(e,t)}getTemplate(e){return`<div class="tooltip">${e}</div>`}getDiagramSize(){const t=this.canvas.getContainer().getBoundingClientRect();return{width:t.width,height:t.height}}getHtmlContainer(){return this.Tooltips.get(this.tooltipId).htmlContainer}setPosition(e,t){const{a:n,e:i,f:o}=e.getCTM();let a=i+t.width*n,c=o+t.height*n;const h=this.getDiagramSize(),u=this.getHtmlContainer(),{width:m,height:w}=u.getBoundingClientRect();a+m>h.width&&(a=i-m),c+w>h.height&&(c=o-w),Object.assign(u.style,{left:a+"px",top:c+"px"})}};qn=(0,r.__decorate)([(0,r.__param)(0,l("eventBus")),(0,r.__param)(1,l("tooltips")),(0,r.__param)(2,l("canvas")),(0,r.__metadata)("design:paramtypes",[Object,Object,Object])],qn);var as=p(40127),ia=p(436),sa=p(56165),cs,ls,ds;const oa={min:.2,max:4};let ei=class extends ia.A{constructor(e,t,n,i,o,a){super(e,t,n),this.config=e,this.eventBus=t,this.canvas=n,this.createPopupMenu=i,this.popupMenu=o,this.localStorage=a,this.cancelAnimation$=new x.Subject,this.eventBus.on(["canvas.viewbox.changed"],A.MEDIUM,c=>{this.onCanvasViewBoxChanged(c)})}cancelAnimation(){this.cancelAnimation$.next(!0)}_handleWheel(e){if(this.cancelAnimation(),this.createPopupMenu.isOpen()){this.createPopupMenu.onWheel(e);return}if(this.popupMenu.isOpen()){this.popupMenu.onWheel(e);return}super._handleWheel(e)}onCanvasViewBoxChanged(e){const t=this.canvas.scroll();t.x=Math.round(t.x)||0,t.y=Math.round(t.y)||0;const n=this.getInitScroll();t.x!==n.x||t.y!==n.y?this.localStorage.set("scroll",t):this.localStorage.remove("scroll");const i=e.viewbox.scale;i&&i!==this.getInitScale()?this.localStorage.set("scale",i):this.localStorage.remove("scale")}getInitScale(){return this.config&&this.config.initScale||1}getInitScroll(){return this.config&&this.config.initScroll||{x:0,y:0}}getScale(){return this.canvas.viewbox().scale}getScroll(){return this.canvas.scroll()}setZoom(e){const t=this.canvas.viewbox().outer,n={x:t.width/2,y:t.height/2};this.canvas.zoom((0,sa.N)(oa,e),n)}setScroll(e){const t=this.getScroll();this.canvas.scroll({dx:-t.x+e.x,dy:-t.y+e.y})}animateZoomScroll({toScale:e,toScroll:t,fromScale:n=null,fromScroll:i=null,stepCount:o=20,stepPeriod:a=1}){var c=this;return(0,E.A)(function*(){if(c.cancelAnimation(),n=n||c.getScale(),i=i||c.getScroll(),n===e&&i.x===t.x&&i.y===t.y)return;const h=(e-n)/o,u=(t.x-i.x)/o,m=(t.y-i.y)/o;return new Promise(w=>{(0,x.interval)(a).pipe((0,C.take)(o+1),(0,C.takeUntil)(c.cancelAnimation$),(0,C.finalize)(()=>{c.eventBus.fire("animateZoomScroll.done"),w()})).subscribe(v=>{c.setZoom(n+h*v),c.setScroll({x:i.x+u*v,y:i.y+m*v})})})})()}animateZoom(e){var t=this;return(0,E.A)(function*(){const n=t.getScroll();yield t.animateZoomScroll({toScale:e,toScroll:n,stepCount:5,stepPeriod:1})})()}initZoomScroll(e=null,t=0){const n=e||this.localStorage.get("scroll")||this.getInitScroll(),i=t||this.localStorage.get("scale")||this.getInitScale();this.getScale()!==i&&this.setZoom(i);const a=this.getScroll();(a.x!==n.x||a.y!==n.y)&&this.setScroll(n)}animateResetView(){var e=this;return(0,E.A)(function*(){yield e.animateZoomScroll({toScale:e.getInitScale(),toScroll:e.getInitScroll()})})()}fitToView(){this.cancelAnimation(),this.canvas.zoom("fit-viewport",null);const e=this.getInitScroll();this.canvas.scroll({dx:e.x,dy:e.y})}zoomOut(e=.1){this.cancelAnimation(),this.setZoom(this.getScale()-e)}zoomIn(e=.1){this.cancelAnimation(),this.setZoom(this.getScale()+e)}};ei=(0,r.__decorate)([(0,r.__param)(0,l("config")),(0,r.__param)(1,l("eventBus")),(0,r.__param)(2,l("canvas")),(0,r.__param)(3,l("createPopupMenu")),(0,r.__param)(4,l("popupMenu")),(0,r.__param)(5,l("localStorage")),(0,r.__metadata)("design:paramtypes",[Object,typeof(cs=typeof en.A<"u"&&en.A)=="function"?cs:Object,typeof(ls=typeof Pn.A<"u"&&Pn.A)=="function"?ls:Object,De,typeof(ds=typeof as.A<"u"&&as.A)=="function"?ds:Object,Te])],ei);class ti{constructor(e){this.context=e,this.modeling=e.modeling,this.localizableStrings=e.localizableStrings,this.canvas=e.canvas,this.contextPad=e.contextPad,this.popupMenu=e.popupMenu,this.connect=e.connect,this.create=e.create,this.elementFactory=e.elementFactory,this.elements=e.elements,this.elementToolsConfig=e.elementToolsConfig}getAddItemsConfig(e){const t=this.elementToolsConfig.addItems,n={};return t.forEach(i=>{const o=this.addElementDragStart.bind(this,i);n["add."+i.type]={action:{dragstart:o},imageUrl:i.image,title:i.title}}),n}getDragStartShapeConfig(e){const t=this.elements.getConfig(e);return{type:e.type,width:t.width,height:t.height,caption:""}}addElementDragStart(e,t,n){const i=this.getDragStartShapeConfig(e),o=this.elementFactory.createShape(i);this.create.start(t,o,{source:n})}getDeleteConfig(e){return{delete:{action:{click:()=>{this.modeling.removeElements([e])}},...this.elementToolsConfig.tools.delete}}}getSetupConfig(){return{setup:{action:{click:(e,t)=>{const n=this.getPopupMenuPosition(e,t);this.popupMenu.open(t,"setup",n)}},...this.elementToolsConfig.tools.setup}}}getPopupMenuPosition(e,t){const n=this.canvas.getContainer().getBoundingClientRect(),i=this.contextPad.getPad(t).html.getBoundingClientRect();return{cursor:{x:e.clientX,y:e.clientY},x:i.left+i.width+3-n.left,y:i.top-1-n.top}}getConnectConfig(){return{connect:{action:{dragstart:(e,t,n)=>{this.connect.start(e,t,n)}},...this.elementToolsConfig.tools.connect}}}hasSetupMenu(e){return!this.popupMenu.isEmpty(e,"setup")}hasConnectConfig(e){return e.type&&e.type!==L.connection}hasAddItemsMenu(e){return!0}hasDeleteAction(e){return!0}getContextPadEntries(e){const t={};return this.hasDeleteAction(e)&&Object.assign(t,this.getDeleteConfig(e)),this.hasSetupMenu(e)&&Object.assign(t,this.getSetupConfig()),this.hasAddItemsMenu(e)&&Object.assign(t,this.getAddItemsConfig(e)),this.hasConnectConfig(e)&&Object.assign(t,this.getConnectConfig()),t}}class ra extends ti{getContextPadEntries(){return{}}}class hs{constructor(e){this.context=e}getElementToolsFeature(e){return _.isLabel(e)?new ra(this.context):new ti(this.context)}}let on=class{constructor(e,t,n,i,o,a,c,h,u,m){this.elements=u,this.elementToolsConfig=m;const w=h.localizableStrings;t.registerProvider(this);const v={modeling:n,localizableStrings:w,contextPad:t,canvas:c,popupMenu:a,elementFactory:i,create:o,connect:e,elements:u,elementToolsConfig:m};this.initializeElementToolsFactory(v)}initializeElementToolsFactory(e){this.toolsFactory=new hs(e)}getContextPadEntries(e){return this.toolsFactory.getElementToolsFeature(e).getContextPadEntries(e)}};on=(0,r.__decorate)([(0,r.__param)(0,l("connect")),(0,r.__param)(1,l("contextPad")),(0,r.__param)(2,l("modeling")),(0,r.__param)(3,l("elementFactory")),(0,r.__param)(4,l("create")),(0,r.__param)(5,l("popupMenu")),(0,r.__param)(6,l("canvas")),(0,r.__param)(7,l("config")),(0,r.__param)(8,l("elements")),(0,r.__param)(9,l("elementToolsConfig")),(0,r.__metadata)("design:paramtypes",[Object,Object,Y,Object,Object,Object,Object,Object,H,Object])],on);class aa{constructor(){this._featureService=new x.ReplaySubject(1)}set featureService(e){this._featureService.next(e)}getFeatureServiceValues(e){return this._featureService.subscribe(t=>{t.getFeatureValues(n=>{e(n)})})}}var Me=p(17521);class ps{findIntersectSegment(e,t){const n={x1:t.x,y1:t.y,x2:t.x+t.width,y2:t.y+t.height};let i=-1,o;const a=e.waypoints;for(let c=0;c<a.length-1;c++){const h={x1:a[c].x,y1:a[c].y,x2:a[c+1].x,y2:a[c+1].y},u=n,m={x1:Math.min(h.x1,h.x2)-1,y1:Math.min(h.y1,h.y2)-1,x2:Math.max(h.x1,h.x2)+1,y2:Math.max(h.y1,h.y2)+1},w=Math.max(0,Math.min(m.x2,u.x2)-Math.max(m.x1,u.x1)),v=Math.max(0,Math.min(m.y2,u.y2)-Math.max(m.y1,u.y1)),Q=w*v;(Q>i||i<0)&&(i=Q,o=h)}return o}getAlignDelta(e,t){let n=0,i=0;const o=(0,ye.pp)(t);return e.x1===e.x2?n=e.x1-o.x:i=e.y1-o.y,{x:n,y:i}}isForbiddenType(e){return _.isLabel(e)}canSplit(e){return e&&e.length===1&&!this.isForbiddenType(e[0])}splitConnection({connection:e,shapes:t,modeling:n}){if(e&&this.canSplit(t)){const i=t[0],o=e.target,a=this.findIntersectSegment(e,i),c=this.getAlignDelta(a,i);n.moveShape(i,c);const h=(0,Me.jz)(i);n.reconnectEnd(e,i,h,{isUpdateConnectionType:!1}),n.connect(i,o,{})}}}var ca=p(49096);const Wc=4,Vc=4,Gc=5,us=3.5,Jc=1,Zc=16.8699;let rn=class{constructor(e,t,n,i,o,a,c){this.eventBus=e,this.directEditing=t,this.canvas=n,this.modeling=i,this.diagramText=o,this.selection=a,this.rules=c,this.directEditing.registerProvider(this),this.rules.allowed("canLabelEdit")?this.subscribeEvents():this.subscribeSelectionEvents()}clearLabelTargetsCaption(e){const t=g.compact(g.map(e.elements,n=>n.labelTarget));g.forEach(t,n=>this.clearElementCaption(n))}clearElementCaption(e){e.caption="",this.eventBus.fire(b.element.updateLabelExecuted,{context:{element:e,text:""}})}onKeyDown({keyEvent:e}){const t=this.selection.get(),n=t.length===1&&t[0];if(n){if(st(e)===B.Enter.keyCode)return g.defer(()=>this.editElementLabel(n)),!1;if(Lr(e))return n.needClearCaption=!0,this.editElementLabel(n),!1}}_copySelectedLabelText(){const e=this.selection.get(),t=e.length===1&&e[0];if(!t)return;const n=t.labelTarget.caption,i=o=>{(o.clipboardData||window.clipboardData).setData("text",n),o.preventDefault()};document.addEventListener("copy",i,!1),document.execCommand("copy"),document.removeEventListener("copy",i,!1)}_selectLabelText(e){const t=document.createRange(),n=document.querySelector(`[data-element-id="${e.id}"] .foreign-text`);t.selectNodeContents(n);const i=window.getSelection();i.removeAllRanges(),i.addRange(t)}showElementLabel(e){const t=e.active&&e.active.element.label;t&&this.canvas.removeMarker(t,"djs-element-hidden")}subscribeSelectionEvents(){this.eventBus.on(["element.dblclick"],({element:e})=>{e.type===se.label&&this._selectLabelText(e)}),this.eventBus.on(["keyboard.keydown"],({keyEvent:e})=>{X(e,B.KeyC,{ctrl:!0})&&this._copySelectedLabelText()})}subscribeEvents(){this.eventBus.on(["element.dblclick"],e=>this.editElementLabel(e.element)),this.eventBus.on(["canvas.viewbox.changing","element.mousedown","popupMenu.open"],()=>{this.directEditing.isActive()&&this.directEditing.complete()}),this.eventBus.on(["drag.init"],e=>{if(this.directEditing.isActive()){this.directEditing.complete();const t=e.shape;t&&t.x&&t.y&&this.selection.select(t)}}),this.eventBus.on(["create.end"],A.LOW,e=>this.onCreateEnd(e)),this.eventBus.on(["connect.end"],A.LOW,e=>{const t=e.context.connection;this.editElementLabel(t)}),this.eventBus.on(["directEditing.activate"],e=>{const t=e.active.element.label;t&&this.canvas.addMarker(t,"djs-element-hidden")}),this.eventBus.on(["directEditing.complete","directEditing.cancel"],e=>this.showElementLabel(e)),this.eventBus.on([b.element.deleteElementsExecuted],e=>this.clearLabelTargetsCaption(e.context)),this.eventBus.on(["keyboard.keydown"],e=>this.onKeyDown(e))}onCreateEnd(e){const t=e.shape;e.context.canExecute&&this.editElementLabel(t)}editElementLabel(e){e.constructor!==ca.bL&&this.directEditing.activate(e.labelTarget||e)}getPadding(e,t){return g.mapValues(e,n=>n*t)}getBoxBounds(e){let t;const n=this.canvas,i=n.zoom(),o=U.label.width*i,a=this.getPadding(U.label.padding,i),c=a.paddingTop,h=a.paddingBottom,u=e.label,m=1;if(u){const v=n.getAbsoluteBBox(u);t={height:v.height+c+h,width:o,minHeight:U.label.minHeight,x:Math.round(v.x+v.width/2-o/2),y:Math.round(v.y-c)}}else{const v=this.diagramText.style,F=v.fontSize*v.lineHeight*i+c+h+m*2,pt={height:F/i,width:o/i},Ha=this.diagramText.getLabelPosition(e,pt),Es=n.getAbsoluteBBox(Ha);t={height:F,width:o,x:Math.round(Es.x-o/2),y:Math.round(Es.y-c-m)}}const w=e.width?e.width+(us+m)*2:U.label.minWidth;return t.minWidth=w*i,t}getTextStyle(e,t,n){const i=t.fontSize*e;return{...t,fontSize:`${i}px`,padding:`${n.paddingTop}px ${n.paddingRight}px ${n.paddingBottom}px ${n.paddingLeft}px`}}getElementStyle(e){const t=this.canvas.zoom(),n=g.cloneDeep(this.diagramText.style),i=U.label.padding;return this.getTextStyle(t,n,this.getPadding(i,t))}activate(e){const t=this.getBoxBounds(e),n=this.getElementStyle(e),i=["djs-direct-editing-parent"];let o;return e.needClearCaption?(o="",e.needClearCaption=!1):o=e.caption||"",{autoResize:!0,bounds:t,centerVertically:!0,options:{autoResize:!0,classList:i},style:n,text:o}}update(e,t,n){this.modeling.updateLabel(e,t)}};rn=(0,r.__decorate)([(0,r.__param)(0,l("eventBus")),(0,r.__param)(1,l("directEditing")),(0,r.__param)(2,l("canvas")),(0,r.__param)(3,l("modeling")),(0,r.__param)(4,l("diagramText")),(0,r.__param)(5,l("selection")),(0,r.__param)(6,l("rules")),(0,r.__metadata)("design:paramtypes",[Object,Object,Object,Y,Object,Object,Object])],rn);var la=p(22170);let ni=class extends la.A{constructor(e,t,n,i){super(e,t,n),this.eventBus=t,this.modeling=n,this.diagramText=i,this.subscribeEvents()}onMoveConnectionLabel(e){const t=e.context,i=t.connection.label;if(i){const o=t.hints.delta;this.modeling.moveShape(i,o)}}onReconnectStart(e){const{connection:t,hints:n,newSource:i,oldSource:o}=e.context,a=t.label,c=n&&n.doUpdateLabelPosition;if(a&&c){const h={x:i.x-o.x,y:i.y-o.y};this.modeling.moveShape(a,h)}}subscribeEvents(){this.eventBus.on([b.connection.moveConnectionLabel],this.onMoveConnectionLabel.bind(this)),super.postExecute(["connection.updateWaypoints"],this.onUpdateWaypoints.bind(this)),super.postExecute(["connection.layout"],this.onConnectionLayout.bind(this)),super.postExecute(["connection.reconnectStart"],this.onReconnectStart.bind(this)),super.postExecute(["shape.replace"],e=>{const t=e.context.newShape;this.modeling.updateLabel(t,t.caption)})}onConnectionLayout(e){const n=e.context.connection,i=n.label;if(!this.canMoveLabel(e,i))return;const o=this.getLabelOffset(n.waypoints,i);this.modeling.moveShape(i,o)}getLabelOffset(e,t){const n=this.diagramText.getConnectionLabelPosition(e,t);return{x:n.x-t.x-Math.round(t.width/2),y:n.y-t.y-Math.round(t.height/2)}}canMoveLabel(e,t){const{connection:n,hints:i,oldWaypoints:o,newSource:a}=e.context,c=i&&i.doUpdateLabelPosition;return t&&(!g.isEqual(n.waypoints,o)||a)&&c!==!1}onUpdateWaypoints(e){const t=e.context,n=t.connection,i=n.label;if(!this.canMoveLabel(e,i))return;const o=this.getLabelOffset(n.waypoints,i),a=this.getLabelOffset(t.oldWaypoints,i),c={x:o.x-a.x,y:o.y-a.y};this.modeling.moveShape(i,c)}};ni=(0,r.__decorate)([(0,r.__param)(0,l("injector")),(0,r.__param)(1,l("eventBus")),(0,r.__param)(2,l("modeling")),(0,r.__param)(3,l("diagramText")),(0,r.__metadata)("design:paramtypes",[Object,Object,Y,fe])],ni);class da{constructor(e){this._parent=e.useRtl?(0,f.domify)('<div><textarea rows="1" dir="rtl" style="direction: rtl;" class="djs-direct-editing-content"></textarea></div>'):(0,f.domify)('<div><textarea rows="1" class="djs-direct-editing-content"></textarea></div>'),this.container=e.container,this._textArea=(0,f.query)(".djs-direct-editing-content",this._parent),this.keyHandler=e.keyHandler||(()=>{}),this._mousedown=t=>{t.stopPropagation()},this.resizeHandler=e.resizeHandler||(()=>{}),this.autoResize=this.autoResize.bind(this)}create(e,t,n,i){const o=this._parent,a=this._textArea,c=this.container;i=this._options=i||{},t=this._style=t||{};const h=g.pick(t,["width","height","maxWidth","maxHeight","minWidth","minHeight","left","top","backgroundColor","position","overflow","border","wordWrap","textAlign","outline","transform"]);g.assign(o.style,{boxSizing:"border-box",left:e.x+"px",outline:"none",overflow:"visible",position:"absolute",textAlign:"center",top:e.y+"px",wordWrap:"normal",width:e.width+"px"},h);const u=g.pick(t,["borderLeft","fontFamily","fontSize","fontWeight","lineHeight","padding","paddingTop","paddingRight","paddingBottom","paddingLeft"]);return g.assign(a.style,{boxSizing:"border-box",outline:"none",wordWrap:"break-word",width:e.minWidth+"px",maxHeight:e.maxHeight+"px",maxWidth:(e.maxWidth||e.width)+"px",minHeight:e.minHeight+"px",minWidth:e.minWidth+"px"},u),i.centerVertically&&g.assign(a.style,{position:"absolute",top:"50%",transform:"translate(0, -50%)"},u),a.value=n,f.event.bind(a,"keydown",this.keyHandler),f.event.bind(a,"mousedown",this._mousedown),f.event.bind(a,"paste",this._handlePaste),f.event.bind(a,"keydown",this.autoResize),f.event.bind(a,"blur",this.blur),o.className="djs-direct-editing-parent",i.classList&&o.classList.add(...i.classList),c.appendChild(o),this._textArea.selectionStart=n.length,this._textArea.selectionEnd=n.length,this._textArea.focus(),n&&this.resizeWidth(),this.resizeHeight(),o}resizeHeight(){this._textArea.style.height="auto",this._textArea.style.height=this._textArea.scrollHeight+"px"}resizeWidth(){this._textArea.style.width="auto",this._textArea.style.width=this._textArea.scrollWidth+"px"}autoResize(){g.defer(()=>{if(this._textArea.scrollHeight>0){const e=this._textArea.getBoundingClientRect();this.resizeWidth(),this.resizeHeight(),this.resizeHandler({dx:0,dy:this._textArea.scrollHeight-e.height,height:e.height,width:e.width})}})}destroy(){const e=this._parent,t=this._textArea;t.value="",e.removeAttribute("style"),t.removeAttribute("style"),f.event.unbind(t,"keydown",this.keyHandler),f.event.unbind(t,"mousedown",this._mousedown),f.event.unbind(t,"keydown",this.autoResize),f.event.unbind(t,"blur",this.blur),(0,f.remove)(e)}getValue(){return this._textArea.value}}let ii=class{constructor(e,t,n,i,o,a,c){this._eventBus=e,this._canvas=t,this._elementRegistry=n,this._graphicsFactory=i,this._diagramText=o,this.config=a,this._providers=[],this._textbox=c||new da({useRtl:a.isRtl}),this._textbox.container=t.getContainer(),this._textbox.keyHandler=this._handleKey.bind(this),this._textbox.blur=this._blur.bind(this),this._textbox.resizeHandler=this.handleResize.bind(this),this._eventBus.on("diagram.destroy",1e3,this.deactivate,this)}_handleKey(e){if(st(e)===B.Escape.keyCode){e.stopPropagation(),e.preventDefault(),this.cancel();return}Br(e)&&Fr(e,()=>this.complete())}_blur(){this.complete()}_fire(e,t){t=t||{active:this.active},this._eventBus.fire("directEditing."+e,t)}handleResize(e){this._fire("resize",e)}getNewBounds(){const e=this.activeTextbox.getBoundingClientRect();return{x:e.top,y:e.left,width:e.width,height:e.height}}registerProvider(e){this._providers.push(e)}isActive(){return!!this.active}cancel(){this.active&&this.close("cancel")}animate(e){const t=this.activeTextbox.classList;if(!(t&&t.contains("djs-direct-editing-rotate-90")))return;const i="djs-direct-editing-rotate-0";e?t.add(i):t.remove(i)}deactivate(){this._textbox.destroy(),this._fire("deactivate",null),this.active=null}close(e){this.animate(!1),this._fire(e,null),this.deactivate()}complete(){const e=this.active;if(!e)return;const t=this.getValue();e.provider.update(e.element,t,this.getNewBounds()),this.close("complete")}getValue(){return this._textbox.getValue()}activate(e){this.isActive()&&this.cancel();let t=null;this.initialHeight=e.height,this.initialWidth=e.width;const n=this._providers.find(i=>(t=i.activate(e),t?i:null));return t&&(this.activeTextbox=this._textbox.create(t.bounds,t.style,t.text,t.options),this.active={element:e,context:t,provider:n},this.animate(!0),this._fire("activate",null)),!!t}};ii=(0,r.__decorate)([(0,r.__param)(0,l("eventBus")),(0,r.__param)(1,l("canvas")),(0,r.__param)(2,l("elementRegistry")),(0,r.__param)(3,l("graphicsFactory")),(0,r.__param)(4,l("diagramText")),(0,r.__param)(5,l("config")),(0,r.__metadata)("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object])],ii);var ha=p(10033),si=p(74419);let an=class extends ha.A{constructor(e,t){super(),this.connectionDocking=e,this.config=t}isStraightConnection(e,t,n){return!0}isShapeCenter(e,t){const{height:n,width:i,x:o,y:a}=t,c=Math.floor(e.x-o-i/2),h=Math.floor(e.y-a-n/2);return c===0&&h===0}getPreferredDirectionWithPoint(e,t){const n=t.x+t.width/2,i=t.y+t.height/2,o=e.x-n,a=e.y-i;let c;return o<0?a<0?c=-o>-a?"l":"t":c=-o>a?"l":"b":a<0?c=o>-a?"r":"t":c=o>a?"r":"b",c}getBoundingRect(e){const n=e.y-10,i=e.x+e.width+10,o=e.y+e.height+10,a=e.x-10;return{top:n,right:i,bottom:o,left:a}}findSourceLayout(e,t,n,i){let o;const a=this.getBoundingRect(e),c=this.getBoundingRect(t);switch(n){case"t":o=c.top<=a.bottom?"t":"b";break;case"b":o=c.bottom<=a.top?"t":"b";break;case"l":o=a.right<=c.left?"r":"l";break;case"r":o=c.right<=a.left?"l":"r";break}return o===n&&(i==="h"&&["r","l"].includes(n)&&(a.top>c.bottom?o="t":a.bottom<c.top||a.bottom>=c.bottom?o="b":o="t"),i==="v"&&["t","b"].includes(n)&&(a.left>c.right?o="l":a.right>=c.right||a.right<c.left?o="r":o="l")),o}getPreferredLayouts(e,t,n,i={}){const o=(0,ye.pp)(e),a=(0,ye.pp)(t),c=Math.abs(o.x-a.x),h=Math.abs(o.y-a.y),u=c<h?"v":"h";let m;const w=i.connectionStart;if(w)this.isShapeCenter(w,e)||(m=this.getPreferredDirectionWithPoint(w,e));else{const F=n&&n[0],pt=F&&(F.original||_.getOriginalWaypoint(F,e));F&&!this.isShapeCenter(pt,e)&&(m=this.getPreferredDirectionWithPoint(F,e))}let v;const Q=i.connectionEnd;if(Q)this.isShapeCenter(Q,t)||(v=this.getPreferredDirectionWithPoint(Q,t));else{const F=n&&n.slice(-1)[0],pt=F&&(F.original||_.getOriginalWaypoint(F,t));F&&!this.isShapeCenter(pt,t)&&(v=this.getPreferredDirectionWithPoint(F,t))}return!m&&v&&(m=this.findSourceLayout(e,t,v,u)),m&&!v&&(v=this.findSourceLayout(t,e,m,u)),!m&&!v?[`${u}:${u}`]:[`${m}:${v}`]}layoutConnection(e,t={}){const n=t.source||e.source,i=t.target||e.target;t.startChanged&&!t.connectionStart&&(t.connectionStart=(0,ye.pp)(n)),t.endChanged&&!t.connectionEnd&&(t.connectionEnd=(0,ye.pp)(i));const o=e.waypoints,a=t.connectionStart||o&&o.length&&o[0].original,c=t.connectionEnd||o&&o.length&&o[o.length-1].original;let h;!t.shapeMoving&&!t.startChanged&&!t.endChanged?(t.preferredLayouts=this.getPreferredLayouts(n,i,o,t),h=si.Z9(n,i,a,c,t)):h=si.WI(n,i,a,c,o,t),this.isStraightConnection(n,i,e)&&h.length>2&&h.splice(1,h.length-2);const m=Object.assign(e);return m.waypoints=si.d7(h),this.connectionDocking.getCroppedWaypoints(m,n,i)}};an=(0,r.__decorate)([(0,r.__param)(0,l("connectionDocking")),(0,r.__param)(1,l("config")),(0,r.__metadata)("design:paramtypes",[Object,Object])],an);class gs{constructor(e,t){this.eventBus=e,this.outlineFactory=t,e.on("shape.added",A.LOW,this.onShapeAdded.bind(this)),e.on("shape.changed",A.LOW,this.onShapeChanged.bind(this)),e.on("connection.added",this.onConnectionAdded.bind(this)),e.on("connection.changed",this.onConnectionChanged.bind(this))}onShapeAdded(e){this.onUpdateOutline(e)}onShapeChanged(e){this.onUpdateOutline(e)}onConnectionAdded(e){this.onUpdateOutline(e)}onConnectionChanged(e){this.onUpdateOutline(e)}onUpdateOutline(e){const t=e.element;this.outlineFactory.getOutline(t).draw(t,e.gfx)}}class rt{constructor(e){this.config=e}findOutline(e){return(0,f.query)("."+this.config.outlineClassName,e)}getOutline(e){let t=this.findOutline(e);if(!t){const n=e;t=this.createOutline(n)}return t}createOutline(e){const t=this.getSvgName(),n=(0,y.vt)(t),i=this.getCreateOutlineConfig();return(0,y.CF)(n,i),(0,y.BC)(e,n),n}getSvgName(){return"rect"}getCreateOutlineConfig(){return{...this.config.outlineStyle,shapeRendering:"geometricPrecision"}}draw(e,t){const n=this.getOutline(t);this.updateOutline(n,e)}erase(e,t){const n=this.findOutline(t);n&&n.remove()}}class pa extends rt{getCreateOutlineConfig(){const e=super.getCreateOutlineConfig();return g.assign(e,{x:10,y:10,width:100,height:100})}updateOutline(e,t){const n=(0,Ht.U7)(t,!1),i=this.config.offset;(0,y.CF)(e,{height:n.height+i*2,width:n.width+i*2,x:n.x-i,y:n.y-i})}draw(e,t){this.config.rules.allowed("canShowConnectionOutline")&&super.draw(e,t)}}class ua extends rt{getCreateOutlineConfig(){const e=super.getCreateOutlineConfig();return g.assign(e,{x:10,y:10,width:100,height:100,rx:5})}updateOutline(e,t){const n=this.config.offset;(0,y.CF)(e,{x:-n,y:-n,width:t.width+n*2,height:t.height+n*2})}}class ms extends rt{getCreateOutlineConfig(){const e=super.getCreateOutlineConfig();return g.assign(e,{x:10,y:10,width:100,height:100})}updateOutline(e,t){this.config.rules.allowed("canShowLabelOutline")&&(0,y.CF)(e,{x:-2,y:-2,width:t.width+2*2,height:t.height+2})}draw(e,t){this.config.rules.allowed("canShowLabelOutline")&&super.draw(e,t)}}let Re=class{constructor(e,t,n,i){this.styles=e,this.rules=t,this.elements=n,this.diagramUtils=i,this.config=this.getConfig()}getConfig(){const e="djs-outline",t={...this.styles.cls(e,["no-fill"],null),strokeDasharray:"4,2",strokeWidth:"1px"};return{outlineClassName:e,outlineStyle:t,offset:us,elements:this.elements,rules:this.rules}}getOutline(e){switch(!0){case _.isLabel(e):return new ms(this.config);case this.diagramUtils.isConnection(e):return new pa(this.config);default:return new ua(this.config)}}};Re=(0,r.__decorate)([(0,r.__param)(0,l("styles")),(0,r.__param)(1,l("rules")),(0,r.__param)(2,l("elements")),(0,r.__param)(3,l("diagramUtils")),(0,r.__metadata)("design:paramtypes",[Object,Object,H,_])],Re);let oi=class extends gs{constructor(e,t){super(e,t),this.outlineFactory=t}};oi=(0,r.__decorate)([(0,r.__param)(0,l("eventBus")),(0,r.__param)(1,l("outlineFactory")),(0,r.__metadata)("design:paramtypes",[Object,Re])],oi);class fs extends ot{getSizeConfig(e){const t=this.elements.getConfig(e);return this.styles.style({height:e.height||t.height,width:e.width||t.width})}getImageSource(e){const t=this.elements.getConfig(e);return e.largeImage||t.largeImage}draw(e,t){super.draw(e,t);const n=this.elements.getConfig(t);if(!n)throw new Error(`Element type ${t.type} not supported`);const i=(0,y.vt)("image"),o=this.getSizeConfig(t),a=this.getImageSource(t);return(0,y.CF)(i,o),i.setAttributeNS("http://www.w3.org/1999/xlink","href",a),i.setAttributeNS(null,"type",n.type),i.setAttributeNS(null,"preserveAspectRatio","none"),(0,y.BC)(e,i),i}}let ri=class{constructor(e){this.popupMenu=e,this.popupMenu.registerProvider("setup",this)}getPopupMenuEntries(e){return{}}getHeaderEntries(e){return[]}};ri=(0,r.__decorate)([(0,r.__param)(0,l("popupMenu")),(0,r.__metadata)("design:paramtypes",[Object])],ri);class ys{stopSync(){}startSync(){}subscribeServerChanges(){return[]}}const cn={__depends__:[Ko.A,$o.A,Wo.A,Vo.A,Go.A,Zo.A,Yo.A,Xo.A,Qo.A,qo.A,er.A,lr.A,tr.A,Zi.A,nr.A,rr.A,hr.A,Kt,dr.A,Jo.A,Jt,ar.A],__init__:["canvas","commandStack","contextPad","contextPadProvider","copyPaste","labelSupport","diagramLoader","diagramRenderer","diagramRules","diagramEventHandlerController","diagramText","directEditing","editorActions","elementFactory","elementRegistry","keyboardBindings","labelEdit","layouter","localStorage","outline","resize","resizeHandles","resizePreview","setupMenuProvider","handTool","spaceToolPreview","bendpointMove","bendpoints","featureProvider","connectionPreview","connectionSegmentMove","paletteProvider","paletteElements","elementToolsConfig","createPopupMenu","palette","connectionHighlight","minimap","diagramPopup","lassoTool","diagramUtils","diagramPaletteTools","diagramTooltips"],canvas:["type",Mn],commandStack:["type",Rn],connectionDocking:["type",cr.A],contextPad:["type",Un],contextPadProvider:["type",on],copyPaste:["type",Hn],labelSupport:["type",ni],diagramLoader:["type",Yt],diagramRenderer:["type",sn],diagramRules:["type",k],diagramEventHandlerController:["type",ys],directEditing:["type",ii],editorActions:["type",Kn],elementFactory:["type",Qi],elementRegistry:["type",$n],keyboardBindings:["type",zr],localStorage:["type",Te],modeling:["type",Y],outline:["type",oi],resize:["type",ir.A],resizeHandles:["type",sr.A],resizePreview:["type",or.A],setupMenuProvider:["type",ri],handTool:["type",Zi.A],spaceToolPreview:["type",na],bendpoints:["type",Kt],featureProvider:["type",aa],connectionPreview:["type",Ln],popupMenu:["type",Zn],connectionSegmentMove:["type",Jt],labelEdit:["type",rn],diagramText:["type",fe],outlineFactory:["type",Re],renderingShapeFactory:["type",nn],renderingLabel:["type",Xn],renderingShape:["type",fs],layouter:["type",an],elements:["type",H],paletteProvider:["type",Qt],splitConnectionHelper:["type",ps],spaceTool:["type",Qn],paletteElements:["type",Ie],elementToolsConfig:["type",Zt],createPopupMenu:["type",De],palette:["type",Gn],replaceMenuGroups:["type",function(){return{}}],zoomScroll:["type",ei],connectionHighlight:["type",$t],minimap:["type",Vn],diagramPopup:["type",Jn],lassoTool:["type",Wn],previewSupport:["type",Zr],diagramUtils:["type",_],diagramPaletteTools:["type",qt],diagramTooltips:["type",qn]};class ga extends Zt{getAddItems(){const e=this.config.customElementToolsConfig?this.config.customElementToolsConfig.addItems||[]:[];return[...super.getAddItems(),...e]}getTools(){const e=this.config.customElementToolsConfig?this.config.customElementToolsConfig.tools||[]:[];return{...super.getTools(),...e}}}let ai=class extends gs{constructor(e,t,n){super(e,t),this.outlineFactory=t,this.registry=n,this.notValidElements=new Set,e.on(["element.validation"],this.onElementIsValidChanged.bind(this))}onElementIsValidChanged(e){const t=e.id;e.isValid?this.removeElement(t):this.addElement(t)}addElement(e){if(!this.notValidElements.has(e)&&this.registry.get(e)){this.notValidElements.add(e);const t=this.registry.get(e),n=this.registry.getGraphics(t);this.onUpdateOutline({element:t,gfx:n})}}removeElement(e){if(this.notValidElements.has(e)){this.notValidElements.delete(e);const t=this.registry.get(e),n=this.registry.getGraphics(t);this.outlineFactory.getOutline(t).erase(t,n)}}onUpdateOutline(e){const t=e.element;this.notValidElements.has(t.id)&&super.onUpdateOutline(e)}};ai=(0,r.__decorate)([(0,r.__param)(0,l("eventBus")),(0,r.__param)(1,l("validationOutlineFactory")),(0,r.__param)(2,l("elementRegistry")),(0,r.__metadata)("design:paramtypes",[Object,Re,Object])],ai);var ma=p(62514);class fa extends $t{_changeConnectionHighlight(e,t){this.elementRegistry.filter(n=>this.diagramUtils.isConnection(n)).forEach(n=>{this.canvas.removeMarker(n,this.highlightClassName)}),e&&t&&this.canvas.addMarker(e,this.highlightClassName)}subscribeEvents(){this.eventBus.on(b.connection.highlight,e=>this.onHighlightConnection(e))}onHighlightConnection(e){const{connection:t,state:n}=e;this._changeConnectionHighlight(t,n)}}let ci=class extends rn{constructor(e,t,n,i,o,a,c){super(e,t,n,i,o,a,c),this.eventBus=e,this.directEditing=t,this.canvas=n,this.modeling=i,this.diagramText=o,this.selection=a,this.rules=c}getLabelPaddingTop(){return 0}};ci=(0,r.__decorate)([(0,r.__param)(0,l("eventBus")),(0,r.__param)(1,l("directEditing")),(0,r.__param)(2,l("canvas")),(0,r.__param)(3,l("modeling")),(0,r.__param)(4,l("diagramText")),(0,r.__param)(5,l("selection")),(0,r.__param)(6,l("rules")),(0,r.__metadata)("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object])],ci);class ya extends Yt{getConnectionAttributes(e,t){return{...super.getConnectionAttributes(e,t),itemName:t.itemName,order:this.elements.items.connection.order}}}class ba extends ya{getConnectionAttributes(e,t){return{...super.getConnectionAttributes(e,t),description:t.description}}}var _a=p(81493);let li=class extends _a.A{constructor(e,t,n){super(e,t),this.canvas=e,this.modeling=t,this.diagramUtils=n}createSingleCrossConnection(e,t){const n=e.source,i=t.target;if(n.outgoing.some(c=>c.target.id===i.id)||n.incoming.some(c=>c.source.id===i.id)||i.incoming.some(c=>c.source.id===n.id)||i.outgoing.some(c=>c.target.id===n.id)||i.outgoing.some(c=>c.source.id===n.id))return;const a=(0,Me.jz)(i);this.modeling.reconnectEnd(e,i,a,{isUpdateConnectionType:!1})}createMultipleCrossConnections(e){const t=e.shape,n=[...t.incoming],i=[...t.outgoing];if(n.length<1||i.length<1)return;const o=i.filter(h=>this.isDiagramFlow(h)).sort((h,u)=>h.id>u.id?1:-1);if(o.length<1)return;const a=o[0];n.filter(h=>this.isDiagramFlow(h)).forEach(h=>this.createSingleCrossConnection(h,a))}isDiagramFlow(e){return this.diagramUtils.isFlow(e)}preExecute(e){const t=e.hints;t&&t.force||this.createMultipleCrossConnections(e),super.preExecute(e)}};li=(0,r.__decorate)([(0,r.__param)(0,M("canvas")),(0,r.__param)(1,M("modeling")),(0,r.__param)(2,M("diagramUtils")),(0,r.__metadata)("design:paramtypes",[Object,Object,Object])],li);class at{generate(e,t,n,i="{prefix} {index}"){let o=0,a="",c;do o=o+1,a=i.replace("{prefix}",n).replace("{index}",o.toString()),c=e.find(h=>(h[t]||"").toLowerCase()===a.toLowerCase());while(c);return a}static{this.\u0275fac=function(t){return new(t||at)}}static{this.\u0275prov=d.\u0275\u0275defineInjectable({token:at,factory:at.\u0275fac})}}class di extends fe{getLabelPaddingTop(e,t){return this.diagramUtils.isConnection(e)||t?0:super.getLabelPaddingTop(e,t)}createForeignObject(e,t){const n=super.createForeignObject(e,t);if(t.description){const i=this.createForeignTextContainer(t.description,e.width,t);i.setAttribute("class","foreign-text-container campaign-label-description"),n.prepend(i)}return n}createForeignText(e,t,n){const i=super.createForeignText(e,t,n),o=n.style;return o&&g.assign(i.style,{...o.font&&{font:o.font},...o.textAlign&&{"text-align":o.textAlign}}),i.innerHTML=e,i}getTextLayout(e,t){const n=super.getTextLayout(e,t);if(!t.description)return n;t.box&&(t.box.height=null);const i=super.getTextLayout(t.description,t);return{text:n.text,width:Math.max(n.width,i.width),height:this.isEmptyText(e)?i.height:n.height+i.height}}getLabelOptions(e){return{...super.getLabelOptions(e),description:e.description}}applySvgHelperContent(e,t){e.innerHTML=this.isEmptyText(t)?"dummy":t}addLabel(e,t,n,i){i=i||t.caption||t.description,super.addLabel(e,t,n,i)}layoutText(e,t){return t.description&&(t.needRecalcDimensions=!0),super.layoutText(e,t)}}var ln;(function(s){s.startElement="start",s.intermediate="intermediate",s.endElement="end"})(ln||(ln={}));class oe extends H{getCampaignNodeType(e){const t=this.getConfig(e);return t&&t.diagramNodeType}getItems(){const e=this.config&&this.config.customDiagramElements;return{...super.getItems(),...e}}isStartElement(e){return this.getCampaignNodeType(e)===ln.startElement}isEndElement(e){return this.getCampaignNodeType(e)===ln.endElement}getElementShapeForm(e){const t=this.getConfig(e);return t&&t.shapeFormType}}let ct=class extends ps{constructor(e){super(),this.elements=e}isForbiddenType(e){return super.isForbiddenType(e)||this.elements.isStartElement(e)||this.elements.isEndElement(e)}canSplit(e){const t=e[0];return super.canSplit(e)&&!t.incoming.length&&!t.outgoing.length}};ct=(0,r.__decorate)([(0,r.__param)(0,l("elements")),(0,r.__metadata)("design:paramtypes",[oe])],ct);let hi=class extends Vt{constructor(e,t,n,i){super(e,t),this.modeling=e,this.canvas=t,this.splitConnectionHelper=n,this.diagramUtils=i}preExecute(e){const t=e.parent;t&&this.diagramUtils.isConnection(t)&&(e.targetConnection=t,e.parent=this.canvas.getRootElement());const n=[];e.elements.filter(o=>!_.isLabel(o)&&!this.diagramUtils.isConnection(o)).forEach(o=>{const a=this.modeling.generateUniqueElementCaption(o,n);n.push(a),o.caption=a}),super.preExecute(e)}postExecute(e){this.splitConnectionHelper.splitConnection({connection:e.targetConnection,shapes:e.elements,modeling:this.modeling})}};hi=(0,r.__decorate)([(0,r.__param)(0,l("modeling")),(0,r.__param)(1,l("canvas")),(0,r.__param)(2,l("splitConnectionHelper")),(0,r.__param)(3,l("diagramUtils")),(0,r.__metadata)("design:paramtypes",[Object,Object,ct,_])],hi);let pi=class extends Gt{constructor(e,t,n,i,o){super(e,t,n,o),this.modeling=e,this.elementRegistry=t,this.canvas=n,this.splitConnectionHelper=i,this.diagramUtils=o}postExecute(e){super.postExecute(e),this.splitConnectionHelper.splitConnection({connection:e.targetConnection,shapes:e.shapes,modeling:this.modeling})}};pi=(0,r.__decorate)([(0,r.__param)(0,l("modeling")),(0,r.__param)(1,l("elementRegistry")),(0,r.__param)(2,l("canvas")),(0,r.__param)(3,l("splitConnectionHelper")),(0,r.__param)(4,l("diagramUtils")),(0,r.__metadata)("design:paramtypes",[Object,Object,Object,ct,_])],pi);let ui=class{constructor(e){this.eventBus=e}preExecute(e){const{element:t}=e;e.oldType=t.type,e.oldBounds=g.pick(t,["width","height"]),e.oldMarkers=g.cloneDeep(t.markers)}postExecute(e){this.eventBus.fire(b.element.updated,e.element)}execute(e){const{element:t,markers:n}=e;return t.markers=n,e.element}revert(e){return e.element}};ui=(0,r.__decorate)([(0,r.__param)(0,l("eventBus")),(0,r.__metadata)("design:paramtypes",[Object])],ui);class xa{execute(e){return e.oldType=e.connection.type,e.connection}}class va extends it{execute(e){return e.oldType=e.connection.type,super.execute(e)}}let gi=class extends Wt{constructor(e,t,n){super(e,t),this.modeling=e,this.diagramText=t,this.elements=n}preExecute(e){e.text=e.text?.trim(),super.preExecute(e)}postExecute(e){const t=e.element.label;if(t)if(this.diagramText.isEmptyText(e.text||t.description||t.labelTarget?.description||""))this.modeling.removeShape(t,{unsetLabel:!1});else{t.description=e.element.description;const n=e.newBounds||this.diagramText.getLabelBounds(t,e.text);this.resizeShape(t,n)}}};gi=(0,r.__decorate)([(0,r.__param)(0,l("modeling")),(0,r.__param)(1,l("diagramText")),(0,r.__param)(2,l("elements")),(0,r.__metadata)("design:paramtypes",[Object,di,oe])],gi);let mi=class extends Y{constructor(e,t,n,i,o,a,c,h,u){super(e,t,n,i,o,a,c,h,u),this.commandStack=n,this.canvas=i,this.registry=o,this.elements=c,this.rules=h,this.diagramUtils=u}_addCampaignShapeHandlers(e){e[b.shape.shapeDelete]=li}addElementsHandlers(e){super.addElementsHandlers(e),e[b.elements.create]=hi,e[b.elements.move]=pi}getLabelAttributes(e,t,n,i){return{...super.getLabelAttributes(e,t,n,i),itemName:e.itemName,description:e.description,raiseOnMouseOver:e.raiseOnMouseOver}}getElementAttributes(e,t,n){const i=super.getElementAttributes(e,t,n),o=t.itemName,a=t.markers;return{...i,itemName:o,markers:a}}addElementHandlers(e){super.addElementHandlers(e),e[b.element.update]=ui,e[b.element.updateLabel]=gi}addConnectionHandlers(e){e[b.connection.update]=xa,e[b.connection.reconnect]=va}getLabelSize(e,t){return e.description=t.description,super.getLabelSize(e,t)}updateElementMarkers(e,t){if(e){const n={element:e,markers:t};this.commandStack.execute(b.element.update,n)}}generateUniqueElementCaption(e,t){const n=this.elements.getConfig(e),i=this.registry.getAllElements(),o=t.map(a=>({caption:a})).concat(i);return at.prototype.generate(o,"caption",n.caption)}getHandlers(){const e=super.getHandlers();return this._addCampaignShapeHandlers(e),e}createFeatureContext(){return{canvas:this.canvas,elementRegistry:this.registry,elements:this.elements}}highlightConnection(e,t){const n={connection:e,state:t};this.eventBus.fire(b.connection.highlight,n)}createLabel(e,t,n,i){return n.isDescription&&e.label&&!e.label.isDescription&&(t.y+=e.label.height+5),{...super.createLabel(e,t,n,i),description:e.description}}updateDescription(e,t){e.description=t,e.label&&(e.label.description=t),this.updateLabel(e,e.caption)}};mi=(0,r.__decorate)([(0,r.__param)(0,l("eventBus")),(0,r.__param)(1,l("elementFactory")),(0,r.__param)(2,l("commandStack")),(0,r.__param)(3,l("canvas")),(0,r.__param)(4,l("elementRegistry")),(0,r.__param)(5,l("diagramText")),(0,r.__param)(6,l("elements")),(0,r.__param)(7,l("rules")),(0,r.__param)(8,l("diagramUtils")),(0,r.__metadata)("design:paramtypes",[Object,Object,Object,Object,Object,di,oe,Object,_])],mi);let re=class extends k{constructor(e,t,n,i){super(e,t),this.eventBus=e,this.elements=n,this.diagramUtils=i}_canConnectTo(e){return![this.elements.items.root.type,this.elements.items.label.type,this.elements.items.connection.type].includes(e.type)}_isNotEndElement(e){return!this.elements.isEndElement(e)}_canConnectToStartElement(e){return!e||!this.elements.isStartElement(e)}_isNotConnected(e,t,n=null){return!e.outgoing.find(i=>i.target.id===t.id&&i!==n)}canConnectionCreate(e){const t=e.source,n=e.target;return super.canConnectionCreate(e)&&t!==n&&this._canConnectTo(n)&&this._canConnectTo(t)&&this._isNotEndElement(t)&&this._canConnectToStartElement(n)&&this._isNotConnected(t,n)}canReconnectStart(){return!1}canReconnectEnd(e){const t=e.connection,n=e.hover,i=e.connection.source,o=n||e.target;return n!==i&&(o&&o.id)!==i.id&&this._canConnectTo(o)&&this._canConnectToStartElement(o)&&this._isNotConnected(i,o,t)}canElementMove(e){const t=e.shapes||e.elements||[e.shape];let i=t.filter(o=>_.isLabel(o)).every(o=>t.find(a=>a.id===o.parent.id));if(i){const o=e.target;i=!o||_.isRoot(o)||this.diagramUtils.isConnection(o)||_.isLabel(o)}return i}canElementsDelete(e){const t=e.elements;return super.canElementsDelete(e)&&this.eventBus.fire(b.elements.removing,{elements:t})}};(0,r.__decorate)([O(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Boolean)],re.prototype,"canConnectionCreate",null),(0,r.__decorate)([O(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Boolean)],re.prototype,"canReconnectStart",null),(0,r.__decorate)([O(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Boolean)],re.prototype,"canReconnectEnd",null),(0,r.__decorate)([O(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Boolean)],re.prototype,"canElementMove",null),(0,r.__decorate)([O(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Boolean)],re.prototype,"canElementsDelete",null),re=(0,r.__decorate)([(0,r.__param)(0,l("eventBus")),(0,r.__param)(1,l("config")),(0,r.__param)(2,l("elements")),(0,r.__param)(3,l("diagramUtils")),(0,r.__metadata)("design:paramtypes",[Object,Object,oe,_])],re);class Ca extends an{isStraightConnection(e,t,n){return!1}}class wa extends Ie{getElements(){return{...super.getElements(),...this.config.customPaletteElements}}}let fi=class extends Qt{constructor(e,t,n,i,o,a,c,h,u,m,w,v){super(e,t,n,i,o,a,c,h,u,m,w),this.create=e,this.elementFactory=t,this.palette=n,this.featureProvider=i,this.canvas=o,this.elements=a,this.paletteElements=c,this.rules=h,this.eventBus=u,this.createPopupMenu=m,this.config=w,this.diagramPaletteTools=v,this.dataActionPrefix=""}getPaletteEntries(){return{...this.diagramPaletteTools.getPaletteTools(),...super.getPaletteEntries()}}};fi=(0,r.__decorate)([(0,r.__param)(0,l("create")),(0,r.__param)(1,l("elementFactory")),(0,r.__param)(2,l("palette")),(0,r.__param)(3,l("featureProvider")),(0,r.__param)(4,l("canvas")),(0,r.__param)(5,l("elements")),(0,r.__param)(6,l("paletteElements")),(0,r.__param)(7,l("rules")),(0,r.__param)(8,l("eventBus")),(0,r.__param)(9,l("createPopupMenu")),(0,r.__param)(10,l("config")),(0,r.__param)(11,l("diagramPaletteTools")),(0,r.__metadata)("design:paramtypes",[Object,Object,Object,Object,Object,H,Ie,Object,Object,De,Object,qt])],fi);var ja=p(97317);let yi=class extends ja.A{constructor(e,t,n){super(t),this.eventBus=e,this.canvas=t,this.diagramUtils=n,this._subscribeEvents()}_subscribeEvents(){this.eventBus.on([b.connect.move,b.connect.hover,b.connect.end],A.HIGH,e=>{this.onSnapping(e)})}canSetSnapping(e){const{source:t,target:n}=e;return n&&t&&!_.isRoot(n)&&!_.isRoot(t)&&!this.diagramUtils.isConnection(t)&&!this.diagramUtils.isConnection(n)&&!_.isLabel(t)&&!_.isLabel(n)}onSnapping(e){const t=e.context;this.canSetSnapping(t)&&this.setSnapping(e)}snapEvent(e,t){(0,Me.CU)(e,"x",t.x),(0,Me.CU)(e,"y",t.y)}};yi=(0,r.__decorate)([(0,r.__param)(0,l("eventBus")),(0,r.__param)(1,l("canvas")),(0,r.__param)(2,l("diagramUtils")),(0,r.__metadata)("design:paramtypes",[Object,Object,_])],yi);let bi=class extends yi{constructor(e,t,n){super(e,t,n),this.eventBus=e,this.canvas=t,this.diagramUtils=n}setSnapping(e){const t=e.context,{source:n,hover:i}=t;t.sourcePosition=(0,Me.jz)(n);const o=(0,Me.jz)(i);this.snapEvent(e,o)}};bi=(0,r.__decorate)([(0,r.__param)(0,l("eventBus")),(0,r.__param)(1,l("canvas")),(0,r.__param)(2,l("diagramUtils")),(0,r.__metadata)("design:paramtypes",[Object,Object,_])],bi);class Ea extends ti{getContextPadEntries(e){const t={};return this.hasDeleteAction(e)&&Object.assign(t,this.getDeleteConfig(e)),t}}class Sa extends hs{constructor(e,t){super(e),this.context=e,this.elements=t}getElementToolsFeature(e){switch(!0){case this.elements.isEndElement(e):return new Ea(this.context);default:return super.getElementToolsFeature(e)}}}let _i=class extends on{constructor(e,t,n,i,o,a,c,h,u,m){super(e,t,n,i,o,a,c,h,u,m),this.elements=u,this.elementToolsConfig=m;const w=h.localizableStrings;t.registerProvider(this);const v={modeling:n,localizableStrings:w,contextPad:t,canvas:c,popupMenu:a,elementFactory:i,create:o,connect:e,elements:u,elementToolsConfig:m};this.toolsFactory=new Sa(v,u)}};_i=(0,r.__decorate)([(0,r.__param)(0,l("connect")),(0,r.__param)(1,l("contextPad")),(0,r.__param)(2,l("modeling")),(0,r.__param)(3,l("elementFactory")),(0,r.__param)(4,l("create")),(0,r.__param)(5,l("popupMenu")),(0,r.__param)(6,l("canvas")),(0,r.__param)(7,l("config")),(0,r.__param)(8,l("elements")),(0,r.__param)(9,l("elementToolsConfig")),(0,r.__metadata)("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object,Object,oe,Object])],_i);class Oa extends rt{getCreateOutlineConfig(){const e=super.getCreateOutlineConfig();return g.assign(e,{cx:10,cy:10,r:30})}getSvgName(){return"circle"}updateOutline(e,t){const n=t.width/2;(0,y.CF)(e,{cx:n,cy:n,r:n+this.config.offset})}}class ka extends rt{constructor(){super(...arguments),this._factor45Angle=Math.sqrt(1/2)}getDefaultHeight(){return 55}getCreateOutlineConfig(){const e=this._factor45Angle,t=this.getDefaultHeight()/2,n=super.getCreateOutlineConfig();return g.assign(n,{x:10,y:10,width:100,height:100,transform:`matrix(${e} -${e} ${e} ${e} 0 ${t})`})}updateOutline(e,t){const n=this._factor45Angle,i=t.height/2,o=this.config.offset;(0,y.CF)(e,{x:-o,y:-o,width:t.width*n+o*2,height:t.height*n+o*2,transform:`matrix(${n} -${n} ${n} ${n} 0 ${i})`})}}class Aa extends ms{findElementBySelector(e){return(0,f.query)(e)}updateOutline(e,t){if(t.raiseOnMouseOver&&t.type===L.label){const n=t.parent.id,o=this.findElementBySelector(`[data-element-id="${n}"]`).parentNode,a=this.findElementBySelector('.layer-base[data-element-id="root1"]');e.onmouseover=function(){a.appendChild(o)}}super.updateOutline(e,t)}draw(e,t){super.draw(e,t)}}var dn;(function(s){s.circle="circle",s.rhomb="rhomb",s.rectangle="rectangle"})(dn||(dn={}));let hn=class extends Re{constructor(e,t,n,i){super(e,t,n,i),this.styles=e,this.rules=t,this.elements=n,this.diagramUtils=i}getLabelOutlineConfig(e){if(e.style&&e.style.outlineClass){const t=(0,g.cloneDeep)(this.config);return t.outlineClassName=e.style.outlineClass,t.outlineStyle={class:e.style.outlineClass},t}return this.config}getOutline(e){const t=this.elements.getElementShapeForm(e);switch(!0){case t===dn.circle:return new Oa(this.config);case t===dn.rhomb:return new ka(this.config);case _.isLabel(e):const n=this.getLabelOutlineConfig(e);return new Aa(n);default:return super.getOutline(e)}}};hn=(0,r.__decorate)([(0,r.__param)(0,l("styles")),(0,r.__param)(1,l("rules")),(0,r.__param)(2,l("elements")),(0,r.__param)(3,l("diagramUtils")),(0,r.__metadata)("design:paramtypes",[Object,Object,oe,_])],hn);class Ia extends hn{getConfig(){const e="djs-validate-outline",t={...this.styles.cls(e,["no-fill"],null),stroke:"#EB3800",strokeWidth:"2px"};return{outlineClassName:e,outlineStyle:t,offset:5,elements:this.elements.items,rules:this.rules}}}class Da extends Xn{getDrawOptions(e){const t=super.getDrawOptions(e),n=e.labelTarget;return{...t,description:n?.description}}getDefaultBackgroundConfig(e){const t={height:e.height,width:e.width};if(e.backgroundStyle){const n=e.backgroundStyle;g.assign(t,{...n.cornerRadius&&{rx:n.cornerRadius},...n.stroke&&{stroke:n.stroke},...n.strokeWidth&&{"stroke-width":n.strokeWidth}})}return t}}let pn=class{constructor(e){this.config=e,this.items=this.getItems()}getItems(){return{...this.config&&this.config.customElementMarkers}}getConfig(e){return this.items[e]}};pn=(0,r.__decorate)([(0,r.__param)(0,l("config")),(0,r.__metadata)("design:paramtypes",[Object])],pn);var bs;let xi=class extends fs{constructor(e,t,n,i,o){super(e,t,n,o),this.elements=e,this.styles=t,this.diagramText=n,this.markers=i,this.eventBus=o}appendMarkers(e,t,n){Object.values(n).filter(a=>!(0,g.isEmpty)(a)).forEach(a=>{const c=(0,y.vt)("image"),h=this.markers.getConfig(a.name);h&&((0,y.CF)(c,{height:a.size||h.size||12,width:a.size||h.size||12,x:a.x||h.x,y:a.y||h.y}),c.setAttributeNS(null,"type",h.type),c.setAttributeNS("http://www.w3.org/1999/xlink","href",h.smallImage),(0,y.BC)(e,c))})}draw(e,t){const n=super.draw(e,t),i={...t.markers};if(Object.keys(i).length>0){const o=this.getSizeConfig(t);this.appendMarkers(e,o,i)}return n}};xi=(0,r.__decorate)([(0,r.__param)(0,l("elements")),(0,r.__param)(1,l("styles")),(0,r.__param)(2,l("diagramText")),(0,r.__param)(3,l("markers")),(0,r.__param)(4,l("eventBus")),(0,r.__metadata)("design:paramtypes",[oe,typeof(bs=typeof Pe.A<"u"&&Pe.A)=="function"?bs:Object,Object,pn,Object])],xi);const vi={...cn,diagramLoader:["type",ba],modeling:["type",mi],renderingShape:["type",xi],renderingLabel:["type",Da],elements:["type",oe],markers:["type",pn],layouter:["type",Ca],outlineFactory:["type",hn],paletteElements:["type",wa],paletteProvider:["type",fi],elementToolsConfig:["type",ga],diagramRules:["type",re],validationOutlineFactory:["type",Ia],validationOutline:["type",ai],contextPadProvider:["type",_i],snapping:["type",bi],splitConnectionHelper:["type",ct],connectionHighlight:["type",fa],labelEdit:["type",ci],diagramText:["type",di]};vi.__depends__=[...cn.__depends__,ma.A],vi.__init__=[...cn.__init__,"snapping","validationOutlineFactory","validationOutline"];const _s=vi,$={Add:"add",Remove:"remove",Update:"update"};let Ci=class extends ys{constructor(e,t){super(),this.eventBus=e,this.diagramUtils=t,this._stopSync=0,this.sourceId=Yi.Guid.create(),this.subscribeDiagramChanges()}getElement(e){const t=e.context.shape||e.context.element||e.context.connection;switch(!0){case _.isLabel(t):return this.getLabel(e);case this.diagramUtils.isConnection(t):return this.getConnection(e);default:return this.getShape(e)}}updateProperties(e,t){if(this._stopSync)return;const n=e.context,i=this.getElement(e),o={};if(t.forEach(a=>{const c=i[a],h=this.getOldValue(n,a);g.isEqual(h,c)||(o[a]=g.cloneDeep(c))}),!g.isEmpty(o))switch(!0){case _.isLabel(i):this.service.bufferiseOps($.Update,["labels",i.id],o);break;case this.diagramUtils.isConnection(i):this.service.bufferiseOps($.Update,["connections",i.id],o);break;default:this.service.bufferiseOps($.Update,["elements",i.id],o)}}getShape(e){const t=e.context.shape||e.context.element;return{caption:t.caption,height:t.height,id:t.id,parent:t.parent&&t.parent.id,type:t.type,width:t.width,rx:t.rx,ry:t.ry,defaultParamValues:t.defaultParamValues,source:t.source}}getConnection(e){const t=e.context,n=t.connection||t.element,i=n.source||t.source,o=n.target||t.target;return{caption:n.caption,id:n.id,source:i.id,target:o.id,type:n.type,waypoints:n.waypoints}}getLabel(e){const t=e.context,n=t.shape,i=n.labelTarget||t.labelTarget;return{height:n.height,id:n.id,parent:i&&i.id,type:n.type,width:n.width,rx:n.rx,ry:n.ry}}addElement(e){const t=this.getElement(e);this.service.bufferiseOps($.Add,["elements"],{[t.id]:t})}subscribeDiagramChanges(){const e=this.eventBus;e.on([b.diagram.initialized],()=>{this.service.diagramInitialized()}),e.on([b.shape.createExecuted],t=>{if(!this._stopSync){const n=this.getElement(t);_.isLabel(n)?this.service.bufferiseOps($.Add,["labels"],{[n.id]:n}):this.addElement(t)}}),e.on([b.shape.deleteExecuted],t=>{if(!this._stopSync){const n=this.getElement(t);n.parent||(n.parent=t.context.oldParent.id),_.isLabel(n)?this.service.bufferiseOps($.Remove,["labels"],{[n.id]:n}):this.service.bufferiseOps($.Remove,["elements"],{[n.id]:n})}}),e.on([b.shape.moveExecuted],t=>{this.updateProperties(t,["parent","rx","ry"])}),e.on([b.shape.resizeExecuted],t=>{this.updateProperties(t,["rx","ry","width","height"])}),e.on([b.element.updateLabelExecuted],t=>{if(this._stopSync)return;const n=this.getElement(t);let i;this.diagramUtils.isConnection(n)?(i=this.getConnection(t),this.service.bufferiseOps($.Update,["connections",i.id],{caption:i.caption})):(i=this.getShape(t),this.service.bufferiseOps($.Update,["elements",i.id],{caption:i.caption}))}),e.on([b.element.updateExecuted],t=>{this.updateProperties(t,["width","height","type"])}),e.on([b.label.createExecuted],t=>{if(!this._stopSync){const n=this.getLabel(t);this.service.bufferiseOps($.Add,["labels"],{[n.id]:n})}}),e.on([b.connection.createExecuted],t=>{if(!this._stopSync){const n=this.getConnection(t);this.service.bufferiseOps($.Add,["connections"],{[n.id]:n})}}),e.on([b.connection.deleteExecuted],t=>{if(!this._stopSync){const n=this.getConnection(t);this.service.bufferiseOps($.Remove,["connections"],{[n.id]:n})}}),e.on([b.connection.reconnectExecuted],t=>{const n=t.context.hints.docking;this.updateProperties(t,[n,"type"])}),e.on([b.connection.updateWaypointsExecuted],t=>{this.updateProperties(t,["waypoints"])}),e.on([b.connection.layoutExecuted],t=>{this.updateProperties(t,["waypoints"])}),e.on([b.connection.moveExecuted],t=>{this.updateProperties(t,["waypoints"])}),e.on([b.connection.updateExecuted],t=>{this.updateProperties(t,["type"])}),e.on([b.connection.changeDirectionExecuted],t=>{this.updateProperties(t,["source","target","waypoints"])}),e.on([b.elements.changed],()=>{this.service.commit(this.sourceId).then()}),e.on(["undo"],()=>this.service.undo()),e.on(["redo"],()=>this.service.redo())}getOldValue(e,t){let n;switch(t){case"rx":case"ry":case"width":case"height":n=e.oldBounds[t];break;case"parent":n=g.get(e,"oldParent.id");break;case"waypoints":n=g.get(e,"oldWaypoints");break;case"source":n=g.get(e,"oldSource.id");break;case"target":n=g.get(e,"oldTarget.id");break;case"type":n=g.get(e,"oldType");break;default:console.warn(`Unknown element property ${t}`)}return n}startSync(){this._stopSync=0}stopSync(){this._stopSync++}};Ci=(0,r.__decorate)([(0,r.__param)(0,l("eventBus")),(0,r.__param)(1,l("diagramUtils")),(0,r.__metadata)("design:paramtypes",[Object,Object])],Ci);let wi=class extends Ci{constructor(e,t,n,i,o,a){super(e,a),this.eventBus=e,this.graphicsFactory=t,this.elementRegistry=n,this.modeling=i,this.selection=o,this.diagramUtils=a}onItemNameChanged({id:e,name:t}){const n=this.elementRegistry.getGraphics(e),i=this.elementRegistry.get(e);i.itemName=t,this.graphicsFactory.update(this.diagramUtils.isConnection(i)?"connection":"shape",i,n)}onElementCaptionChanged({id:e,caption:t}){const n=this.elementRegistry.get(e);if(n){const i=n.caption,o=t&&t.trim();i!==o&&this.modeling.updateLabel(n,t)}}getPasteElementConfig(e){const t=this.getFlowElementConfigFromShape(e);return Object.assign(t,{sourceId:e.sourceId})}findElements(e){const t=[];return e.forEach(n=>{const i=this.elementRegistry.get(n);i&&t.push(i)}),t}getFlowElementConfigFromShape(e){return{itemName:e.itemName,id:e.id,caption:e.caption,parentId:e.parent.id,position:{x:e.rx,y:e.ry}}}addElement(e){const t=e.context,n=t.shape||t.element||t.connection;t.hints.isElementCopyPaste?this.service.pasteElement(this.getPasteElementConfig(n)):super.addElement(e)}subscribeServerDiagramChanges(){const e=this.service;this.eventBus.on([b.elements.removing],t=>{const n=t.elements.map(i=>i.id);return e.removing(n)}),this.eventBus.on([b.element.doubleClick],t=>{e.elementDoubleClick(t.element.itemName)}),this.eventBus.on(["diagram.item.selected"],t=>{const n=t.id,i=n&&this.elementRegistry.get(n);e.selectionChanged(i&&this.getFlowElementConfigFromShape(i))})}getShape(e){const t=super.getShape(e),n=e.context.shape||e.context.element;return t.type=n.userTaskType||n.type,t}subscribeServerChanges(){this.subscribeServerDiagramChanges();const e=this.service;return[e.elementIsValidChanged$.subscribe(t=>this.eventBus.fire(b.element.validation,t)),e.elementNameChanged$.subscribe(({id:t,name:n})=>{this.onItemNameChanged({id:t,name:n})}),e.elementCaptionChanged$.subscribe(({id:t,caption:n})=>{this.onElementCaptionChanged({id:t,caption:n})}),e.elementRemoved$.subscribe(t=>{const n=this.findElements(t);this.modeling.removeElements(n,!0)}),e.elementUpdateType$.subscribe(({id:t,config:n})=>{const i=this.elementRegistry.get(t);this.diagramUtils.isConnection(i)||this.modeling.updateElementType({id:t,config:n,force:!0})}),e.elementSelected$.subscribe(({id:t})=>{const n=this.elementRegistry.get(t);n?this.selection.select(n,!1):this.selection.select([],!1)}),e.elementCenterViewBox$.subscribe(({id:t})=>{const n=this.elementRegistry.get(t);n&&this.modeling.centerViewbox(n)}),e.elementMarkersChanged$.subscribe(({id:t,markers:n})=>{const i=this.elementRegistry.get(t);this.modeling.updateElementMarkers(i,n)})]}};wi=(0,r.__decorate)([(0,r.__param)(0,l("eventBus")),(0,r.__param)(1,l("graphicsFactory")),(0,r.__param)(2,l("elementRegistry")),(0,r.__param)(3,l("modeling")),(0,r.__param)(4,l("selection")),(0,r.__param)(5,l("diagramUtils")),(0,r.__metadata)("design:paramtypes",[Object,Object,Object,Object,Object,Object])],wi);class Ta extends wi{getFlowElementConfigFromShape(e){const t=super.getFlowElementConfigFromShape(e);return t.position={x:e.x,y:e.y},t}getShape(e){const t=super.getShape(e),n=e.context.shape||e.context.element;return t.rx=n.x,t.ry=n.y,{...t,markers:n.markers}}getOldValue(e,t){let n;switch(t){case"markers":n=g.get(e,"oldMarkers");break;default:n=super.getOldValue(e,t)}return n}subscribeDiagramChanges(){super.subscribeDiagramChanges(),this.eventBus.on([b.element.updateExecuted],t=>{this.updateProperties(t,["width","height","type","markers"])})}subscribeServerChanges(){const e=super.subscribeServerChanges(),t=this.service;return e.push(t.connectionHighlighted$.subscribe(({id:n,state:i})=>{const o=this.elementRegistry.get(n);this.modeling.highlightConnection(o,i)})),e.push(t.elementDescriptionChanged$.subscribe(({id:n,description:i})=>{const o=this.elementRegistry.get(n);o&&this.modeling.updateDescription(o,i)})),e}}class Pa extends Qi{generateId(e){return Ts.generateUUID()}}var xs=p(70987),vs=p(67047),Cs=p(62521),ws=p(48059);class lt{constructor(e,t){this._domSanitizer=e,this._matIconRegistry=t}addIcons(e){e.forEach(({name:t,icon:n})=>{const i=this._domSanitizer.bypassSecurityTrustHtml(n);this._matIconRegistry.addSvgIconLiteral(t,i)})}static{this.\u0275fac=function(t){return new(t||lt)(d.\u0275\u0275inject(ut.DomSanitizer),d.\u0275\u0275inject(je.MatIconRegistry))}}static{this.\u0275prov=d.\u0275\u0275defineInjectable({token:lt,factory:lt.\u0275fac,providedIn:"root"})}}class Le{constructor(e){this._materialIconsRegistrar=e,this._materialIconsRegistrar.addIcons([{name:"icon_close_24",icon:p(26242)}])}static{this.\u0275fac=function(t){return new(t||Le)(d.\u0275\u0275inject(lt))}}static{this.\u0275mod=d.\u0275\u0275defineNgModule({type:Le})}static{this.\u0275inj=d.\u0275\u0275defineInjector({providers:[Se],imports:[P.CommonModule,qe.MatLegacyButtonModule,je.MatIconModule,ge.MatLegacySnackBarModule,z.TranslateModule]})}}(function(){(typeof ngJitMode>"u"||ngJitMode)&&d.\u0275\u0275setNgModuleScope(Le,{declarations:[Ee],imports:[P.CommonModule,qe.MatLegacyButtonModule,je.MatIconModule,ge.MatLegacySnackBarModule,z.TranslateModule],exports:[Ee]})})();class Be{static{this.\u0275fac=function(t){return new(t||Be)}}static{this.\u0275mod=d.\u0275\u0275defineNgModule({type:Be})}static{this.\u0275inj=d.\u0275\u0275defineInjector({providers:[Z,ke,{provide:Ut,useValue:cn},ce],imports:[P.CommonModule,z.TranslateModule.forChild(),Le]})}}(function(){(typeof ngJitMode>"u"||ngJitMode)&&d.\u0275\u0275setNgModuleScope(Be,{declarations:[Ae],imports:[P.CommonModule,z.TranslateModule,Le],exports:[Ae]})})();class Fe{static{this.\u0275fac=function(t){return new(t||Fe)}}static{this.\u0275mod=d.\u0275\u0275defineNgModule({type:Fe})}static{this.\u0275inj=d.\u0275\u0275defineInjector({providers:[Z,{provide:Ut,useValue:_s}],imports:[Be,P.CommonModule,z.TranslateModule.forRoot(),vs.MatLegacyMenuModule,P.CommonModule,qe.MatLegacyButtonModule,xs.MatLegacyInputModule,ge.MatLegacySnackBarModule,Cs.MatLegacyTooltipModule,je.MatIconModule,ws.BrowserAnimationsModule]})}}(function(){(typeof ngJitMode>"u"||ngJitMode)&&d.\u0275\u0275setNgModuleScope(Fe,{declarations:[me],imports:[Be,P.CommonModule,z.TranslateModule,vs.MatLegacyMenuModule,P.CommonModule,qe.MatLegacyButtonModule,xs.MatLegacyInputModule,ge.MatLegacySnackBarModule,Cs.MatLegacyTooltipModule,je.MatIconModule,ws.BrowserAnimationsModule],exports:[me]})})();function Ma(s){return s.endsWith("/")||(s+="/"),s}function Ra(s){return s.replace(/(^([/\\])+)|(([/\\])+$)/,"")}function La(s){return s=s.replace(location.hash,""),s.replace(location.search,"")}function Ba(s){return`${Fa()}/Navigation/Navigation.aspx?schemaName=${s}`}function Yc(){return"/"}function xe(){let s=location.pathname;const e=s.match(/.*?\/\d\/?/);return e&&e.length===1?s=Ma(e[0]):s="",za(location.origin,s)}function js(){let s=location.href.replace(xe(),"");return s=La(s),s||"/"}function Xc(){const s=js(),e=xe(),t=s.split("/").filter(Boolean)[0];return t?`${e}${t}/`:e}function ji(){let e=xe().replace(location.origin,"");return e.endsWith("/")&&(e=e.substring(0,e.length-1)),e}function Fa(){return xe().replace(/\/0\/?$|\/+$/,"")}function za(...s){return s.map(e=>Ra(e)).join("/")}function Qc(s,e){return`${Ba(s)}&recordId=${e}`}function qc(s,e){function t(a,c){return a.toLowerCase().replace(c,"").split("/").filter(h=>h).join("/")}const n=xe().toLowerCase(),i=t(s,n),o=t(e,n);return i===o}function el(s){return s?ji()+imageServiceUrl+s:null}function tl(){return ji()+esqServiceUrl}function nl(s){const{uId:e,name:t,packageUId:n}=s;if(!e&&!t)throw new Error("uId or name is required");const i=xe(),o=js();let a=`${i}${o}#/InterfaceDesigner/${e||t}`;return n&&(a+=`?packageUId=${n}`),a}class dt{_buildRequestUrl(e){return this._isAbsoluteUrl(e)?e:P.Location.joinWithSlash(this.getUrl(),e)}_isAbsoluteUrl(e){return/^https?:\/\//i.test(e)}getUrl(){return ji()}intercept(e,t){return e=e.clone({url:this._buildRequestUrl(e.url)}),t.handle(e).pipe((0,C.catchError)(n=>(console.log(n),(0,x.throwError)(n))))}static{this.\u0275fac=function(t){return new(t||dt)}}static{this.\u0275prov=d.\u0275\u0275defineInjectable({token:dt,factory:dt.\u0275fac})}}class ze extends dt{getUrl(){return xe()}static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=d.\u0275\u0275getInheritedFactory(ze)))(n||ze)}})()}static{this.\u0275prov=d.\u0275\u0275defineInjectable({token:ze,factory:ze.\u0275fac})}}class un{constructor(e){this._resources=e}getTranslation(e){const t=this._resources.map(({prefix:n,suffix:i})=>{const o=`${n}${e}${i}`;return fetch(o,{cache:"no-cache"}).then(a=>{if(!a.ok&&a.status!==304)throw new Error(`Loading translations failed: ${o} (${a.status})`);return a.json()})});return(0,x.from)(Promise.allSettled(t)).pipe((0,x.map)(n=>{for(const i of n.filter(o=>o.status==="rejected"))console.error(i.reason);return(0,g.merge)({},...n.filter(i=>i.status==="fulfilled").map(i=>i.value||{}))}))}static{this.\u0275fac=function(t){d.\u0275\u0275invalidFactory()}}static{this.\u0275prov=d.\u0275\u0275defineInjectable({token:un,factory:un.\u0275fac})}}function Na(s,...e){return z.TranslateModule.forRoot({...s,loader:{provide:z.TranslateLoader,useFactory:()=>new un(e.map(t=>({prefix:t,suffix:".json"})))}})}const Ua=p.p+"assets/i18n/libs/";class ht{constructor(e,t){this._customElementsBootstrapService=e,this._translateService=t}ngDoBootstrap(){this._translateService.use(this._translateService.defaultLang).subscribe(()=>this._customElementsBootstrapService.defineComponent("ts-campaign-diagram",me))}static{this.\u0275fac=function(t){return new(t||ht)(d.\u0275\u0275inject(He),d.\u0275\u0275inject(z.TranslateService))}}static{this.\u0275mod=d.\u0275\u0275defineNgModule({type:ht})}static{this.\u0275inj=d.\u0275\u0275defineInjector({providers:[{provide:P.APP_BASE_HREF,useValue:"/"},{provide:Z,useClass:nt},ae,{provide:Ut,useFactory:()=>({..._s,diagramEventHandlerController:["type",Ta],elementFactory:["type",Pa]})},{provide:W.HTTP_INTERCEPTORS,useClass:ze,multi:!0}],imports:[ut.BrowserModule,W.HttpClientModule,Fe,Si.RouterModule.forRoot([],{}),W.HttpClientXsrfModule.withOptions({cookieName:"BPMCSRF",headerName:"BPMCSRF"}),Qe,Na({defaultLanguage:"en-US"},Ua)]})}}(function(){(typeof ngJitMode>"u"||ngJitMode)&&d.\u0275\u0275setNgModuleScope(ht,{imports:[ut.BrowserModule,W.HttpClientModule,Fe,Si.RouterModule,W.HttpClientXsrfModule,Qe,z.TranslateModule]})})(),ut.platformBrowser().bootstrapModule(ht,{ngZone:"noop"}).catch(s=>console.error(s))},26242:Ei=>{Ei.exports=`<svg id="Group_7" data-name="Group 7" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
	<rect id="Rectangle_7" data-name="Rectangle 7" width="24" height="24" fill="none"/>
	<line id="Line_5" data-name="Line 5" y1="10" x2="10" transform="translate(7 7)" fill="none" stroke="#ffff" stroke-miterlimit="10" stroke-width="1"/>
	<line id="Line_6" data-name="Line 6" x2="10" y2="10" transform="translate(7 7)" fill="none" stroke="#ffff" stroke-miterlimit="10" stroke-width="1"/>
</svg>
`}}]);
