(self.webpackChunkapp_studio_enterprise_service_model_network=self.webpackChunkapp_studio_enterprise_service_model_network||[]).push([[762],{7762:(F,J,o)=>{var k=o(6098),L=o(2260),D=o(7494),M=o(3733),N=o(6610),s=o(7691),g=o(1227),p=o(3527),$=o(1877),C=o(8377);class I{constructor(t){this.data={nodes:new C.DataSet(t.nodes),edges:new C.DataSet(t.edges)},this.options=t.options}}const E=["visNetworkContainer"];class a{constructor(){this._networkDataSubject=new g.m,this.nodeDoubleClick=new s.bkB}set networkData(t){t&&this._networkDataSubject.next(t)}_renderVisNetwork(t){const e=this.visNetworkContainer.nativeElement;this.visNetworkInstance=new $.Network(e,t.data,t.options),this.visNetworkInstance.on("doubleClick",this.onNodeDoubleClick.bind(this))}onNodeDoubleClick(t){const e=this.visNetworkInstance.getNodeAt(t.pointer.DOM);e&&this.nodeDoubleClick.emit(e)}_reRenderVisNetwork(t){this.visNetworkInstance.setData(t.data),this.visNetworkInstance.setOptions(t.options),this.visNetworkInstance.redraw()}ngOnInit(){this._networkDataSubject.pipe((0,p.T)(t=>new I(t))).subscribe(t=>{this.visNetworkInstance?this._reRenderVisNetwork(t):this._renderVisNetwork(t)})}static{this.\u0275fac=function(e){return new(e||a)}}static{this.\u0275cmp=s.VBU({type:a,selectors:[["ts-vis-network"]],viewQuery:function(e,i){if(e&1&&s.GBs(E,7),e&2){let n;s.mGM(n=s.lsd())&&(i.visNetworkContainer=n.first)}},inputs:{networkData:"networkData"},outputs:{nodeDoubleClick:"nodeDoubleClick"},decls:2,vars:0,consts:[["visNetworkContainer",""],[1,"vis-network-container"]],template:function(e,i){e&1&&s.nrm(0,"div",1,0)},styles:[".vis-network-container[_ngcontent-%COMP%]{height:100%}"]})}}class c{static{this.\u0275fac=function(e){return new(e||c)}}static{this.\u0275mod=s.$C({type:c})}static{this.\u0275inj=s.G2t({imports:[N.MD]})}}(function(){(typeof ngJitMode>"u"||ngJitMode)&&s.Obh(c,{declarations:[a],imports:[N.MD],exports:[a]})})();var f=o(5945),O=o(3573),b=o(8399);class v{constructor(t){this._resources=t}getTranslation(t){const e=this._resources.map(({prefix:i,suffix:n})=>{const l=`${i}${t}${n}`;return fetch(l,{cache:"no-cache"}).then(w=>{if(!w.ok&&w.status!==304)throw new Error(`Loading translations failed: ${l} (${w.status})`);return w.json()})});return(0,b.H)(Promise.allSettled(e)).pipe((0,p.T)(i=>{for(const n of i.filter(l=>l.status==="rejected"))console.error(n.reason);return(0,O.A)({},...i.filter(n=>n.status==="fulfilled").map(n=>n.value||{}))}))}static{this.\u0275fac=function(e){s.QTQ()}}static{this.\u0275prov=s.jDH({token:v,factory:v.\u0275fac})}}function T(r,...t){return f.h.forRoot({...r,loader:{provide:f.Wr,useFactory:()=>new v(t.map(e=>({prefix:e,suffix:".json"})))}})}class V{constructor(t){this.nodes=t.nodes||[],this.edges=t.edges||[],this.options=t.options||{}}}var x=o(2690),y=o(8503),S=o(8240),j=o(7236),m;(function(r){r[r.Node=1]="Node",r[r.Edge=2]="Edge"})(m||(m={}));class d{constructor(){this._networkDataSubject=new g.m(1),this.networkData$=this._networkDataSubject.asObservable()}_getNodesObservable(t){return(0,b.H)(t).pipe((0,y.p)(e=>e.nodeType===m.Node),(0,p.T)(e=>({id:e.name,label:e.labels[0].text,image:e.shape.src,schemaName:e.schemaName,shape:e.shape.type,color:{background:e.styles.fill}})),(0,S.$)())}_getEdgesObservable(t){return(0,b.H)(t).pipe((0,y.p)(e=>e.nodeType===m.Edge),(0,p.T)(e=>({from:e.sourceNode,to:e.targetNode,arrows:"to",color:e.lineColor,length:300})),(0,S.$)())}initNetworkData(t){const e=this._getNodesObservable(t).pipe((0,j.M)(n=>this._nodesStore=n)),i=this._getEdgesObservable(t).pipe((0,j.M)(n=>this._edgesStore=n));(0,x.p)(e,i).subscribe(n=>{this._networkDataSubject.next(new V({nodes:this._nodesStore,edges:this._edgesStore,options:{nodes:{shapeProperties:{useBorderWithImage:!0},borderWidth:0},physics:{enabled:!1}}}))})}getNodeDetail(t){return this._nodesStore.find(e=>e.id===t)}static{this.\u0275fac=function(e){return new(e||d)}}static{this.\u0275prov=s.jDH({token:d,factory:d.\u0275fac,providedIn:"root"})}}class h{constructor(t,e){this._element=t,this._transformDataService=e}set isNodeLoaded(t){this._isNodeLoaded=t==="true",this._draw()}_draw(){if(this._isNodeLoaded){const t=JSON.parse(this._element.nativeElement.nodes);this.networkData$=this._transformDataService.networkData$,this._transformDataService.initNetworkData(t)}}onNodeDoubleClick(t){const e=this._transformDataService.getNodeDetail(t);if(e){const i={name:e.id,schemaName:e.schemaName};this._element.nativeElement.dispatchEvent(new CustomEvent("nodeClicked",{detail:{nodeData:i},bubbles:!0}))}}static{this.\u0275fac=function(e){return new(e||h)(s.rXU(s.aKT),s.rXU(d))}}static{this.\u0275cmp=s.VBU({type:h,selectors:[["ts-service-model-network"]],inputs:{isNodeLoaded:[s.Mj6.None,"is-nodes-loaded","isNodeLoaded"]},features:[s.Jv_([d])],decls:2,vars:3,consts:[[3,"nodeDoubleClick","networkData"]],template:function(e,i){e&1&&(s.j41(0,"ts-vis-network",0),s.nI1(1,"async"),s.bIt("nodeDoubleClick",function(l){return i.onNodeDoubleClick(l)}),s.k0s()),e&2&&s.Y8G("networkData",s.bMT(1,1,i.networkData$))},dependencies:[a,N.Jj],encapsulation:3})}}const B=o.p+"assets/i18n/libs/";class u{constructor(t,e){this._injector=t,this._translateService=e}ngDoBootstrap(){this._translateService.use(this._translateService.defaultLang).subscribe(()=>{const t=(0,M.gw)(h,{injector:this._injector});customElements.get("ts-service-model-network")||customElements.define("ts-service-model-network",t)})}static{this.\u0275fac=function(e){return new(e||u)(s.KVO(s.zZn),s.KVO(f.c$))}}static{this.\u0275mod=s.$C({type:u})}static{this.\u0275inj=s.G2t({imports:[k.Bb,c,D.q1,T({},B)]})}}(function(){(typeof ngJitMode>"u"||ngJitMode)&&s.Obh(u,{declarations:[h],imports:[k.Bb,c,D.q1,f.h]})})(),k.sG().bootstrapModule(u).catch(r=>console.error(r))}}]);
